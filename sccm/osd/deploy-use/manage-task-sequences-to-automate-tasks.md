---
title: "タスクを自動化するためのタスク シーケンスの管理 | Microsoft Docs"
description: "System Center Configuration Manager 環境でタスク シーケンスを作成、編集、展開、インポート、およびエクスポートして管理できます。"
ms.custom: na
ms.date: 03/24/2017
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology:
- configmgr-osd
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: a1f099f1-e9b5-4189-88b3-f53e3b4e4add
caps.latest.revision: 10
author: Dougeby
ms.author: dougeby
manager: angrobe
ms.translationtype: Human Translation
ms.sourcegitcommit: c6ee0ed635ab81b5e454e3cd85637ff3e20dbb34
ms.openlocfilehash: 2f3d66362c49d28a52d7f9c535eb0b3b4cc4eaf7
ms.contentlocale: ja-jp
ms.lasthandoff: 06/08/2017


---
# System Center Configuration Manager でのタスクを自動化するためのタスク シーケンスの管理
<a id="manage-task-sequences-to-automate-tasks-in-system-center-configuration-manager" class="xliff"></a>

*適用対象: System Center Configuration Manager (Current Branch)*

System Center Configuration Manager 環境のステップを自動化するには、タスク シーケンスを使用します。 こうしたステップでは、オペレーティング システム イメージをセットアップ先のコンピューターに展開し、一連のオペレーティング システム インストール ファイルからオペレーティング システム イメージを構築およびキャプチャし、さらにユーザー状態情報をキャプチャし復元できます。 タスク シーケンスは、Configuration Manager コンソールの **[ソフトウェア ライブラリ]** > **[オペレーティング システム]** > **[タスク シーケンス]** にあります。 **[タスク シーケンス]** ノードは、作成したサブフォルダーを含め、Configuration Manager 階層全体にレプリケートされます。 計画の詳細については、「[タスクの自動化計画に関する考慮事項](../plan-design/planning-considerations-for-automating-tasks.md)」を参照してください。  

 タスク シーケンスを管理するには、次の手順に従います。

##  <a name="BKMK_CreateTaskSequence"></a> タスク シーケンスの作成  
 タスク シーケンスの作成ウィザードを使用して、タスク シーケンスを作成します。 このウィザードでは、次の種類のタスク シーケンスを作成することができます。  

|タスク シーケンスの種類|説明|  
|------------------------|----------------------|  
|[オペレーティング システムをインストールするタスク シーケンス](create-a-task-sequence-to-install-an-operating-system.md)|このタスク シーケンスの種類では、オペレーティング システムをインストールするステップを作成すると共に、ユーザー データを移行したり、ソフトウェア更新を含めたり、アプリケーションをインストールしたりするためのオプションも作成します。|  
|[オペレーティング システムをアップグレードするタスク シーケンス](create-a-task-sequence-to-upgrade-an-operating-system.md)|このタスク シーケンスの種類では、オペレーティング システムをアップグレードするステップを作成すると共に、ソフトウェア更新を含めたり、アプリケーションをインストールしたりするためのオプションも作成します。|  
|[オペレーティング システムをキャプチャするタスク シーケンス](create-a-task-sequence-to-capture-an-operating-system.md)|このタスク シーケンスの種類では、参照コンピューターからオペレーティング システムを構築およびキャプチャするステップを作成します。 イメージをキャプチャする前に、参照コンピューターにソフトウェアの更新を含めたり、アプリケーションをインストールしたりすることができます。|  
|[ユーザー状態をキャプチャおよび復元するタスク シーケンス](create-a-task-sequence-to-capture-and-restore-user-state.md)|このタスク シーケンスは、ユーザー状態データをキャプチャし復元するために、既存のタスク シーケンスに追加するステップを提供します。|  
|[バーチャル ハード ディスクを管理するタスク シーケンス](use-a-task-sequence-to-manage-virtual-hard-disks.md)|このタスク シーケンスの種類は VHD を作成するステップから成っています。これは、Configuration Manager コンソールから System Center Virtual Machine Manager (VMM) に対して発行できるオペレーティング システムとアプリケーションのインストールを行うために含まれています。|  
|[カスタム タスク シーケンス](create-a-custom-task-sequence.md)|このタスク シーケンスの種類は、タスク シーケンスにステップを追加しません。 カスタム タスク シーケンスを作成後、そのタスク シーケンスを編集し、ステップを追加する必要があります。|  

## タスク シーケンスが失敗した場合に前のページに戻る
<a id="return-to-previous-page-when-a-task-sequence-fails" class="xliff"></a>
Configuration Manager バージョン 1702 以降では、タスク シーケンスを実行し、エラーが発生した場合に、前のページに戻ることができます。 これより前のリリースでは、エラーが発生すると、タスク シーケンスを再起動する必要があります。 たとえば、次のシナリオでは **[前へ]** ボタンを使用できます。

- Windows PE でコンピューターを起動する場合、タスク シーケンスが使用できるようになる前に、タスク シーケンス ブートス トラップ ダイアログ ボックスが表示される場合があります。 このシナリオで [次へ] をクリックすると、タスク シーケンスの最終ページが表示され、使用できるタスク シーケンスがないことを示すメッセージが示されます。 ここで、**[前へ]** をクリックすれば、使用できるタスク シーケンスをもう一度検索することができます。 タスク シーケンスが使用可能になるまで、このプロセスを繰り返すことができます。
- タスク シーケンスを実行しても、依存するコンテンツ パッケージが配布ポイントでまだ使用できない場合、タスク シーケンスは失敗します。 存在しないコンテンツを配布するか (そのコンテンツがまだ配布されていない場合)、またはコンテンツが配布ポイントで使用できるようになるまで待機してから、**[前へ]** をクリックしてコンテンツでタスク シーケンスを検索します。

##  <a name="BKMK_ModifyTaskSequence"></a> タスク シーケンスの編集  
 タスク シーケンスは、タスク シーケンス ステップを追加または削除する、タスク シーケンス グループを追加または削除する、あるいはステップの順序を変更するという方法で変更することができます。 既存のタスク シーケンスを変更するには、次の手順に従います。  

> [!IMPORTANT]  
>  タスク シーケンスの作成ウィザードを使用して作成済みのタスク シーケンスを編集する場合、ステップの名前を、ステップのアクションやステップの種類にすることができます。 たとえば、"Partition disk 0" という名前のステップがあり、それがステップの種類「 [Format and Partition Disk](../understand/task-sequence-steps.md#BKMK_FormatandPartitionDisk)」に対するアクションであるとします。 すべてのタスク シーケンス ステップの内容は、それらの種類によって示され、必ずしもエディターに表示されるステップの名前によって示されるわけではありません。  

#### タスク シーケンスを編集するには
<a id="to-edit-a-task-sequence" class="xliff"></a>  

1.  Configuration Manager コンソールで、 **[ソフトウェア ライブラリ]** をクリックします。  

2.  **[ソフトウェア ライブラリ]** ワークスペースで **[オペレーティング システム]** を展開して、 [**タスク シーケンス]** をクリックします。  

3.  **[タスク シーケンス]** 一覧で、編集するタスク シーケンスを選択します。  

4.  **[ホーム]** タブの **[タスク シーケンス]** グループで、 **[編集]** をクリックして、次の操作のいずれかを実行します。  

    -   タスク シーケンス ステップを追加するには、 **[追加]** をクリックして、ステップの種類を選択し、追加するタスク シーケンス ステップをクリックします。 たとえば、「コマンドラインの実行」ステップを追加するには、 **[追加]** をクリックし、 **[全般]** を選択して、 **[コマンドラインの実行]** をクリックします。  

         すべてのタスク シーケンス ステップおよびそれらの種類の一覧については、このステップの直後にある表を参照してください。  

    -   グループをタスク シーケンスに追加するには、 **[追加]** をクリックしてから、 **[新しいグループ]** をクリックします。 グループを追加したら、そのグループにステップを追加することができます。  

    -   タスク シーケンスでステップおよびグループの順序を変更するには、順序を変更するステップまたはグループを選択して、 **項目を上へ移動** するアイコンまたは **項目を下へ移動** するアイコンを使用します。 一度に移動できるステップまたはグループは 1 つのみです。  

    -   ステップまたはグループを削除するには、ステップまたはグループを選択して **[削除]** をクリックします。  

5.  **[OK]** をクリックして変更を保存します。  

 使用可能なタスク シーケンス ステップの一覧については、「[タスク シーケンスのステップ](../understand/task-sequence-steps.md)」を参照してください。  

## ソフトウェア センターのプロパティを構成する
<a id="configure-software-center-properties" class="xliff"></a>
ソフトウェア センターに表示されるタスク シーケンスの詳細を構成するには、次の手順を実行します。 これは参考目的のみの情報です。  
1. Configuration Manager コンソールの **[ソフトウェア ライブラリ]** > **[オペレーティング システム]** > **[タスク シーケンス]** の順に選択します。
2. 編集するタスク シーケンスを選択し、**[プロパティ]** をクリックします。
3. **[全般]** タブでは、ソフトウェア センターの次の設定を使用できます。
  - **再起動が必要**: インストール時に再起動が必要かどうかをユーザーに通知します。
  - **ダウンロード サイズ (MB)**: タスク シーケンスについてソフトウェア センターに表示するサイズ (MB) を指定します。  
  - **推定実行時間 (分)**: タスク シーケンスについてソフトウェア センターに表示する推定実行時間を分単位で指定します。

## タスク シーケンスの詳細設定の構成
<a id="configure-advanced-task-sequence-settings" class="xliff"></a>
ソフトウェア センターに表示されるタスク シーケンスの詳細を構成するには、次の手順を実行します。 これは参考目的のみの情報です。  
1. Configuration Manager コンソールの **[ソフトウェア ライブラリ]** > **[オペレーティング システム]** > **[タスク シーケンス]** の順に選択します。
2. 編集するタスク シーケンスを選択し、**[プロパティ]** をクリックします。
3. **[詳細設定]** タブでは、次の設定を使用できます。

    - **別のプログラムを最初に実行する**    
    タスク シーケンスが実行される前に、(別のパッケージの) 別のプログラムを実行する場合は、このチェック ボックスをオンにします。 既定では、このチェック ボックスはオフです。 最初に実行するように指定したプログラムを別個に提供する必要はありません。

        > [!IMPORTANT]     
        この設定は、完全なオペレーティング システムで実行されるタスク シーケンスにのみ適用されます タスク シーケンスが PXE またはブート メディアを使用して開始される場合、Configuration Manager ではこの設定が無視されます。

    - **[パッケージ]**     
        **[別のプログラムを最初に実行する]** を選択した場合は、このタスク シーケンスの前に実行する必要があるプログラムが含まれているパッケージを入力または参照します。

    - **[プログラム]**     
    **[別のプログラムを最初に実行する]** を選択した場合は、このタスク シーケンスの前に実行する必要があるプログラムを、**[プログラム]** ドロップダウン リストから選択します。

        > [!NOTE]    
        > 選択したプログラムをクライアントで実行するのに失敗した場合は、タスク シーケンスは実行されません。 選択したプログラムが正常に実行された場合は、同じクライアントでタスク シーケンスが再実行されても、再び実行されることはありません。
 
    - **[展開先のコンピューターでこのタスク シーケンスを無効にする]**    
    このオプションを選択すると、このタスク シーケンスを含むすべての展開が一時的に無効になります。 タスク シーケンスは実行可能な提供情報の一覧から削除され、再度有効にされるまで実行されません。 既定では、このオプションは無効になっています。

    - **[許可された最長実行時間]**    
    対象コンピューターでタスク シーケンスが実行されることが予想される最長時間 (分単位) を指定します。 ゼロ以上の整数を使用する必要があります。 既定では、120 分に設定されます。

        > [!IMPORTANT]    
        > このタスク シーケンスが実行されているコレクションに対してメンテナンス期間を使用している場合は、**[許容最長実行時間]** がスケジュールされたメンテナンス期間より長いと、競合が発生する可能性があります。 最長実行時間が **0** に設定されている場合、タスク シーケンスはメンテナンス期間中に開始され、メンテナンス期間が終了した後、完了するか失敗するまで実行し続けます。 このため、最長実行時間が **0** に設定されているタスク シーケンスは、メンテナンス期間が終了した後も実行し続ける可能性があります。 利用可能なメンテナンス期間よりも長い期間に最長実行時間を設定している (つまり、**0** に設定していない) 場合、タスク シーケンスは実行されません。 詳細については、「[メンテナンス期間を使用する方法](/sccm/core/clients/manage/collections/use-maintenance-windows)」を参照してください。
 
        この値が **0** に設定されている場合、Configuration Manager は、進行状況を監視するための許容最長実行時間を **12** 時間 (720 分) と評価します。 ただし、カウントダウン期間がメンテナンス期間の値を超えない限り、タスク シーケンスは開始されます。

    > [!NOTE]    
    > この最長実行時間に達した場合、管理者権限で実行するように設定されており、[プログラムとの対話をユーザーに許可する] 設定が選択されていなければ、Configuration Manager はタスク シーケンスを停止します。 タスク シーケンス自体が停止されない場合、Configuration Manager は許容最長実行時間に達してからタスク シーケンスの監視を停止します。 

    - **Use a boot image \(ブート イメージの使用\)**   
        タスク シーケンスが実行されているときに選択したブート イメージを使用する場合は、このオプションを有効にします。 

        別のブート イメージを選択する場合は、**[参照]** をクリックします。 タスク シーケンスが実行されているときに選択したブート イメージの使用を無効にする場合は、このオプションをオフにします。

    - **このタスク シーケンスを任意のプラットフォームで実行可能にする**     
        このオプションを選択すると、タスク シーケンスが展開されているときに Configuration Manager は対象コンピューターのプラットフォームの種類を確認しません。 既定では、このオプションはオンです。

    - **このタスク シーケンスを指定されたクライアント プラットフォームでのみ実行可能にする**    
        このオプションでは、このタスク シーケンスを実行できるプロセッサ、オペレーティング システムおよび Service Pack を指定します。 このオプションを選択する場合は、リストからプラットフォームを 1 つ以上選択する必要もあります。 既定では、プラットフォームは選択されていません。 Configuration Manager は、コレクション内のどの対象コンピューターが展開されたタスク シーケンスを受信するかを判断するときに、この情報を使用します。

        > [!NOTE]    
        > タスク シーケンスがブート メディアから、または PXE ブートによって実行されると、このオプションは無視されて、タスク シーケンスは、**[任意のプラットフォームで実行可能]** オプションが選択されているかのように実行されます。

## 影響の大きいタスク シーケンス設定の構成
<a id="configure-high-impact-task-sequence-settings" class="xliff"></a>
Configuration Manager バージョン 1702 以降では、タスク シーケンスを影響の大きいものとして設定し、ユーザーがそのタスク シーケンスを実行したときに表示されるメッセージをカスタマイズすることができます。

### タスク シーケンスを影響の大きいタスク シーケンスとして設定する
<a id="set-a-task-sequence-as-a-high-impact-task-sequence" class="xliff"></a>
次の手順を使用して、影響の大きいタスク シーケンスとして設定します。
> [!NOTE]    
> 特定の条件を満たす任意のタスク シーケンスは、影響度大として自動的に定義されます。 詳細については、「[System Center Configuration Manager の危険度の高い展開を管理するための設定](http://docs.microsoft.com/sccm/protect/understand/settings-to-manage-high-risk-deployments)」を参照してください。

1. Configuration Manager コンソールの **[ソフトウェア ライブラリ]** > **[オペレーティング システム]** > **[タスク シーケンス]** の順に選択します。
2. 編集するタスク シーケンスを選択し、**[プロパティ]** をクリックします。
3. **[ユーザー通知]** タブの **[これは、インパクトのあるタスク シーケンスです]** をオンにします。

### 危険度の高い展開のカスタム通知を作成する
<a id="create-a-custom-notification-for-high-risk-deployments" class="xliff"></a>
次の手順を使用して、影響の大きい展開のカスタム通知を作成します。
1. Configuration Manager コンソールの **[ソフトウェア ライブラリ]** > **[オペレーティング システム]** > **[タスク シーケンス]** の順に選択します。
2. 編集するタスク シーケンスを選択し、**[プロパティ]** をクリックします。
3. **[ユーザー通知]** タブの **[カスタム テキストを使用する]** をオンにします。
>  [!NOTE]    
>  **[これは、インパクトのあるタスク シーケンスです]** がオンの場合にのみ、ユーザー通知テキストを設定できます。

4. 次の設定を構成します (各テキスト ボックスは最大 255 文字です)。

  **ユーザー通知の見出しテキスト**: ソフトウェア センターのユーザー通知に表示する青色のテキストを指定します。 たとえば、既定のユーザー通知では、このセクションに "このコンピューターのオペレーティング システムをアップグレードすることを確認します" のようなテキストが表示されます。

  **ユーザー通知のメッセージ テキスト**: カスタム通知の本文を入力する 3 つのテキスト ボックスがあります。 すべてのテキスト ボックスでテキストを追加する必要があります。
  - 1 つ目のテキスト ボックス: ユーザーの手順など、テキストのメインの本文を指定します。 たとえば、既定のユーザー通知では、このセクションには "オペレーティング システムのアップグレードには時間がかかります。また、コンピューターが数回再起動される場合があります" のようなテキストが表示されます。
  - 2 つ目のテキスト ボックス: メインの本文の下に表示される太字のテキストを指定します。 たとえば、既定のユーザー通知では、このセクションに "このインプレース アップグレードでは、新しいオペレーティング システムがインストールされ、アプリ、データ、設定が自動的に移行されます" のようなテキストが表示されます。
  - 3 つ目のテキスト ボックス: 太字のテキストの下の最終行を指定します。 たとえば、既定のユーザー通知では、このセクションに "インストールを開始するには、開始するには [インストール]、 それ以外の場合は [キャンセル] をクリックしてください" のようなテキストが表示されます。   
    
たとえば、プロパティでは次のようなカスタム通知を構成できます。

![タスク シーケンスのカスタム通知](..\media\user-notification.png)

エンドユーザーがソフトウェア センターからインストールを開くときに、次の通知メッセージが表示されます。

![タスク シーケンスのカスタム通知](..\media\user-notification-enduser.png)


##  <a name="BKMK_DistributeTS"></a> タスク シーケンスによって参照されるコンテンツの配布  
 コンテンツを参照するタスク シーケンスをクライアントで実行する前に、そのコンテンツを配布ポイントに配布する必要があります。 任意の時に、タスク シーケンスを選択してそのコンテンツを配布し、配布用の参照パッケージの新しい一覧を作成することができます。 更新されたコンテンツを持つタスク シーケンスに変更を加える場合、これをクライアントに対して使用可能にする前に、コンテンツを再配布する必要があります。 タスク シーケンスで参照されるコンテンツを配布するには、次の手順に従います。  

#### 参照コンテンツを配布ポイントに配布するには
<a id="to-distribute-referenced-content-to-distribution-points" class="xliff"></a>  

1.  Configuration Manager コンソールで、 **[ソフトウェア ライブラリ]** をクリックします。  

2.  **[ソフトウェア ライブラリ]** ワークスペースで **[オペレーティング システム]** を展開して、 **[タスク シーケンス]** をクリックします。  

3.  **[タスク シーケンス]** 一覧で、配布するタスク シーケンスを選択します。  

4.  **[ホーム]** タブの **[展開]** グループで **[コンテンツの配布]** をクリックして、コンテンツの配布ウィザードを起動します。  

5.  **[全般]** ページで、配布対象のタスク シーケンスが正しく選択されていることを確認して、 **[次へ]** をクリックします。  

6.  **[コンテンツ]** ページで、配布するコンテンツ (タスク シーケンスによって参照されるブート イメージなど) を確認して、 **[次へ]** をクリックします。  

7.  **[コンテンツの配布先]** ページで、タスク シーケンスのコンテンツの配布先となるコレクション、配布ポイント、または配布ポイント グループを指定して、 **[次へ]** をクリックします。  

    > [!IMPORTANT]  
    >  選択したタスク シーケンスで既に特定の配布ポイントに配布されている参照コンテンツを参照する場合、その配布ポイントはウィザードの一覧には表示されません。  

8.  ウィザードを完了します。  

 タスク シーケンスで参照されるコンテンツを事前設定できます。 Configuration Manager により、ファイル、関連する依存関係、選択したコンテンツに関連するメタデータを含む、圧縮された事前設定コンテンツ ファイルが作成されます。 次に、サイト サーバー、セカンダリ サイト、または配付ポイントにコンテンツを手動でインポートします。 コンテンツ ファイルを事前設定する方法について詳しくは「 [Prestage content](../../core/servers/deploy/configure/deploy-and-manage-content.md#a-namebkmkprestagea-use-prestaged-content)」 (コンテンツの事前設定) を参照してください。  

##  <a name="BKMK_DeployTS"></a> タスク シーケンスの展開  
 タスク シーケンスをコレクション内のコンピューターに展開するには、次の手順に従います。  

> [!WARNING]  
>  危険度の高いタスク シーケンスの展開については、その動作を管理することができます。 危険度の高い展開とは、展開が自動的にインストールされますが、望ましくない結果が生じる可能性がある展開です。 たとえば、オペレーティング システムを展開する **必須** の目的を持つタスク シーケンスは、危険度の高い展開と見なされます。 詳細については、「[危険度の高い展開を管理するための設定](../../protect/understand/settings-to-manage-high-risk-deployments.md)」を参照してください。  

> [!NOTE]  
>  タスク シーケンスの展開に関する状態メッセージは、プライマリ サイトでは [メッセージ] ウィンドウに表示されますが、中央管理サイトでは表示されません。  

#### タスク シーケンスを展開するには
<a id="to-deploy-a-task-sequence" class="xliff"></a>  

1.  Configuration Manager コンソールで、 **[ソフトウェア ライブラリ]** をクリックします。  

2.  [ **ソフトウェア ライブラリ** ] ワークスペースで [ **オペレーティング システム**] を展開して、[ **タスク シーケンス**] をクリックします。  

3.  **[タスク シーケンス]** 一覧で、展開するタスク シーケンスを選択します。  

4.  [ **ホーム** ] タブの [ **展開** ] グループで、[ **展開**] をクリックします。  

    > [!NOTE]  
    >  **[展開]** を使用できない場合は、タスク シーケンスに無効な参照が含まれています。  参照を修正してから、あらためて、タスク シーケンスを展開してみてください。  

5.  [ **全般** ] ページで、次の情報を指定してから、[ **次へ**] をクリックします。  

    -   **[タスク シーケンス]**: 展開するタスク シーケンスを指定します。 既定では、このボックスには選んだタスク シーケンスが表示されます。  

    -   **[コレクション]**: タスク シーケンスを実行するコンピューターを含むコレクションを指定します。  

         オペレーティング システムをインストールするタスク シーケンスを不適切なコレクション ( **すべてのシステム** など) に展開しないでください。 必ず、選択するコレクションにはタスク シーケンスを実行するコンピューターのみが含まれるようにしてください。  

        > [!NOTE]  
        >  危険度の高い展開 (オペレーティング システムなど) を行う際、 **[コレクションの選択]** ウィンドウには、サイトのプロパティで構成されている展開の検証の設定に適合するカスタム コレクションのみが表示されます。 危険度の高い展開は、常にカスタム コレクション、作成されたコレクション、および組み込みの **不明なコンピューター** コレクションに制限されています。 危険度の高い展開を作成する際、 **すべてのシステム**などの組み込みのコレクションは選択できません。 **[メンバー数がサイトの最小サイズ構成を超えるコレクションを非表示にする]** をオフにすると、構成済みの最大サイズよりクライアント数が少ないすべてのカスタム コレクションが表示されます。 詳細については、「[危険度の高い展開を管理するための設定](../../protect/understand/settings-to-manage-high-risk-deployments.md)」を参照してください。  
        >   
        >  展開の検証の設定は、コレクションの現在のメンバーシップに基づきます。 タスク シーケンスを展開した後に、コレクションのメンバーシップは危険度の高い展開の設定に対して再評価されません。  
        >   
        >  たとえば、**[既定サイズ]** を 100、**[最大サイズ]** を 1000 に設定します。 危険度の高い展開の作成時に、 **[コレクションの選択]** ウィンドウには、含まれるクライアント数が 100 未満のコレクションのみが表示されます。 **[メンバー数がサイトの最小サイズ構成を超えるコレクションを非表示にする]** の設定をオフにすると、含まれるクライアント数が 1000 未満のコレクションがウィンドウに表示されます。  
        >   
        >  サイトの役割を含むコレクションを選択すると、次のことが適用されます。  
        >   
        >  -   コレクションにサイト システム サーバーが含まれていて、展開の検証の設定で、サイト システム サーバーが含まれるコレクションをブロックするように構成されていると、エラーが発生し続行することができません。  
        > -   コレクションにサイト システム サーバーが含まれていて、展開の検証の設定で、サイト システム サーバーが含まれている場合に警告するように構成されていると、コレクションのサイズが既定の値を超えている場合、またはコレクションにサーバーが含まれている場合は、ソフトウェアの展開ウィザードに危険度が高いことを通知する警告が表示されます。 この場合、危険度の高い展開を作成することに同意する必要があります。これにより、監査ステータス メッセージが作成されます。  

    -   **[コメント (オプション)]**: タスク シーケンスの展開について説明する追加情報を指定します。  

6.  **[展開設定]** ページで、次の情報を指定して、 **[次へ]** をクリックします。  

    -   **[目的]**: ドロップダウン リストから、次のいずれかのオプションを選びます。  

        -   **[利用可能]**: タスク シーケンスがユーザーに展開された場合、ユーザーはアプリケーション カタログで発行されたタスク シーケンスを見て、必要に応じて要求できます。 タスク シーケンスがデバイスに展開された場合は、ユーザーはソフトウェア センターでそれを見て、必要に応じてインストールすることができます。  

        -   **[必須]**: タスク シーケンスは、構成されたスケジュールに従って自動的に展開されます。 ただし、ユーザーはタスク シーケンスの展開ステータスを (非表示にされていなければ) 追跡して、ソフトウェア センターを使用してタスク シーケンスを期限前にインストールすることができます。  

    -   **[ユーザーのログインに関係なくスケジュールに従って自動的に展開する]**: このオプションは、タスク シーケンスを展開する場合には使用できません。  

    -   **[ウェイクアップ パケットを送信する]**: 展開目的に **[必須]** が設定されていて、このオプションが選ばれていると、インストールの期限時間にスリープ状態のコンピューターをウェイクさせるために、展開のインストール前にコンピューターにウェイクアップ パケットが送信されます。 このオプションを使用する前に、コンピューターおよびネットワークを Wake On Lan 用に構成する必要があります。  

    -   **[インストールの期限後、クライアントが従量制のインターネット接続を使用してコンテンツをダウンロードできるようにする (追加料金が生じる可能性があります)]**: アプリケーションをインストールし、オペレーティング システムを展開しないタスク シーケンスがある場合、従量制インターネット接続を使用するときに、クライアントがインストールの期限後にコンテンツをダウンロードすることを許可するかどうかを指定できます。 インターネット プロバイダーは、従量制インターネット接続を使用しているときに送受信したデータ量に基づいて課金することがあります。  

        > [!NOTE]  
        >  従量制インターネット接続は、オペレーティング システムを展開しないタスク シーケンスで使用できる可能性がありますが、サポートされません。  

    -   **[ユーザーがこのアプリケーションを要求した場合に管理者の承認を必要とする]**: タスク シーケンスを展開するときは、このオプションを使用できません。  

    -   **[利用できるようにする項目]**: タスク シーケンスを構成マネージャー クライアント、メディア、または PXE で使用可能にするかどうかを指定します。  

        > [!IMPORTANT]  
        >  自動タスク シーケンスの展開に [ **メディアと PXE のみ (非表示)** ] 設定を使用します。 ユーザーの操作なしでコンピューターが展開に自動的に起動されるように、[ **オペレーティング システムの無人展開を許可する** ] を選択し、メディアの一部として SMSTSPreferredAdvertID 変数を設定します。 タスク シーケンス変数の詳細については、「[タスク シーケンス組み込み変数](../understand/task-sequence-built-in-variables.md)」を参照してください。  

7.  [ **スケジュール** ] ページで、次の情報を指定して、[ **次へ** ] をクリックします。  

    > [!IMPORTANT]  
    >  PXE またはブート メディアから Windows PE クライアントを起動した時は、クライアントは展開スケジュールを評価しません (開始、期限切れまたは期限の時間)。 完全な Windows オペレーティング システムから開始されるクライアントへの展開でのスケジュールのみが構成されます。 Windows PE から起動するクライアントに展開されているアクティブなタスク シーケンスを制御するメンテナンス ウィンドウなど、他の方法を使用してください。  

    -   **[この展開が使用可能になる日時を指定する]**: タスク シーケンスを対象コンピューターで実行可能にする日時を指定します。 [ **UTC** ] チェック ボックスを選択すると、この設定により、対象コンピューターのローカル時刻に従って、複数の対象コンピューターで、異なる時刻ではなく同じ時刻に、タスク シーケンスが使用可能になります。  

         必要な時刻よりも開始時刻が早い場合、クライアントは、指定された開始時刻にタスク シーケンスをダウンロードします。  

    -   **[この展開の有効期限を指定する]**: タスク シーケンスを対象コンピューターで期限切れにする日時を指定します。 [ **UTC** ] チェック ボックスを選択すると、この設定により、対象コンピューターのローカル時刻に従って、複数の対象コンピューターで、異なる時刻ではなく同じ時刻に、タスク シーケンスが期限切れになります。  

    -   **[割り当てスケジュール]**: 必須のタスク シーケンスをセットアップ先のコンピューターで実行する日時を指定します。 複数のスケジュールを追加することができます。  

         スケジュールの開始日時、タスク シーケンスを毎週、毎月、カスタム間隔のうちのどの頻度で実行するか、また、タスク シーケンスをイベント (コンピューターへのログインやログオフなど) の後で実行するかどうかを指定することができます。  

        > [!NOTE]  
        >  必須のタスク シーケンスが使用可能になる日時よりも前に開始日時をスケジュールすると、Configuration Manager クライアントは、タスク シーケンスがもっと早い日時に使用可能になっても、スケジュールされた開始時刻にタスク シーケンスをダウンロードします。  

    -   **[再実行の動作]**: タスク シーケンスをどのような場合に再実行するかを指定します。 次のいずれかを指定することができます。  

        -   **[展開されたプログラムを再実行しない]**: 既にクライアントで実行されている場合、タスク シーケンスは再実行されません。 最初に実行が失敗していても、またはタスク シーケンス ファイルが変更されていても、タスク シーケンスは再実行されません。  

        -   **[プログラムを常に再実行する]**: 展開がスケジュールされている場合に、既にクライアントで正常に実行されていても、タスク シーケンスが常に再実行されます。 この設定は、特に、タスク シーケンスが定期的に更新される反復的な展開を使用する場合に便利です。  

            > [!IMPORTANT]  
            >  このオプションは、既定で設定されますが、必要な展開を割り当てるまでは影響を及ぼしません。 使用可能な展開は、いつでもユーザーが再実行することができます。  

        -   **[前回失敗した場合に再実行する]**: 展開がスケジュールされている場合に、前回の実行が失敗していれば、タスク シーケンスが再実行されます。 この設定は、特に、必須の展開で前回の実行が失敗したときに自動的に割り当てスケジュールに従って再試行されるようにする場合に便利です。  

        -   [前回成功した場合に再実行する]: 前回クライアントで正常に実行された場合にのみ、タスク シーケンスが再実行されます。 この設定は、特に、タスク シーケンスが定期的に更新され、それぞれの更新で前回の更新プログラムが正常にインストールされていることが必要となる反復的な展開を使用する場合に便利です。  

        > [!NOTE]  
        >  ユーザーは使用可能なタスク シーケンスの展開を再実行できるので、使用可能なタスク シーケンスを実稼働環境に展開する前に、ユーザーがタスク シーケンスを何回も再実行した場合にどのようなことが起こるかを慎重に評価およびテストしてください。  

8.  [ **ユーザー エクスペリエンス** ] ページで、次の情報を指定して、[ **次へ** ] をクリックします。  

    -   **[割り当てられたプログラムの個別の実行をユーザーに許可する]**: 必要なタスク シーケンスをユーザーが展開割り当てとは別個に実行できるようにするかどうかを指定します。  

    -   **[タスク シーケンスの進行状況の表示]**: 構成マネージャー クライアントでタスク シーケンスの進捗状況を表示するかどうかを指定します。  

    -   **[ソフトウェアのインストール]**: スケジュールされている日時以降の構成済みメンテナンス期間外でユーザーがソフトウェアをインストールできるようにするかどうかを指定します。  

    -   **[システムの再起動 (インストールの完了に必要な場合)]**: ソフトウェアのインストール後に、割り当て日時より後のメンテナンス期間外でユーザーがコンピューターを再起動できるようにするかどうかを指定します。  

    -   **[クライアントのタスク シーケンスをインターネット上で実行できるようにする]**: Configuration Manager でインターネット上に存在するものとして検出されるインターネット ベースのクライアントでタスク シーケンスを実行できるようにするかどうかを指定します。 オペレーティング システムなどのソフトウェアをインストールする操作は、この設定ではサポートされていません。 このオプションは、標準オペレーティング システムで操作を実行する一般的なスクリプト ベースのタスク シーケンスにのみ使用してください。  

9. [ **アラート** ] ページで、このタスク シーケンスによる展開に必要なアラート設定を指定して、[ **次へ** ] をクリックします。  

10. [ **配布ポイント** ] ページで、次の情報を指定して、[ **次へ** ] をクリックします。  

    -   **[展開オプション]**: 次のいずれかを指定することができます。  

        > [!NOTE]  
        >  オペレーティング システムの展開にマルチキャストを使用する場合、必要に応じて、タスク シーケンスの実行前に、コンテンツを対象コンピューターにダウンロードする必要があります。  

        -   タスク シーケンスで必要な場合、クライアントが配布ポイントから対象コンピューターにコンテンツをダウンロードするように指定します。  

        -   タスク シーケンスを実行する前に、クライアントが、配布ポイントから対象コンピューターにすべてのコンテンツをダウンロードするように指定します。 タスク シーケンスを PXE およびブート メディアの展開に使用できるように指定した場合、このオプションは表示されません ([ **展開設定** ] ページを参照してください)。  

        -   クライアントが配布ポイントからコンテンツを実行するように指定します。 タスク シーケンスに関連付けられたすべてのパッケージが、配布ポイントでパッケージ共有を使用できるように構成されている場合にのみ、このオプションを使用できます。 コンテンツがパッケージ共有を使用できるようにするには、各パッケージの [ **プロパティ** ] の [ **データ アクセス** ] タブを参照してください。  

    -   **[ローカルの配布ポイントを利用できない場合は、リモートの配布ポイントを使用する]**: クライアントで低速ネットワーク上または信頼性の低いネットワーク上の配布ポイントを使用してタスク シーケンスに必要なコンテンツをダウンロードするかどうかを指定します。  

11. ウィザードを完了します。  

##  <a name="BKMK_ExportImport"></a> タスク シーケンスのエクスポートおよびインポート  
 タスク シーケンスは、オペレーティング システム イメージ、ブート イメージ、クライアント エージェント パッケージ、ドライバー パッケージ、依存関係があるアプリケーションなど、関連するオブジェクトを含めて、または含めずに、インポートおよびエクスポートすることができます。  

 タスク シーケンスをエクスポートおよびインポートする際には、次のことを考慮してください。  

-   タスク シーケンスに含まれているパスワードはエクスポートされません。 パスワードを含むタスク シーケンスをエクスポートおよびインポートする場合は、インポートされたタスク シーケンスを編集して任意のパスワードを再指定する必要があります。 [Join Domain or Workgroup](../understand/task-sequence-steps.md#BKMK_JoinDomainorWorkgroup)、 [Connect To Network Folder](../understand/task-sequence-steps.md#BKMK_ConnectToNetworkFolder)、 [Run Command Line](../understand/task-sequence-steps.md#BKMK_RunCommandLine) アクションに対するパスワードが指定されていることをご確認ください。  

- **動的変数の設定**手順でタスク シーケンスをエクスポートするとき、**秘密の値**設定で構成された変数の値はエクスポートされません。 タスク シーケンスのインポート後、変数の値を再入力する必要があります。

-   ベスト プラクティスとして、複数のプライマリ サイトがある場合は、中央管理サイトにタスク シーケンスをインポートしてください。  

 タスク シーケンスのエクスポートおよびインポートは、次の手順に従います。  

#### タスク シーケンスをエクスポートするには
<a id="to-export-task-sequences" class="xliff"></a>  

1.  Configuration Manager コンソールで、 **[ソフトウェア ライブラリ]** をクリックします。  

2.  [ **ソフトウェア ライブラリ** ] ワークスペースで [ **オペレーティング システム**] を展開して、[ **タスク シーケンス**] をクリックします。  

3.  [ **タスク シーケンス** ] 一覧で、エクスポートするタスク シーケンスを選択します。 複数のタスク シーケンスを選択すると、それらは 1 つのエクスポート ファイルに保存されます。  

4.  [ **ホーム** ] タブの [ **タスク シーケンス** ] グループで、[ **エクスポート** ] をクリックして、タスク シーケンスのエクスポート ウィザードを開始します。  

5.  [ **全般** ] ページで、次の設定を指定して [ **次へ** ] をクリックします。  

    -   [ **ファイル** ] ボックスで、エクスポート ファイルの場所と名前を指定します。 ファイル名を直接入力する場合は、必ず .zip 拡張子をファイル名に含めてください。 エクスポート ファイルを参照する場合は、自動的にファイル名の拡張子が追加されます。  

    -   タスク シーケンスの依存関係をエクスポートしない場合は [ **タスク シーケンスのすべての依存関係をエクスポート** ] チェック ボックスをオフにします。 既定では、すべての関連オブジェクトがスキャンされて、タスク シーケンスと共にエクスポートされます。 これには、アプリケーションに関するあらゆる依存関係が含まれます。  

    -   コンテンツをパッケージ ソースからエクスポート場所にコピーしない場合は、[ **選択したタスク シーケンスとその依存関係をすべてエクスポート** ] チェック ボックスをオフにします。 このチェック ボックスを選択すると、タスク シーケンスのインポート ウィザードでインポート パスが新しいパッケージ ソースの場所として使用されます。  

    -   [ **管理者のコメント** ] ボックスに、エクスポートするタスク シーケンスの説明を追加します。  

6.  ウィザードを完了します。  

 次の出力ファイルが作成されます。  

-   コンテンツをエクスポートしない場合: .zip ファイル。  

-   コンテンツをエクスポートする場合: *export*_files という名前の .zip ファイル ( *export* は、エクスポートされるコンテンツを含む .zip ファイルの名前)。  

 タスク シーケンスをエクスポートするときにコンテンツを含める場合は、必ず .zip ファイルおよび *export*_files フォルダーをコピーしてください。さもないと、インポートが失敗します。  

#### タスク シーケンスをインポートするには
<a id="to-import-task-sequences" class="xliff"></a>  

1.  Configuration Manager コンソールで、 **[ソフトウェア ライブラリ]** をクリックします。  

2.  [ **ソフトウェア ライブラリ** ] ワークスペースで [ **オペレーティング システム**] を展開して、[ **タスク シーケンス**] をクリックします。  

3.  [ **ホーム** ] タブの [ **作成** ] グループで、[ **タスク シーケンスのインポート** ] をクリックして、タスク シーケンスのインポート ウィザードを開始します。  

4.  [ **全般** ] ページで、エクスポートする .zip ファイルを指定して、[ **次へ** ] をクリックします。  

5.  [ **ファイル コンテンツ** ] ページで、インポートするオブジェクトごとに必要なアクションを選択します。 このページには、Configuration Manager でインポートされるすべてのオブジェクトが表示されます。  

    -   まだオブジェクトがまったくインポートされていない場合は、[ **新規作成** ] を選択します。  

    -   既にオブジェクトがインポートされている場合は、次のいずれかのアクションを選択します。  

        -   **[重複を無視する]** (既定): このアクションでは、オブジェクトはインポートされません。 代わりに、既存のオブジェクトがタスク シーケンスにリンクされます。  

        -   **[上書き]**: このアクションでは、既存のオブジェクトがインポートされたオブジェクトで上書きされます。 アプリケーションについては、リビジョンを追加して既存のアプリケーションを更新したり、新しいアプリケーションを作成したりすることができます。  

6.  ウィザードを完了します。  

 タスク シーケンスをインポートしたら、タスク シーケンスを編集して、元のタスク シーケンスに含まれていたパスワードを指定してください。 セキュリティ上の理由により、パスワードはエクスポートされません。  

##  <a name="BKMK_CreateTSVariables"></a> コンピューターおよびコレクションのタスク シーケンスの変数の作成  
コンピューターおよびコレクションのカスタム タスク シーケンス変数を定義することができます。 コンピューターについて定義される変数を、コンピューターごとのタスク シーケンス変数といいます。 コレクションについて定義される変数を、コレクションごとのタスク シーケンス変数といいます。 競合が発生する場合は、コンピューターごとの変数がコレクションごとの変数より優先されます。 つまり、特定のコンピューターに自動的に割り当てられるタスク シーケンス変数は、そのコンピューターを含むコレクションに割り当てられる変数よりも優先されるということです。  

たとえば、コレクション ABC で、ある変数がコレクションに割り当てられており、コレクション ABC のメンバーであるコンピューター XYZ に同じ名前の変数が割り当てられている場合、コンピューター XYZ に割り当てられている変数の方がコレクション ABC に割り当てられている変数よりも優先されます。  

コンピューターごとの変数およびコレクションごとの変数を非表示にして、Configuration Manager コンソールに表示されないようにすることができます。 それらの変数が非表示にされなくなるようにする場合は、変数を削除してから、非表示にするオプションを選択せずに再定義する必要があります。 **[この値を Configuration Manager コンソールに表示しない]** オプションを使用すると、コンソールに変数の値は表示されませんが、実行時にタスク シーケンスで引き続き使用できます。  

> [!WARNING]    
> **[この値を Configuration Manager コンソールに表示しない]** 設定は Configuration Manager コンソールに適用されますが、変数の値はタスク シーケンスのログ ファイル (SMSTS.LOG) に引き続き表示されます。 

コンピューターごとの変数は、プライマリ サイトまたは中央管理サイトで管理することができます。 Configuration Manager では、1 コンピューターあたり 1000 を超える変数の割り当てはサポートされていません。  

> [!IMPORTANT]  
>  タスク シーケンスにコレクションごとの変数を使用する際には、次のことを考慮してください。  
>   
> - コレクションに対する変更は常に階層全体にレプリケートされるので、コレクション変数に加えられた変更は、現在のサイトのメンバーだけでなく、階層全体のコレクションのすべてのメンバーに適用されます。  
> - コレクションを削除すると、そのアクションにより、コレクションに構成されているタスク シーケンス変数も削除されます。  

 コンピューターまたはコレクションのタスク シーケンス変数を作成するには、次の手順に従います。  

#### コンピューターのタスク シーケンス変数を作成するには
<a id="to-create-task-sequence-variables-for-a-computer" class="xliff"></a>  

1.  Configuration Manager コンソールで、[ **資産とコンプライアンス**] をクリックします。  

2.  [ **資産とコンプライアンス** ] ワークスペースで、変数の追加先のコンピューターを含むコレクションを展開します。  

3.  コレクションを選択し、[ **プロパティ** ] をクリックします。  

4.  [ **プロパティ** ] ダイアログ ボックスで、[ **変数** ] タブをクリックします。  

5.  作成する変数ごとに、**[<新規\> 変数]** ダイアログ ボックスの **[新規]** アイコンをクリックして、タスク シーケンス変数の名前と値を指定します。 変数を非表示にする場合は、**[この値を Configuration Manager コンソールに表示しない]** チェック ボックスをオフにし、変数が Configuration Manager コンソールに表示されないようにします。  

6.  すべての変数をコンピューターに追加したら、[OK ****] をクリックします。  

#### コレクションのタスク シーケンス変数を作成するには
<a id="to-create-task-sequence-variables-for-a-collection" class="xliff"></a>  

1.  Configuration Manager コンソールで、[ **資産とコンプライアンス**] をクリックします。  

2.  [ **資産とコンプライアンス** ] ワークスペースで、変数の追加先のコレクションを選択して、[ **プロパティ** ] を選択します。  

3.  [ **プロパティ** ] ダイアログ ボックスで、[ **コレクション変数** ] タブをクリックします。  

4.  作成する変数ごとに、**[<新規\> 変数]** ダイアログ ボックスの **[新規]** アイコンをクリックして、タスク シーケンス変数の名前と値を指定します。 変数を非表示にする場合は、**[この値を Configuration Manager コンソールに表示しない]** チェック ボックスをオフにし、変数が Configuration Manager コンソールに表示されないようにします。  

5.  必要に応じて、タスク シーケンス変数の評価時に Configuration Manager で使用される優先度を指定します。  

6.  すべての変数をコレクションに追加したら、[OK ****] をクリックします。  

##  <a name="BKMK_AdditionalActionsTS"></a> タスク シーケンスを管理する追加のアクション  
 タスク シーケンスを選択する場合にその他のアクションを使用して、タスク シーケンスを管理することができます。  

#### 管理するタスク シーケンスを選択するには
<a id="to-select-a-task-sequence-to-manage" class="xliff"></a>  

1.  Configuration Manager コンソールで、[ソフトウェア ライブラリ] ****をクリックします。  

2.  [ **ソフトウェア ライブラリ** ] ワークスペースで [ **オペレーティング システム** ] を展開して、[ **タスク シーケンス** ] をクリックします。  

3.  [ **タスク シーケンス** ] 一覧で、管理するタスク シーケンスを選択して、次のいずれかのオプションを選択します。  

 タスク シーケンスの管理のためのその他のアクションの詳細については、次の表を参照してください。  

|操作|説明|  
|------------|-----------------|  
|**コピー**|選択されたタスク シーケンスのコピーを作成します。 このアクションは、既存のタスク シーケンスを基にして新しいタスク シーケンスを作成する場合に便利です。<br /><br /> タスク シーケンスのコピーをフォルダーに作成すると、そのコピーは、タスク シーケンス ノードが最新の情報に更新されるまで表示されます。  更新後、コピーはルート フォルダーに表示されます。|  
|**無効化**|タスク シーケンスを無効にしてコンピューターで実行できないようにします。 無効になっているタスク シーケンスは、コンピューターに展開することはできますが、有効になるまでコンピューターでは実行されません。|  
|**有効化**|タスク シーケンスを有効にして実行できるようにします。 展開済みのタスク シーケンスは、有効にした後に再展開する必要はありません。|  
|**事前設定コンテンツ ファイルの作成**|タスク シーケンスのコンテンツを事前設定するために、事前設定コンテンツ ファイルの作成ウィザードを起動します。 事前定義済みコンテンツ ファイルの作成方法については、「[Prestage content](../../core/servers/deploy/configure/deploy-and-manage-content.md#a-namebkmkprestagea-use-prestaged-content)」 (コンテンツの事前設定) を参照してください。|  
|**移動**|選択されたタスク シーケンスを別のフォルダーに移動します。|  

## 次のステップ
<a id="next-steps" class="xliff"></a>
[エンタープライズ オペレーティング システムを展開するシナリオ](scenarios-to-deploy-enterprise-operating-systems.md)

