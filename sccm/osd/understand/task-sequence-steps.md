---
title: "タスク シーケンス ステップ - Configuration Manager | Microsoft Docs"
description: "Configuration Manager タスク シーケンスに追加できるタスク シーケンス ステップについて説明します。"
ms.custom: na
ms.date: 03/26/2017
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology:
- configmgr-osd
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 7c888a6f-8e37-4be5-8edb-832b218f266d
caps.latest.revision: 26
caps.handback.revision: 0
author: Dougeby
ms.author: dougeby
manager: angrobe
ms.translationtype: Human Translation
ms.sourcegitcommit: 6f9e6e93fce95666503907010a5c253158c5de7c
ms.openlocfilehash: f648d7626af50d95fbaa5a7a2abd821a9c47f5d1
ms.contentlocale: ja-jp
ms.lasthandoff: 07/07/2017


---
# System Center Configuration Manager のタスク シーケンスのステップ
<a id="task-sequence-steps-in-system-center-configuration-manager" class="xliff"></a>

*適用対象: System Center Configuration Manager (Current Branch)*

次のタスク シーケンス ステップは、Configuration Manager のタスク シーケンスに追加できます。 タスク シーケンスの編集については、「 [Edit a task sequence](../deploy-use/manage-task-sequences-to-automate-tasks.md#BKMK_ModifyTaskSequence)」を参照してください。  


##  <a name="BKMK_ApplyDataImage"></a> [データ イメージの適用] タスク シーケンス ステップ  
 [ **データ イメージの適用** ] タスク シーケンス ステップを使用して、データ イメージを指定された対象パーティションにコピーします。  

 このステップは Windows PE でのみ実行されます。 このステップは標準のオペレーティング システムでは実行できません。 このアクションのタスク シーケンス変数の詳細については、「[Task sequence action variables](task-sequence-action-variables.md)」 (タスク シーケンスのアクション変数) を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **イメージ パッケージ**  
 [ **参照** ] をクリックして、このタスク シーケンス ステップで使用する **イメージ パッケージ**を指定します。 [ **パッケージの選択** ] ダイアログ ボックスでインストールするパッケージを選択します。 既存の各イメージ パッケージの関連プロパティ情報が [ **パッケージの選択** ] ダイアログ ボックスの下部に表示されます。 ドロップダウン リストを使用して、選択した **イメージ パッケージ** からインストールする **イメージ** を選択します。  

> [!NOTE]  
>  このタスク シーケンス アクションではイメージをデータ ファイルと見なし、イメージをオペレーティング システムとしてブートするために必要なセットアップは行いません。  

 **保存先**  
 既存のフォーマット済みのパーティションおよびハード ディスク、特定の論理ドライブ文字、または論理ドライブ文字を格納するタスク シーケンス変数の名前を指定します。  

-   **次に利用可能なパーティション** – このタスク シーケンスで、これまでオペレーティング システムの適用またはデータ イメージの適用アクションの対象になったことがない、次のパーティションを使用します。  

-   **特定のディスクとパーティション** – **ディスク**番号 (0 から開始) および**パーティション**番号 (1 から開始) を選択します。  

-   **特定の論理ドライブ文字** – Windows PE によりパーティションに割り当てられた**ドライブ文字**を指定します。 このドライブ文字は、新しく展開されたオペレーティング システムが割り当てるドライブ文字とは異なる場合があります。  

-   **変数に格納されている論理ドライブ文字** – Windows PE によりパーティションに割り当てられたドライブ文字を含むタスク シーケンス変数を指定します。 この変数は通常、[ **ディスクのフォーマットとパーティション作成** ] タスク シーケンス アクションにある [ **パーティションのプロパティ** ] ダイアログ ボックスの [詳細設定] セクションで設定されます。  

 **イメージを適用する前にパーティションのすべてのコンテンツを削除する**  
 このオプションを選択すると、イメージのインストール前に対象パーティションのすべてのファイルが削除されます。 パーティションのコンテンツを削除しないことにより、このステップを使用して、以前にターゲットにしたパーティションに追加コンテンツを適用できます。  

##  <a name="BKMK_ApplyDriverPackage"></a> ドライバー パッケージの適用  
 [ **ドライバー パッケージの適用** ] タスク シーケンス ステップを使用して、ドライバー パッケージ内のすべてのドライバーをダウンロードし、Windows オペレーティング システムにインストールします。

 [ **ドライバー パッケージの適用** ] タスク シーケンス ステップでは、ドライバー パッケージ内のすべてのデバイス ドライバーを Windows セットアップで使用できるようにします。 **[オペレーティング システムの適用]** ステップと **[Windows と ConfigMgr のセットアップ]** ステップの間のタスク シーケンスにこのステップを追加して、ドライバー パッケージ内のデバイス ドライバーを Windows で使用可能にすることができます。 通常、[ **ドライバー パッケージの適用** ] タスク シーケンス ステップは、順番上、[ **ドライバーの自動適用** ] タスク シーケンス ステップの後に置かれます。 [ **ドライバー パッケージの適用** ] タスク シーケンス ステップは、スタンドアロンのメディア展開シナリオでも便利です。  

 同様のデバイス ドライバーは 1 つのドライバー パッケージに配置し、適切な配布ポイントに配布するようにします。 配布後に、Configuration Manager クライアント コンピューターでドライバーをインストールできるようになります。 たとえば、ある製造元のすべてのデバイス ドライバーを 1 つのドライバー パッケージに配置してから、関連するコンピューターがアクセスできる配布ポイントにパッケージを配布することができます。

 このステップは、スタンドアロン メディアだけでなく、プラグ アンド プレイ スキャンで検出されないデバイス (ネットワーク プリンターなど) 用ドライバーを含め、特定のドライバーをインストールする管理者にとっても役に立ちます。  

 このタスク シーケンス ステップは Windows PE でのみ実行されます。 このステップは標準のオペレーティング システムでは実行できません。 このアクションのタスク シーケンス変数の詳細については、「 [Apply Driver Package Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_ApplyDriverPackage)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **ドライバー パッケージ**  
 [ **参照** ] をクリックし [ **パッケージの選択** ] ダイアログ ボックスを開いて、必要なデバイス ドライバーを含むドライバー パッケージを指定します。 使用可能にする既存パッケージを指定してください。 関連パッケージ プロパティは、ダイアログ ボックスの下部に表示されます。  

 **Vista 以前のオペレーティング システムをセットアップする前にインストールする必要がある大容量記憶装置ドライバーをパッケージから選択する**  
 Windows Vista 以前のオペレーティング システムのインストールに必要となる大容量記憶装置デバイス ドライバーを指定します。  

 **ドライバー**  
 Windows Vista 以前のオペレーティング システムの展開でセットアップする前にインストールする大容量記憶装置デバイス ドライバー ファイルを選択します。 ドロップダウン リストの項目は指定パッケージから入力されます。  

 **モデル**  
 Windows Vista 以前のオペレーティング システムの展開に必要となる、起動に不可欠なデバイスを指定します。  

 **署名されていないドライバーの無人インストールが許可されているバージョンの Windows でドライバーの無人インストールを行う**  
 参照コンピューターで署名されていないドライバーを Windows がインストールすることを許可するには、このオプションを選択します。  

##  <a name="BKMK_ApplyNetworkSettings"></a> ネットワーク設定の適用ステップ  
 [ **ネットワーク設定の適用** ] タスク シーケンス ステップを使用すると、対象のコンピューターに対してネットワークまたはワークグループの構成情報を指定できます。 指定された値は適切な応答ファイル形式で保存され、[ **Windows と ConfigMgr のセットアップ** ] タスク シーケンス ステップの実行中に Windows セットアップによって使用されます。  

 このタスク シーケンスのステップは標準のオペレーティング システムまたは Windows PE で実行されます。 このアクションのタスク シーケンス変数の詳細については、「 [Apply Network Settings Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_ApplyNetworkSettings)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **ワークグループに参加**  
 対象コンピューターを指定したワークグループに参加させるには、このオプションを選択します。 [ **ワークグループ** ] 行にワークグループの名前を入力します。 この値は、[ **ネットワーク設定のキャプチャ** ] タスク シーケンス ステップでキャプチャされた値により上書きされます。  

 **ドメインに参加**  
 対象コンピューターを指定したドメインに参加させるには、このオプションを選択します。 ドメイン (たとえば *fabricam.com* ) を直接指定するか参照します。 組織単位の LDAP (Lightweight Directory Access Protocol) パス (つまり  LDAP//OU=computers, DC=Fabricam.com, C=com) を指定するか参照します。  

 **アカウント**  
 コンピューターをドメインに参加させるには、[ **設定** ] をクリックして必要なアクセス許可を持つアカウントを指定します。 **[Windows ユーザー アカウント]** ダイアログ ボックスでは、 **ドメイン\ユーザー** の形式でユーザー名を入力できます。  

 **アダプター設定**  
 コンピューターの各ネットワーク アダプターのネットワーク構成を指定します。 [ **新規** ] をクリックして [ **ネットワーク設定** ] ダイアログ ボックスを開き、ネットワーク設定を指定します。 以前の [ **ネットワーク設定のキャプチャ** ] タスク シーケンスのステップでネットワーク設定がキャプチャされた場合は、ネットワーク アダプターに対して以前の設定が適用され、このステップで指定された設定は適用されません。 ネットワーク設定が過去にキャプチャされていない場合は、[ **ネットワーク設定の適用** ] ステップで指定された設定が Windows のデバイス列挙の順番にネットワーク アダプターに適用されます。  

##  <a name="BKMK_ApplyOperatingSystemImage"></a> オペレーティング システム イメージの適用  
 対象コンピューターにオペレーティング システムをインストールするには、[ **オペレーティング システム イメージの適用** ] タスク シーケンス ステップを使用します。 このタスク シーケンス ステップは、オペレーティング システムのインストールにオペレーティング システムのイメージまたはインストール パッケージのどちらを使用しているかによって、一連のアクションを実行します。  

 [ **オペレーティング システム イメージの適用** ] ステップは、オペレーティング システム イメージを使用する場合に次のアクションを実行します。  

1.  &#95;SMSTSUserStatePath タスク シーケンス変数で指定されるフォルダーのファイル以外、対象ボリューム上のすべてのコンテンツを削除します。  

2.  指定された .wim ファイルのコンテンツを、指定された送信先パーティションに抽出します。  

3.  応答ファイルを用意します:  

    1.  展開するオペレーティング システム用に既定の Windows セットアップ応答ファイル (sysprep.inf または unattend.xml) を新しく作成します。  

    2.  ユーザーが提供する応答ファイルから値を結合します。  

4.  Windows ブート ローダーをアクティブなパーティションにコピーします。  

5.  新しくインストールしたオペレーティング システムを参照するよう boot.ini またはブート構成データベース (BCD) を設定します。  

 [ **オペレーティング システム イメージの適用** ] ステップは、オペレーティング システムのインストール パッケージを使用する場合に次のアクションを実行します。  

1.  &#95;SMSTSUserStatePath タスク シーケンス変数で指定されるフォルダーのファイル以外、対象ボリューム上のすべてのコンテンツを削除します。  

2.  応答ファイルを用意します:  

    1.  Configuration Manager によって作成された標準値を使用して、新しい応答ファイルを作成します。  

    2.  ユーザーが提供する応答ファイルから値を結合します。  

> [!NOTE]  
>  Windows の実際のインストールは、[ **Windows と ConfigMgr のセットアップ** ] タスク シーケンス ステップにより開始されます。 [ **オペレーティング システムの適用** ] タスク シーケンス アクションを実行したあとには、OSDTargetSystemDrive タスク シーケンス変数が、オペレーティング システム ファイルが含まれるパーティションのドライブ文字に設定されます。  

 このタスク シーケンス ステップは Windows PE でのみ実行されます。 このステップは標準のオペレーティング システムでは実行できません。 このアクションのタスク シーケンス変数の詳細については、「 [Apply Operating System Image Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_ApplyOperatingSystem)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   **配布ポイントからコンテンツに直接アクセスする**:  

     タスク シーケンスでオペレーティング システム イメージに配布ポイントから直接アクセスするかどうかを指定するには、このオプションを使用します。 たとえば、記憶域の容量が限られている組み込みデバイスにオペレーティング システムを展開するときに、このオプションを使用することができます。 また、このオプションを選択する場合は、パッケージ プロパティの [ **データ アクセス** ] タブでパッケージ共有設定も構成する必要があります。  

    > [!NOTE]  
    >  この設定は、タスク シーケンス全体のすべてのコンテンツではなく、このタスク シーケンス ステップで指定したオペレーティング システムのイメージに対してのみ、 **ソフトウェアの展開ウィザード** の [ **配布ポイント** ] ページで構成される展開オプションよりも優先されます。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **キャプチャしたイメージからオペレーティング システムを適用する**  
 以前にキャプチャされたオペレーティング システム イメージをインストールします。 [ **参照** ] をクリックして [ **パッケージの選択** ] ダイアログ ボックスを開き、インストールする既存のイメージ パッケージを選択します。 指定した **イメージ パッケージ** に複数のイメージが関連付けられている場合は、ドロップダウン リストを使用して、この展開に使用する、関連付けられているイメージを指定します。 イメージをクリックすることで、既存の各イメージの基本情報を表示できます。  

 **元のインストール ソースからオペレーティング システムを適用する**  
 元のインストール ソースを使用してオペレーティング システムをインストールします。 [ **参照** ] をクリックして [ **オペレーティング システム インストール パッケージの選択** ] ダイアログ ボックスを開き、使用する既存のオペレーティング システム インストール パッケージを選択します。 イメージ ソースをクリックすることで、既存の各イメージ ソースの基本情報を表示できます。 ダイアログ ボックスの下部にある結果ウィンドウに、関連付けられているイメージのプロパティが表示されます。 指定したパッケージに複数のエディションが関連付けられている場合は、ドロップダウン リストを使用して、使用する、関連付けられている **エディション** を指定します。  

 **カスタム インストールに無人ファイルまたは sysprep 応答ファイルを使用する**  
 オペレーティング システムのバージョンおよびインストール方法によって異なる Windows セットアップ応答ファイル (**unattend.xml**、 **unattend.txt**、または **sysprep.inf**) を提供するには、このオプションを使用します。 指定するファイルには、Windows 応答ファイルがサポートする任意の標準の構成オプションを含めることができます。 たとえば、この構成オプションを使用して既定の Internet Explorer のホーム ページを指定できます。 応答ファイルを含むパッケージ、およびパッケージ内のファイルへの関連パスを指定する必要があります。  

> [!NOTE]  
>  ユーザーが指定する Windows セットアップ応答ファイルには %*varname*% という形式の埋め込みタスク シーケンス変数を含めることができます。varname は変数の名前です。 %*varname*% 文字列は、[ **Windows と ConfigMgr のセットアップ** ] タスク シーケンス アクションで、実際の変数の値の代替となります。 ただし、このような埋め込みタスク シーケンス変数は、unattend.xml 応答ファイルの数値のみのフィールドでは使用できません。  

 ユーザーが Windows セットアップ応答ファイルを指定しない場合、このタスク シーケンス アクションは自動的に応答ファイルを生成します。  

 **保存先**  
 既存のフォーマット済みのパーティションおよびハード ディスク、特定の論理ドライブ文字、または論理ドライブ文字を格納するタスク シーケンス変数の名前を指定します。  

-   **次に利用可能なパーティション** – このタスク シーケンスで、これまでオペレーティング システムの適用またはデータ イメージの適用アクションの対象になったことがない、次のパーティションを使用します。  

-   **特定のディスクとパーティション** – **ディスク**番号 (0 から開始) および**パーティション**番号 (1 から開始) を選択します。  

-   **特定の論理ドライブ文字** – Windows PE によりパーティションに割り当てられた**ドライブ文字**を指定します。 このドライブ文字は、新しく展開されたオペレーティング システムが割り当てるドライブ文字とは異なる場合があります。  

-   **変数に格納されている論理ドライブ文字** – Windows PE によりパーティションに割り当てられたドライブ文字を含むタスク シーケンス変数を指定します。 この変数は通常、[ **ディスクのフォーマットとパーティション作成** ] タスク シーケンス アクションにある [ **パーティションのプロパティ** ] ダイアログ ボックスの [詳細設定] セクションで設定されます。  

##  <a name="BKMK_ApplyWindowsSettings"></a> Windows 設定の適用  
 [ **Windows 設定の適用** ] タスク シーケンス ステップを使用すると、対象のコンピューターに対して Windows 設定を構成できます。 指定された値は適切な応答ファイル形式で保存され、[ **Windows と ConfigMgr のセットアップ** ] タスク シーケンス ステップの実行中に Windows セットアップによって使用されます。  

 このタスク シーケンス ステップは Windows PE でのみ実行されます。 このステップは標準のオペレーティング システムでは実行できません。 このアクションのタスク シーケンス変数の詳細については、「 [Apply Windows Settings Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_ApplyWindowsSettings)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されたアクションを説明する、ユーザー定義の短い名前  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **ユーザー名**  
 対象のコンピューターに関連付けられている登録済みのユーザー名を指定します。 この値は、[ **Windows 設定のキャプチャ** ] タスク シーケンス アクションでキャプチャされた値により上書きされます。  

 **組織名**  
 対象のコンピューターに関連付けられている登録済みの組織名を指定します。 この値は、[ **Windows 設定のキャプチャ** ] タスク シーケンス アクションでキャプチャされた値により上書きされます。  

 **プロダクト キー**  
 対象のコンピューターで Windows インストールに使用されるプロダクト キーを指定します。  

 **サーバー ライセンス**  
 サーバー ライセンス モードを指定します。 ライセンス モードとして [ **同時使用ユーザー数** ] か [ **接続ユーザー数** ] を選択します。 ライセンス モードとして [同時使用ユーザー数] を選択した場合、ライセンス契約ごとに許可される接続の最大数も指定する必要があります。 対象のコンピューターがサーバーではない場合や、ライセンス モードを指定しない場合は、[ **指定しない** ] を選択する必要があります。  

 **最大接続数**  
 ライセンス契約に規定されているこのコンピューターで有効な接続の最大数を指定します。  

 **ローカルの管理者パスワードをランダムに生成し、サポートされているすべてのプラットフォームのアカウントを無効にする (推奨)**  
 ローカルの管理者パスワードをランダムに生成するには、このオプションを選択します。 これは、ローカルの管理者パスワードを作成し、サポートされるプラットフォームでのアカウントを無効にします。  

 **アカウントを有効にし、ローカル管理者パスワードを指定する**  
 ローカル管理者のアカウントを有効にし、ローカル管理者のパスワードを作成するには、このオプションを選択します。 パスワードを [ **パスワード** ] 行に入力し、[ **パスワードの確認入力** ] 行にパスワードを確認入力します。  

 **タイム ゾーン**  
 対象のコンピューターに構成するタイム ゾーンを指定します。 この値は、[ **Windows 設定のキャプチャ** ] タスク シーケンス ステップでキャプチャされた値によって上書きされます。  

##  <a name="BKMK_AutoApplyDrivers"></a> ドライバーの自動適用  
 オペレーティング システムの展開の一部としてドライバーを適合およびインストールするには、[ **ドライバーの自動適用** ] タスク シーケンス ステップを使用します。  

 [ **ドライバーの自動適用** ] タスク シーケンス ステップでは次の手順を実行します。  

1.  ハードウェアをスキャンし、システム上に存在するすべてのデバイスのプラグ アンド プレイ ID を検索します。  

2.  デバイスとプラグ アンド プレイ ID の一覧を管理ポイントに送信します。 管理ポイントは、各デバイス用にドライバー カタログから互換ドライバーの一覧を返します。 管理ポイントはドライバーがどのドライバー パッケージに含まれるかにかかわらず、すべてのドライバーを検討します。 指定されたドライバー カテゴリのタグが付いたドライバーと、無効のマークが付いていないドライバーが検討されます。  

3.  クライアントは各デバイス用に、デバイスが展開されているオペレーティング システムに適していて、アクセス可能な配布ポイント上にある最適なドライバーを選びます。  

4.  選択されたドライバー (複数可) は配布ポイントからダウンロードされ、対象のオペレーティング システムに設定されます。  

    1.  イメージ ベースのインストールでは、ドライバーはオペレーティング システムのドライバー ストアに保存されます。  

    2.  セットアップ ベースのインストールでは、ドライバーを検出する場所を使用して Windows セットアップが構成されます。  

5.  [ **Windows と ConfigMgr のセットアップ** ] タスク シーケンス アクションを実行して、Windows を最初に起動したときに、このアクションで設定したドライバーが検出されます。  

> [!IMPORTANT]
>  スタンドアロン メディアでは、Windows セットアップが Configuration Manager サイトに接続していないため、[**ドライバーの自動適用**] タスク シーケンス ステップは使用できません。

このタスク シーケンス ステップは Windows PE でのみ実行されます。 このステップは標準のオペレーティング システムでは実行できません。 このアクションのタスク シーケンス変数の詳細については、「 [Auto Apply Drivers Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_AutoApplyDrivers)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **最適な互換ドライバーのみをインストールする**  
 タスク シーケンス ステップで、検出された各ハードウェア デバイスに最適なドライバーのみをインストールするように指定します。  

 **すべての互換ドライバーをインストールする**  
 タスク シーケンス ステップで、検出された各ハードウェア デバイスの互換ドライバーをすべてインストールし、Windows セットアップで最適なドライバーを選択するように指定します。 このオプションはダウンロードするドライバーの数が多くなるため、ネットワーク帯域幅とディスクの空き領域がさらに必要になりますが、結果としてより適切なドライバーを選択できます。  

 **すべてのカテゴリのドライバーを検討する**  
 タスク シーケンスのアクションで、利用可能なドライバー カテゴリすべての中から適切なデバイス ドライバーを検索するように指定します。  

 **ドライバーの一致条件を制限して、選択したカテゴリに属するドライバーだけを検討する**  
 タスク シーケンスのアクションで、特定のドライバー カテゴリにあるデバイス ドライバーの中から適切なデバイス ドライバーを検索するように指定します。  

 **署名されていないドライバーの無人インストールが許可されているバージョンの Windows でドライバーの無人インストールを行う**  
 このタスク シーケンスのアクションが、署名されていないデバイス ドライバーをインストールすることを許可します。  

> [!IMPORTANT]  
>  このオプションは、ドライバーの署名ポリシーを構成できないオペレーティング システムには適用されません。  

##  <a name="BKMK_CaptureNetworkSettings"></a> ネットワーク設定のキャプチャ  
 [ **ネットワーク設定のキャプチャ** ] タスク シーケンス ステップを使用して、タスク シーケンスを実行しているコンピューターから Microsoft ネットワーク設定をキャプチャします。 設定は、[ **ネットワーク設定の適用** ] タスク シーケンス ステップで構成する既定の設定を上書きする、タスク シーケンス変数に保存されます。  

 このタスク シーケンス ステップは、標準のオペレーティング システムでのみ実行できます。 Windows PE では実行できません。 このアクションのタスク シーケンス変数の詳細については、「 [Capture Network Settings Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_CaptureNetworkSettings)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前を指定します。  

 **説明**  
 このステップで実行されるアクションの詳細情報が表示されます。  

 **ドメインとワークグループのメンバーシップを移行する**  
 対象のコンピューターのドメインおよびワークグループ メンバーシップ情報をキャプチャします。  

 **ネットワーク アダプター構成を移行する**  
 対象のコンピューターのネットワーク アダプター構成をキャプチャします。 キャプチャされた情報には、グローバル ネットワーク設定、アダプター数、各アダプターに関連付けられているネットワーク設定が含まれます。 これらの設定には、DNS、WINS、IP、ポート フィルターに関連付けられている設定が含まれます。  

##  <a name="BKMK_CaptureOperatingSystemImage"></a> オペレーティング システム イメージのキャプチャ  
 参照コンピューターから 1 つ以上のイメージをキャプチャし、指定したネットワーク共有上にある WIM ファイルに保存するには、[ **オペレーティング システム イメージのキャプチャ** ] タスク シーケンス ステップを使用します。 次に、オペレーティング システム イメージの追加ウィザードを使用して、イメージベースのオペレーティング システムの展開に使用できるように、この .WIM ファイルを Configuration Manager にインポートします。  

 参照コンピューターの各ボリューム (ドライブ) は、.wim ファイル内に別イメージとしてキャプチャされます。 参照コンピューターに複数のボリュームがある場合、作成される WIM ファイルには、ボリュームごとに異なるイメージが含まれています。 NTFS または FAT32 としてフォーマットされているボリュームのみがキャプチャされます。 その他のフォーマットのボリュームおよび USB のボリュームはスキップされます。  

 参照コンピューターにインストールされているオペレーティング システムは、Configuration Manager がサポートするバージョンの Windows である必要があり、SysPrep ツールを使用して準備する必要があります。 インストールされたオペレーティング システムのボリュームとブート ボリュームは同じである必要があります。  

 また、選択したネットワーク共有への書き込みアクセスが許可された Windows アカウントを入力する必要があります。  

 このタスク シーケンス ステップは Windows PE でのみ実行されます。 このステップは標準のオペレーティング システムでは実行できません。 このアクションのタスク シーケンス変数の詳細については、「 [Capture Operating System Image Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_CaptureOperatingSystemImage)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **ターゲット**  
 キャプチャしたオペレーティング システム イメージの保存時に Configuration Manager が使用する場所へのファイル システムのパス名。  

 **説明**  
 .WIM ファイルに保存されるキャプチャ済みオペレーティング システム イメージについて、ユーザーが任意に定義した説明。  

 **バージョン**  
 キャプチャしたオペレーティング システム イメージに割り当てる、ユーザーが任意に定義したバージョン番号。 この値は、文字および数値の任意の組み合わせにすることができ、.WIM ファイルに保存されます。  

 **作成者**  
 オペレーティング システム イメージを作成したユーザーのオプションの名前であり、WIM ファイルに保存されます。  

 **オペレーティング システム イメージのキャプチャ アカウント**  
 指定したネットワーク共有へのアクセス許可がある Windows アカウントを入力する必要があります。 その Windows アカウントの名前を指定するには、[ **設定** ] をクリックします。  

##  <a name="BKMK_CaptureUserState"></a> ユーザー状態のキャプチャ  
 ユーザー状態移行ツール (USMT) を使用して、タスク シーケンスを実行しているコンピューターからユーザーの状態と設定をキャプチャするには、[ **ユーザー状態のキャプチャ** ] タスク シーケンス ステップを使用します。 このタスク シーケンス ステップは、[ **ユーザー状態の復元** ] タスク シーケンス ステップと共に使用します。 USMT 3.0.1 以降では、このオプションにより Configuration Manager が生成および管理する暗号化キーを使った USMT 状態ストアの暗号化が必ず行われます。  

 オペレーティング システムを展開するときに、ユーザー状態の移行を管理する方法の詳細については、「[Manage user state](../get-started/manage-user-state.md)」 (ユーザー状態の管理) を参照してください。  

 Configuration Manager サイトの状態移行ポイントに状態設定を保存したり、状態移行ポイントから設定を復元したりする場合は、[**ユーザー状態のキャプチャ**] タスク シーケンス ステップを、[**状態ストアの要求**] タスク シーケンス ステップおよび [**状態ストアのリリース**] タスク シーケンス ステップと共に使用できます。  

 [ **ユーザー状態のキャプチャ** ] タスク シーケンス ステップにより、最も一般的に使用されているオプションの限定されたサブセットが制御できます。 その他のコマンド ライン オプションは、OSDMigrateAdditionalCaptureOptions タスク シーケンス 変数を使用して指定できます。  

 このタスク シーケンス ステップは Windows PE でのみ実行されます。 このステップは標準のオペレーティング システムでは実行できません。 このアクションのタスク シーケンス変数の詳細については、「 [Capture User State Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_CaptureUserState)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **ユーザー状態移行ツール パッケージ**  
 このタスク シーケンス ステップでユーザー状態と設定をキャプチャするときに使用する USMT のバージョンを含む Configuration Manager パッケージを入力します。 このパッケージにはプログラムは必要ありません。 タスク シーケンス ステップが実行されると、タスク シーケンスは、指定したパッケージの中からそのバージョンの USMT を使用します。 状態をキャプチャするオペレーティング システムのアーキテクチャに応じて、32 ビット バージョンまたは 64 ビット バージョンの USMT を含むパッケージを指定します。  

 **すべてのユーザー プロファイルを標準オプションでキャプチャする**  
 すべてのユーザー プロファイル情報を移行するには、このオプションを選択します。 既定では、このオプションはオンです。  

 このオプションを選択して、[ユーザー状態の復元] タスク シーケンス ステップでローカル コンピューターのユーザー プロファイルを復元するオプションを選択しない場合、Configuration Manager では新しいアカウントにパスワードを割り当てないと移行できないため、タスク シーケンスは失敗します。 また、 **タスク シーケンスの新規作成** ウィザードを使用して、[ **既存のイメージ パッケージをインストールする**] タスク シーケンスを作成した場合、作成したタスク シーケンスは既定で [すべてのユーザー プロファイルを標準オプションでキャプチャする] になりますが、[ローカル コンピューターのユーザー プロファイルを復元する] オプションは選択されません。  

 [ **ローカル コンピューターのユーザー プロファイルを復元する** ] を選択し、移行するアカウントのパスワードを指定します。 手動で作成したタスク シーケンスでは、この設定は [ユーザー状態の復元] タスク シーケンス ステップにあります。 **タスク シーケンスの新規作成** ウィザードで作成したタスク シーケンスでは、この設定は、[ **ユーザー ファイルと設定の復元** ] ステップのウィザードのページにあります。  

 ローカル ユーザー アカウントがない場合、この設定は適用されません。  

 **ユーザー プロファイルのキャプチャ方法をカスタマイズする**  
 カスタム プロファイル ファイルの移行を指定するには、このオプションを選択します。 [ **ファイル** ] をクリックして、このステップで使用する USMT の構成ファイルを選択します。 移行するユーザー状態ファイルを定義する規則を含むカスタムの .xml ファイルを指定する必要があります。  

 **構成ファイルを選択するには、ここをクリックします。**  
 ユーザー プロファイルをキャプチャするために使用する、USMT パッケージ内の構成ファイルを選択するには、このオプションを選択します。 [ **ファイル** ] クリックして、[ **構成ファイル** ] ダイアログ ボックスを表示します。 構成ファイルを指定するには、[ **ファイル名** ] 行にファイルの名前を入力し、[ **追加** ] をクリックします。  

 **詳細ログ記録を有効にする**  
 詳細なログ ファイル情報を生成するには、このオプションを有効にします。 状態をキャプチャすると、ログ Scanstate.log が生成され、既定では \windows\system32\ccm\logs フォルダー内にあるタスク シーケンス ログ フォルダーに保存されます。  

 **暗号化されたファイル システム (EFS) を使用するファイルをスキップする**  
 プロファイル ファイルなど、暗号化されたファイル システム (EFS) を使用して暗号化されたファイルのキャプチャをスキップするには、このオプションを有効にします。 オペレーティング システムや USMT バージョンによっては、暗号化されたファイルを復元しても読み取れない場合があります。 詳細については、USMT のドキュメントを参照してください。  

 **ファイル システム アクセスを使用してコピーする**  
 次の設定のいずれかを指定する場合にこのオプションを有効にします。  

-   **キャプチャできないファイルがあっても続行する**: 一部のファイルをキャプチャできない場合でも移行処理を続行するには、この設定を有効にします。 このオプションを無効にした場合、ファイルをキャプチャできないと、タスク シーケンス ステップは失敗します。 既定では、このオプションは有効になっています。  

-   **ファイルをコピーする代わりに、リンクを使用してローカルでキャプチャする**: NTFS ハードリンクを使用してファイルをキャプチャするには、この設定を有効にします。  

     ハードリンクを使用したデータ移行の詳細については、「 [ハードリンク移行ストア](http://go.microsoft.com/fwlink/p/?LinkId=240222)」を参照してください。  

-   **オフライン モードでキャプチャする (Windows PE のみ)**: 完全なオペレーティング システムではなく、Windows PE でユーザー状態をキャプチャするには、この設定を有効にします。  

 **ボリューム シャドウ コピー サービス (VSS) を使用してキャプチャする**  
 このオプションを指定すると、ファイルが他のアプリケーションによる編集のためにロックされている場合でもそのファイルをキャプチャできます。  

##  <a name="BKMK_CaptureWindowsSettings"></a> Windows 設定のキャプチャ  
 [ **Windows 設定のキャプチャ** ] タスク シーケンス ステップを使用して、タスク シーケンスを実行しているコンピューターから Windows 設定をキャプチャします。 設定は、[ **Windows 設定の適用** ] タスク シーケンス ステップで構成する既定の設定を上書きする、タスク シーケンス変数に保存されます。  

 このタスク シーケンスのステップは Windows PE または標準のオペレーティング システムで実行されます。 このアクションのタスク シーケンス変数の詳細については、「 [Capture Windows Settings Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_CaptureWindowsSettings)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **コンピューター名を移行する**  
 コンピューターの NetBIOS コンピューター名をキャプチャするには、このオプションを選択します。  

 **登録されているユーザーと組織名を移行する**  
 コンピューターから登録されているユーザーおよび組織名をキャプチャするには、このオプションを選択します。  

 **タイム ゾーンを移行する**  
 コンピューターのタイム ゾーン設定をキャプチャするには、このオプションを選択します。  

##  <a name="BKMK_CheckReadiness"></a> 準備の確認  
 [ **準備の確認** ] タスク シーケンス ステップを使用して、指定した展開の前提条件を対象のコンピューターが満たしていることを確認します。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。 このステップでは、この設定を選択しないでください。選択した場合、準備の確認のみが記録され、確認が失敗してもタスク シーケンスは停止しません。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **最小メモリ容量 (MB) を確認する**  
 対象のコンピューターに搭載されているメモリの量 (メガバイト単位) が、指定された量以上であることを確認するには、この設定を選択します。 既定では、この設定が選択されています。  

 **最低プロセッサ速度 (MHz) を確認する**  
 対象のコンピューターに搭載されたプロセッサの速度 (MHz) が、指定された速度以上であることを確認するには、この設定を選択します。 既定では、この設定が選択されています。  

 **最小空きディスク容量 (MB) を確認する**  
 対象のコンピューター上の空きディスク容量 (メガバイト単位) が、指定された量以上であることを確認するには、この設定を選択します。  

 **現在の OS の更新を確認する**  
 対象のコンピューターにインストールされているオペレーティング システムが、指定された要件を満たしていることを確認するには、この設定を選択します。 既定では、この設定が選択され、 **CLIENT**という値が設定されています。  

##  <a name="BKMK_ConnectToNetworkFolder"></a> ネットワーク フォルダーへの接続  
 共有ネットワーク フォルダーへの接続を作成するには、[ **ネットワーク フォルダーへの接続** ] タスク シーケンス ステップを使用します。  

 このタスク シーケンス ステップは標準のオペレーティング システムまたは Windows PE で実行できます。 このアクションのタスク シーケンス変数の詳細については、「 [Connect to Network Folder Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_ConnecttoNetworkFolder)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

##  <a name="BKMK_ConvertDisktoDynamic"></a> ディスクをダイナミックに変換  
 [ **ダイナミック ディスクに変換** ] タスク シーケンス ステップを使用して、ベーシック ディスク タイプからダイナミック ディスク タイプに物理ディスクを変換します。  

 このステップは標準のオペレーティング システムまたは Windows PE で実行できます。 このアクションのタスク シーケンス変数の詳細については、「 [Convert Disk to Dynamic Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_ConvertDisk)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **ディスク番号**  
 変換するディスクの物理ディスク番号。  

##  <a name="BKMK_DisableBitLocker"></a> BitLocker の無効化  
 現在のオペレーティング システム ドライブ、または特定のドライブの BitLocker 暗号化を無効にするには、[ **BitLocker の無効化** ] タスク シーケンス ステップを使用します。 この操作では、キー プロテクターがハード ドライブ上にクリア テキストで表示されますが、ドライブの内容は解読されません。 結果として、このアクションはほぼ瞬時に完了します。  

> [!NOTE]  
>  BitLocker ドライブ暗号化とは、ディスク ボリュームの内容を低レベルで暗号化する処理のことです。  

 複数のドライブを暗号化している場合は、オペレーティング システム ドライブで BitLocker を無効にする前に、すべてのデータ ドライブで BitLocker を無効にする必要があります。  

 このステップは標準のオペレーティング システムでのみ実行できます。 Windows PE では実行できません。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前を指定します。  

 **説明**  
 このステップで実行されるアクションの詳細情報が表示されます。  

 **現在のオペレーティング システム ドライブ**  
 現在のオペレーティング システム ドライブで BitLocker を無効にします。  

 **特定のドライブ**  
 特定のドライブで BitLocker を無効にします。 ドロップダウン リストを使用して、BitLocker を無効にするドライブを指定します。  

##  <a name="BKMK_DownloadPackageContent"></a> パッケージ コンテンツのダウンロード  
 **[パッケージ コンテンツのダウンロード]** タスク シーケンスのステップを使用して、次のパッケージの種類のいずれかをダウンロードします。  

-   オペレーティング システム イメージ  

-   オペレーティング システムのアップグレード パッケージ  

-   ドライバー パッケージ  

-   パッケージ  

 このステップは、次のシナリオでオペレーティング システムをアップグレードするためのタスク シーケンスに適しています。  

-   x86 と x64 の両方のプラットフォームで動作する 1 つのアップグレード タスク シーケンスを使用する。 これを行うには、クライアント アーキテクチャを検出して、該当するオペレーティング システム アップグレード パッケージのみをダウンロードする条件を含む **[アップグレードの準備]** グループに、2 つの **[パッケージ コンテンツのダウンロード]** ステップを追加します。 同じ変数を使用するようにそれぞれの **[パッケージ コンテンツのダウンロード]** ステップを構成して、 **[オペレーティング システムのアップグレード]** ステップ上のメディア パスにその変数を使用します。  

-   該当するドライバー パッケージを動的にダウンロードするには、ドライバー パッケージごとに適切なハードウェアの種類を検出する条件を含む 2 つの **[パッケージ コンテンツのダウンロード]** ステップを使用します。 同じ変数を使用するようにそれぞれの **[パッケージ コンテンツのダウンロード]** ステップを構成し、 **[オペレーティング システムのアップグレード]** ステップのドライバー セクションの **[ステージング済みコンテンツ]** 値に変数を使用します。  

> [!NOTE]    
> パッケージ コンテンツのダウンロード ステップを含むタスク シーケンスを展開する場合、ソフトウェアの展開ウィザードの [**配布ポイント**] ページで、[**展開オプション**] に [**タスク シーケンスを開始する前にすべてのコンテンツをローカルにダウンロードする**] を選択しないでください。  

このステップは標準のオペレーティング システムまたは Windows PE で実行できます。 ただし、Configuration Manager クライアント キャッシュにパッケージを保存するオプションは、WinPE ではサポートされません。

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前を指定します。  

 **説明**  
 このステップで実行されるアクションの詳細情報が表示されます。  

 **[パッケージの選択]** アイコン  
 アイコンをクリックして、ダウンロードするパッケージを選択します。 パッケージを選択した後、もう一度アイコンをクリックすると、別のパッケージを選択できます。  

 **次の場所に保存する**  
 次のいずれかの場所にパッケージを保存する場合に選択します。  

 -   **タスク シーケンス作業ディレクトリ**  

 -   **Configuration Manager クライアント キャッシュ**: このオプションを使用して、クライアント キャッシュにコンテンツを保存します。 これにより、クライアントは、他のピア キャッシュ クライアントのピア キャッシュ ソースとして機能できます。 詳細については、「[WAN トラフィックを削減するための Windows PE ピア キャッシュの準備](../get-started/prepare-windows-pe-peer-cache-to-reduce-wan-traffic.md)」を参照してください。  

 -   **カスタム パス**  

 **パスを変数として保存する**  
 パスは、別のタスク シーケンスのステップで使用できる変数として保存できます。 Configuration Manager によって、数字のサフィックスが変数名に追加されます。 たとえば、%*mycontent*% という変数をカスタム変数として指定した場合に、この変数名は、参照コンテンツがすべて格納されているルートになります (複数のパッケージを指定できます)。 変数を参照する場合は、数字のサフィックスを変数に追加します。 たとえば、最初のパッケージの場合、%*mycontent01*% 変数を参照します。 オペレーティング システムのアップグレードなどの、サブシーケンス ステップの変数を参照する場合は、%*mycontent02*% または %*mycontent03*% を使用します。この数値は、ステップでのパッケージのリスト順に対応します。  

 **パッケージのダウンロードに失敗した場合に、リストにある他のパッケージのダウンロードを続行する**  
 パッケージのダウンロードに失敗した場合に、リスト内の次のパッケージに進み、ダウンロードを開始するように指定します。  

##  <a name="BKMK_EnableBitLocker"></a> BitLocker の有効化  
 ハードドライブの少なくとも 2 つのパーティション上の BitLocker 暗号化を無効にするには、[ **BitLocker の有効化** ] を使用します。 片方のアクティブなパーティションには Windows のブートストラップ コードを格納します。 もう片方のパーティションにはオペレーティング システムを格納します。 ブートストラップのパーティションは暗号化されていない必要があります。  

 Windows PE のドライブで BitLocker を有効にするには、[ **BitLocker の事前プロビジョニング** ] タスク シーケンス ステップを使用します。 詳細については、このトピックの「 [BitLocker の事前プロビジョニング](#BKMK_PreProvisionBitLocker) 」セクションを参照してください。  

> [!NOTE]  
>  BitLocker ドライブ暗号化とは、ディスク ボリュームの内容を低レベルで暗号化する処理のことです。  

 [ **BitLocker の有効化** ] ステップは標準のオペレーティング システムでのみ実行できます。 Windows PE では実行できません。 このアクションのタスク シーケンス変数の詳細については、「 [Enable BitLocker Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_EnableBitLocker)」を参照してください。  

 [ **TPM のみ**]、[ **TPM と、USB 上のスタートアップ キー** ]、または [ **TPM および PIN**] を指定する場合、[ **BitLocker の有効化** ] ステップを実行するには、トラステッド プラットフォーム モジュール (TPM) は次の状態にする必要があります。  

-   Enabled  

-   アクティブ  

-   所有権を許可  

 残りのステップでは物理的な操作や再起動が不要なため、タスク シーケンス ステップは、残りの TPM 初期化を完了できます。 (必要に応じて) [ **BitLocker の有効化** ] により透過的に完了できる残りの TPM 初期化ステップには次が含まれます。  

-   承認キー ペアの作成  

-   所有権の承認値の作成、およびこの値をサポートするために拡張されている Active Directory への仲介  

-   所有権の取得  

-   ストレージ ルート キーの作成、または既に存在しているが互換性がない場合は、リセット  

 ドライブの暗号化処理が完了してからタスク シーケンスの次のステップを続行するように [ **BitLocker の有効化** ] ステップを設定するには、[ **待機時間** ] チェック ボックスをオンにします。 [ **待機時間** ] チェック ボックスをオンにしないと、バックグラウンドでドライブの暗号化処理が実行され、タスク シーケンスの実行ではすぐに次のステップに進みます。  

 BitLocker を使用して、コンピューター システムの複数のドライブ (オペレーティング システムとデータ ドライブの両方) を暗号化することができます。 データ ドライブのキー プロテクターは、オペレーティング システム ドライブに格納されているため、データ ドライブを暗号化するには、オペレーティング システムが既に暗号化されており、暗号化処理が完了している必要があります。 このため、同じ処理でオペレーティング システム ドライブとデータ ドライブを暗号化すると、オペレーティング システム ドライブに対して BitLocker を有効化するステップで [待機] オプションを選択する必要があります。  

 ハード ドライブが既に暗号化されており、BitLocker が無効にされている場合、BitLocker の有効化により 1 つ以上のキー プロテクターが再度有効にされ、ほぼ瞬時に完了されます。 この場合、ハード ドライブの再暗号化は不要です。  

 このアクションのタスク シーケンス変数の詳細については、「 [Enable BitLocker Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_EnableBitLocker)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 タスク シーケンス ステップの内容を示す名前を指定します。  

 **説明**  
 このタスク シーケンス ステップの説明を必要に応じて入力できます。  

 **暗号化するドライブの指定**  
 暗号化するドライブを指定します。 現在のオペレーティング システム ドライブを暗号化するには、[ **現在のオペレーティング システム ドライブ** ] を選択し、次のキー管理オプションのいずれかを構成します。  

-   **TPM のみ**: トラステッド プラットフォーム モジュール (TPM) のみを使用する場合に選択します。  

-   **USB 上のスタートアップ キーのみ**: USB フラッシュ ドライブに格納されているスタートアップ キーを使用する場合に選択します。 このオプションを選択すると BitLocker は、BitLocker スタートアップ キーが含まれている USB デバイスがコンピューターに接続されるまで、通常のブート プロセスをロックします。  

-   **TPM と、USB 上のスタートアップ キー**: TPM と、USB フラッシュ ドライブに格納されているスタートアップ キーを使用する場合に選択します。 このオプションを選択すると BitLocker は、BitLocker スタートアップ キーが含まれている USB デバイスがコンピューターに接続されるまで、通常のブート プロセスをロックします。  

-   **TPM および PIN**: TPM と個人識別番号 (PIN) を使用する場合に選択します。 このオプションを選択すると BitLocker は、ユーザーが PIN を入力するまで、通常のブート プロセスをロックします。  

 オペレーティング システム以外の特定のデータ ドライブを暗号化するには、[ **特定のドライブ**] を選択し、一覧からドライブを選択します。  

 **リカバリ キーの作成先の指定**  
 リカバリ パスワードの作成先を指定するには、[ **Active Directory** ] を選択します。これにより、Active Directory にリカバリ パスワードが仲介されます。 このオプションを選択した場合は、関連する BitLocker の回復情報が保存されるように、サイトの Active Directory を拡張する必要があります。 [ **リカバリ キーを作成しない**] を選択して、パスワードを一切作成しないこともできます。 しかし、ベスト プラクティスとしてパスワードの作成をお勧めします。  

 **BitLocker がすべてのドライブの暗号化処理を完了してから、タスク シーケンスを実行する**  
 このオプションを選択すると、BitLocker のドライブ暗号化が完了してから、タスク シーケンスの次のステップが実行されます。 このオプションを選択した場合は、まず全体のディスク ボリュームが暗号化されなければ、ユーザーがコンピューターにログインできません。  

 大容量のハード ドライブを暗号化する場合、暗号化処理の完了には数時間かかる場合があります。 このオプションを選択しないと、タスク シーケンスは直ちに続行されます。  

##  <a name="BKMK_FormatandPartitionDisk"></a> ディスクのフォーマットとパーティション作成  
 [ **ディスクのフォーマットとパーティション作成** ] タスク シーケンス ステップを使用して、対象となっているコンピューター上に指定したディスクのフォーマットとパーティション作成を行います。  

> [!IMPORTANT]  
>  このタスク シーケンスのステップで指定するすべての設定は、1 つの指定されたディスクにだけ適用されます。 同じコンピューターの別のディスクにもフォーマットとパーティション作成を行う場合には、[ **ディスクのフォーマットとパーティション作成** ] タスク シーケンス ステップをタスク シーケンスに追加する必要があります。  

 このタスク シーケンス ステップは Windows PE でのみ実行されます。 このステップは標準のオペレーティング システムでは実行できません。 このアクションのタスク シーケンス変数の詳細については、「 [Format and Partition Disk Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_FormatPartitionDisk)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **ディスク番号**  
 フォーマットするディスクの物理ディスク番号。 この番号は、Windows のディスク列挙の順番に基づいています。  

 **ディスクの種類**  
 フォーマットされるディスクの種類。 ドロップダウン リストには次の 2 つのオプションがあります。  

-   標準 (MBR) – マスター ブート レコード  

-   GPT – GUID パーティション テーブル  

> [!NOTE]  
>  ディスクの種類を [ **標準 (MBR)** ] から [ **GPT**] に変更し、パーティション レイアウトの中に拡張パーティションが存在している場合、すべての拡張パーティションと論理パーティションがレイアウトから削除されます。 ディスクの種類が変更される前に、この操作を実行するかどうかを確認するメッセージが表示されます。  

 **ボリューム**  
 作成するパーティションまたはボリュームに関する詳細な情報。次の情報が含まれます。  

-   名前  

-   ディスクの空き容量  

 新しいパーティションを作成するには、[ **新規** ] ボタンをクリックして、[ **パーティションのプロパティ** ] ダイアログ ボックスを開きます。 パーティションの種類とサイズ、およびパーティションがブート パーティションかどうかを指定することができます。 既存のパーティションを変更するには、変更するパーティションをクリックしてから、プロパティ ボタンをクリックします。 ハード ドライブのパーティションを構成する方法の詳細については、次のいずれかを参照してください。  

-   [UEFI GPT ベースのハード ドライブのパーティションを構成する方法](http://go.microsoft.com/fwlink/?LinkID=272104)  

-   [BIOS MBR ベースのハード ドライブのパーティションを構成する方法](http://go.microsoft.com/fwlink/?LinkId=272105)  

 パーティションを削除するには、削除するパーティションを選択してから、[ **削除**] をクリックします。  

##  <a name="BKMK_InstallApplication"></a> アプリケーションのインストール  
 タスク シーケンスの一環としてアプリケーションをインストールするには、[ **アプリケーションのインストール** ] タスク シーケンス ステップを使用します。 このステップでは、タスク シーケンス ステップで指定された一連のアプリケーション、またはタスク シーケンス変数のダイナミック リストにより指定された一連のアプリケーションをインストールできます。 このステップが実行されると、アプリケーションのインストールはポリシーのポーリング間隔を待たずにすぐ開始されます。  

 インストールされるアプリケーションは、次の条件を満たしている必要があります。  

-   アプリケーションの展開の種類は、Windows インストーラーかスクリプト インストーラーでなければなりません。 Windows アプリ パッケージ (.appx ファイル) の展開の種類はサポートされていません。  

-   ユーザー アカウントではなく、ローカル システム アカウントで実行する必要があります。  

-   デスクトップと通信してはいけません。 プログラムは、サイレントまたは無人モードで実行する必要があります。  

-   自動的に再起動を開始させてはいけません。 アプリケーションは、標準再起動コードの 3010 終了コードを使用して再起動を要求する必要があります。 これにより、確実にタスク シーケンス ステップで再起動が正しく処理されるようになります。 アプリケーションが 3010 終了コードを返さない場合は、基本となるタスク シーケンス エンジンが再起動を実行します。 再起動後にタスク シーケンスは自動的に続行されます。  

 [ **アプリケーションのインストール** ] ステップが実行されると、アプリケーションは、アプリケーションの展開の種類について、要件となる規則と探知方法が適用可能かを確認します。 この確認の結果によって、アプリケーションは適用される展開の種類をインストールします。 展開の種類が依存関係を含んでいる場合は、アプリケーションのインストール ステップの一環として依存する展開の種類が評価され、インストールされます。 スタンドアロン メディアでは、アプリケーションの依存関係はサポートされていません。  

> [!NOTE]  
>  別のアプリケーションを置き換えるアプリケーションをインストールするには、置換対象のアプリケーションのコンテンツ ファイルが使用可能である必要があります。使用できない場合、タスク シーケンス ステップは失敗します。 たとえば、Microsoft Visio 2010 は、クライアント、または、キャプチャされたイメージ内にインストールされます。 [アプリケーションのインストール] タスク シーケンス ステップを実行して Microsoft Visio 2013 をインストールする場合、Microsoft Visio 2010 (置換対象のアプリケーション) のコンテンツ ファイルを配布ポイントで利用可能にする必要があります。利用できない場合、タスク シーケンスは失敗します。 クライアント、またはキャプチャしたイメージに Microsoft Visio がインストールされていない場合、Microsoft Visio 2010 のコンテンツ ファイルはチェックされずに、Microsoft Visio 2013 のインストールを完了します。  

> [!NOTE]
> SMSTSMPListRequestTimeoutEnabled および SMSTSMPListRequestTimeout 組み込み変数を使用して、タスク シーケンスでロケーション サービスから管理ポイント一覧を取得できなかった場合に、アプリケーションまたはソフトウェア更新プログラムのインストールを再試行するまでの待ち時間をミリ秒単位で有効にするか、指定できます。 組み込みのタスク シーケンス変数の詳細については、「[タスク シーケンス組み込み変数](task-sequence-built-in-variables.md)」を参照してください。

 このタスク シーケンス ステップは、標準のオペレーティング システムでのみ実行できます。 Windows PE では実行できません。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明されている設定を構成することができます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   指定すると、コンピューターが予期せず再起動した場合、このステップを再試行します。 再起動後に再試行する回数を指定することもできます。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **次のアプリケーションをインストールする**  
 この設定は指定されている順序でインストールするアプリケーションを指定します。  

 Configuration Manager では、無効なアプリケーションまたは次のように設定されたアプリケーションは除外されます。 これらのアプリケーションは、[ **インストールするアプリケーションの選択** ] ダイアログ ボックスには表示されません。  

-   ユーザーがログオンしているときのみ  

-   ユーザーの権限で実行する  

 **動的な変数一覧に従ってアプリケーションをインストールする**  
 この設定は、コレクションまたはコンピューター用に定義された一連のタスク シーケンス変数のベース名を指定します。 これらの変数はそのコレクションまたはコンピューター用にインストールされるアプリケーションを指定します。 各変数名は、共通のベース名と「01」で始まる数字のサフィックスで構成されます。 各変数の値にはアプリケーションの名前以外は何も含んではいけません。  

 動的な変数一覧を使用してインストールされるアプリケーションでは、アプリケーションの[**プロパティ**] ダイアログ ボックスの [**全般**] タブで [**このアプリケーションを展開せずに [アプリケーションのインストール] タスク シーケンスでインストールできるようにする**] を有効にする必要があります。  

> [!NOTE]  
>  スタンドアロン メディアによる展開では動的な変数一覧を使用してアプリケーションをインストールすることはできません。  

 たとえば、AA01 というタスク シーケンス変数を使用して 1 つのアプリケーションをインストールするには、次の変数を指定します。  

|変数名|変数値|  
|-------------------|--------------------|  
|AA01|Microsoft Office|  

 2 つのアプリケーションをインストールするには、次の変数を指定します。  

|変数名|変数値|  
|-------------------|--------------------|  
|AA01|Microsoft Lync|  
|AA02|Microsoft Office|  

 インストールには次の条件が影響します。  

-   変数の値にアプリケーションの名前以外が含まれている場合。 そのアプリケーションはインストールされず、タスク シーケンスは続行されます。  

-   指定された基本名とサフィックス "01" を持つ変数がない場合、アプリケーションはインストールされません。 タスク シーケンス ステップの [オプション] タブで [**エラー時に続行する**] を選択すると、アプリケーションのインストールができなくても、タスク シーケンスが続行されます。 この設定が選択されていない場合、タスク シーケンスは失敗し、残りのアプリケーションはインストールされません。  

 **アプリケーションのインストールに失敗した場合は、一覧にあるその他のアプリケーションのインストールを続行します。**  
 この設定は個々のアプリケーションのインストールが失敗してもステップを続行することを指定します。 この設定が指定されると、インストールのエラーが発生したとしても、タスク シーケンスは続行されます。 これが指定されておらず、インストールが失敗すると、タスク シーケンス ステップは即座に終了します。  

##  <a name="BKMK_InstallDeploymentTools"></a> 展開ツールのインストール  
 Sysprep 展開ツールを含む Configuration Manager パッケージをインストールするには、[**展開ツールのインストール**] タスク シーケンス ステップを使用します。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **Sysprep パッケージ**  
 この設定は次のオペレーティング システム用の Sysprep 展開を含む Configuration Manager パッケージを指定します。  

-   Windows XP SP3  

-   Windows XP X64 SP2  

-   Windows Server 2003 SP2  

##  <a name="BKMK_InstallPackage"></a> パッケージのインストール

 タスク シーケンスの一環としてソフトウェアをインストールするには、[ **パッケージアプリケーションのインストール** ] タスク シーケンス ステップを使用します。 このステップが実行されると、インストールはポリシーのポーリング間隔を待たずにすぐ開始されます。  

 インストールされるソフトウェアは、次の条件を満たしている必要があります。  

-   ユーザー アカウントではなく、ローカル システム アカウントで実行する必要があります。  

-   デスクトップと通信してはいけません。 プログラムは、サイレントまたは無人モードで実行する必要があります。  

-   自動的に再起動を開始させてはいけません。 ソフトウェアは、標準再起動コードの 3010 終了コードを使用して再起動を要求する必要があります。 これにより、確実にタスク シーケンス ステップで再起動が正しく処理されるようになります。 ソフトウェアが 3010 終了コードを返さない場合は、基本となるタスク シーケンス エンジンが再起動を実行します。 再起動後にタスク シーケンスが自動的に続行されます。  

 依存プログラムのインストールに [ **別のプログラムを最初に実行する** ] オプションを使用するプログラムは、オペレーティング システムの展開ではサポートされていません。 ソフトウェアで [ **別のプログラムを最初に実行する** ] が有効で、依存プログラムが既に対象のコンピューターで実行されている場合は、依存するプログラムは実行され、タスク シーケンスは続行されます。 ただし、依存プログラムが対象のコンピューターでまだ実行されていないと、タスク シーケンスは失敗します。  

> [!NOTE]  
>  中央管理サイトには、タスク シーケンスの実行中に、ソフトウェアの配布エージェントを有効にするために必要なクライアント構成ポリシーがありません。 中央管理サイトのタスク シーケンス用にスタンドアロン メディアを作成し、タスク シーケンスに [ **パッケージのインストール** ] ステップが含まれる場合、CreateTsMedia.log ファイルに次のエラーが表示される場合があります。  
>   
>  `"WMI method SMS_TaskSequencePackage.GetClientConfigPolicies failed (0x80041001)"`  
>   
>  [パッケージのインストール] ステップを含むスタンドアロン メディアの場合、ソフトウェアの配布エージェントが有効なプライマリ サイトにスタンドアロン メディアを作成するか、[ **Windows と ConfigMgr のセットアップ** ] ステップの後、[ **パッケージのインストール** ] ステップの前に [ **コマンド ラインの実行** ] ステップを追加する必要があります。 [ **コマンド ラインの実行** ] ステップでは、最初の [パッケージのインストール] ステップを実行する前に、ソフトウェアの配布エージェントを有効にする WMIC コマンドを実行します。 [ **コマンド ラインの実行** ] タスク シーケンス ステップでは、次のコマンド ラインを使用できます。  
>   
>  **コマンド ライン**: **WMIC /namespace:\\\root\ccm\policy\machine\requestedconfig path ccm_SoftwareDistributionClientConfig CREATE ComponentName="Enable SWDist", Enabled="true", LockSettings="TRUE", PolicySource="local", PolicyVersion="1.0", SiteSettingsKey="1" /NOINTERACTIVE**  
>   
>  スタンドアロン メディアの作成の詳細については、「[スタンドアロン メディアの作成](../deploy-use/create-stand-alone-media.md)」を参照してください。  

 このタスク シーケンス ステップは、標準のオペレーティング システムでのみ実行できます。 Windows PE では実行できません。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **ソフトウェア パッケージを 1 つだけインストールする**  
 この設定では、Configuration Manager ソフトウェア パッケージを指定します。 ステップはインストールが完了するまでは開始されません。  

 **動的な変数一覧に従ってソフトウェア パッケージをインストールする**  
 この設定は、コレクションまたはコンピューター用に定義された一連のタスク シーケンス変数のベース名を指定します。 これらの変数はそのコレクションまたはコンピューター用にインストールされるパッケージを指定します。 各変数名は、共通のベース名と「001」で始まる数字のサフィックスで構成されます。 各変数の値にはパッケージ ID およびソフトウェアの名前をコロンで区切って含んでいる必要があります。  

 動的な変数一覧を使用してインストールされるソフトウェアでは、パッケージの [**プロパティ**] ダイアログ ボックスの [**詳細設定**] タブで [**このソフトウェアを展開しないで、ソフトウェアのインストール タスク シーケンスからこのプログラムをインストールする**] を有効にする必要があります。  

> [!NOTE]  
>  スタンドアロン メディアによる展開では動的な変数一覧を使用してソフトウェア パッケージをインストールすることはできません。  

 たとえば、AA001 というタスク シーケンス変数を使用して 1 つのソフトウェア パッケージをインストールするには、次の変数を指定します。  

|変数名|変数値|  
|-------------------|--------------------|  
|AA001|CEN00054:Install|  

 3 つのソフトウェア パッケージをインストールするには、次の変数を指定します。  

|変数名|変数値|  
|-------------------|--------------------|  
|AA001|CEN00054:Install|  
|AA002|Package CEN00107:Install Silent|  
|AA003|CEN00031:Install|  

 インストールには次の条件が影響します。  

-   変数の値が正しい形式で作成されていない場合や、有効なアプリケーション ID と名前が指定されていない場合は、ソフトウェアのインストールは失敗します。  

-   パッケージ ID に小文字が含まれていると、そのソフトウェアのインストールは失敗します。  

-   指定された基本名とサフィックス "001" を持つ変数がない場合は、パッケージはインストールされず、タスク シーケンスは続行されます。  

 **ソフトウェア パッケージのインストールに失敗した場合に、一覧にある他のパッケージのインストールを続行する**  
 この設定は個々のソフトウェア パッケージのインストールが失敗してもステップを続行することを指定します。 この設定が指定されると、インストールのエラーが発生したとしても、タスク シーケンスは続行されます。 これが指定されておらず、インストールが失敗すると、タスク シーケンス ステップは即座に終了します。  

##  <a name="BKMK_InstallSoftwareUpdates"></a> ソフトウェア更新プログラムのインストール  
 ソフトウェア更新プログラムを対象コンピューターにインストールするには、[ **ソフトウェア更新プログラムのインストール** ] タスク シーケンスのステップを使用します。 このタスク シーケンス ステップが実行されるまで、対象のコンピューターは適用可能なソフトウェア更新プログラムが評価されません。 実行されると、インストール先のコンピューターでは、Configuration Manager で管理されている他のクライアントと同様に、ソフトウェアの更新状態が評価されます。 特に、このステップは、コンピューターが現在メンバーであるコレクションを対象としたソフトウェア更新プログラムのみをインストールします。  
>  [!IMPORTANT]
>ソフトウェア更新プログラムのインストール タスク シーケンス ステップを使用する場合は、パフォーマンスをより向上させるために、Windows Update エージェントの最新バージョンをインストールすることを強くお勧めします。
>* Windows 7 の場合は、[サポート技術情報 3161647](https://support.microsoft.com/kb/3161647) をご覧ください。
>* Windows 8 の場合は、[サポート技術情報 3163023](https://support.microsoft.com/kb/3163023) をご覧ください。

 このタスク シーケンス ステップは、標準のオペレーティング システムでのみ実行できます。 Windows PE では実行できません。 このタスク シーケンス アクション用のタスク シーケンス変数の詳細については、「 [Install Software Updates Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_InstallSoftwareUpdates)」を参照してください。

 > [!NOTE]
 > SMSTSMPListRequestTimeoutEnabled および SMSTSMPListRequestTimeout 組み込み変数を使用して、タスク シーケンスでロケーション サービスから管理ポイント一覧を取得できなかった場合に、アプリケーションまたはソフトウェア更新プログラムのインストールを再試行するまでの待ち時間をミリ秒単位で有効にするか、指定できます。 組み込みのタスク シーケンス変数の詳細については、「[タスク シーケンス組み込み変数](task-sequence-built-in-variables.md)」を参照してください。

> [!NOTE]
>[オプション] タブでは、コンピューターが予期せず再起動した場合に再試行するようこのタスク シーケンスを構成できます。 たとえば、コンピューターを自動的に再起動するソフトウェア更新プログラムのインストールなどです。 Configuration Manager の 1602 以降では、SMSTSWaitForSecondReboot 変数を構成して、ソフトウェア更新プログラムをインストールするときにコンピューターを再起動した後、タスク シーケンスを何秒間一時停止させるかを指定できます。 組み込みのタスク シーケンス変数の詳細については、「[タスク シーケンス組み込み変数](task-sequence-built-in-variables.md)」を参照してください。

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   指定すると、コンピューターが予期せず再起動した場合、このステップを再試行します。 再起動後に再試行する回数を指定することもできます。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **インストールが必要 - 必須のソフトウェア更新プログラムのみ**  
 Configuration Manager 内で必須フラグが付いているソフトウェア更新プログラムすべてを、タスク シーケンス実行先コンピューターにインストールするには、このオプションを選択します。 必須のソフトウェアの更新には管理者が定義したインストール期限があります。  

 **インストールが可能 - すべてのソフトウェア更新プログラム**  
 このオプションを選択して、タスク シーケンスを受信する Configuration Manager のコレクションを対象にしている利用可能なソフトウェアのすべての更新をインストールします。 利用可能なすべてのソフトウェア更新プログラムが、対象コンピューターにインストールされます。  

 **キャッシュされたスキャン結果からのソフトウェア更新プログラムの評価**  
Configuration Manager バージョン 1606 以降では、キャッシュされたスキャン結果を使う代わりに、ソフトウェアの更新プログラムのフル スキャンを実行するオプションがあります。 既定では、タスク シーケンスは、キャッシュされた結果を使用します。 チェック ボックスをオフにすれば、クライアントをソフトウェアの更新ポイントに接続し、最新のソフトウェア更新プログラム カタログを処理してダウンロードさせることができます。 このオプションは、タスク シーケンスを使って[オペレーティング システム イメージをキャプチャして構築する](../deploy-use/create-a-task-sequence-to-capture-an-operating-system.md)場合に選択できます。これは、多数のソフトウェア更新プログラムがあり、特に依存関係がある (X をインストールして初めて Y が該当すると判明する) ものが多いことがわかっている場合です。 この設定をオフにし、多数のクライアントにタスク シーケンスを展開すると、それらのすべてのクライアントが同時にソフトウェアの更新ポイントに接続することになります。 この場合、カタログの処理とダウンロードの間にパフォーマンスの問題が起きる可能性があります。 ほとんどの場合は、既定の設定を使うことをお勧めします。

新しいタスク シーケンス変数 SMSTSSoftwareUpdateScanTimeout は、Configuration Manager バージョン 1606 で導入されたものです。この変数では、タスク シーケンスの「ソフトウェア更新プログラム インストール」ステップの間に、ソフトウェア更新プログラムのスキャンのタイムアウトを制御できます。 既定値は 30 分です。 組み込みのタスク シーケンス変数の詳細については、「[タスク シーケンス組み込み変数](task-sequence-built-in-variables.md)」を参照してください。


##  <a name="BKMK_JoinDomainorWorkgroup"></a> ドメインまたはワークグループへの参加  
 対象コンピューターをワークグループまたはドメインに追加するには、[ **ドメインまたはワークグループへの参加** ] タスク シーケンス ステップを使用します。  

 このタスク シーケンス ステップは、標準のオペレーティング システムでのみ実行できます。 Windows PE では実行できません。 このタスク シーケンス アクション用のタスク シーケンス変数の詳細については、「 [Join Domain or Workgroup Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_JoinDomainWorkgroup)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **ワークグループに参加**  
 対象コンピューターを指定したワークグループに参加させるには、このオプションを選択します。 コンピューターが現在ドメインのメンバーである場合は、このオプションを選択するとコンピューターが再起動します。  

 **ドメインに参加**  
 対象コンピューターを指定したドメインに参加させるには、このオプションを選択します。  

 必要に応じて、コンピューターが参加する、指定したドメインの組織単位 (OU) を入力または参照して指定します。 コンピューターが他のドメインまたはワークグループのメンバーである場合は、このオプションを選択するとコンピューターが再起動します。 コンピューターが既に他の OU のメンバーになっている場合、Active Directory Domain Services により OU の変更がブロックされ、この設定は無視されます。  

 **ドメインに参加する権限のあるアカウントを入力してください**  
 [ **設定** ] をクリックし、ドメインに参加するためのアクセス許可を持つアカウントとパスワードを入力します。 アカウントは次の形式で入力する必要があります。  

 *ドメイン\アカウント*  

## <a name="BKMK_PrepareConfigMgrClientforCapture"></a> ConfigMgr クライアントのキャプチャの準備  
イメージ作成プロセスでのキャプチャの準備として、参照コンピューター上の Configuration Manager クライアントを削除したり、クライアントを構成したりするには、**[ConfigMgr クライアントのキャプチャの準備]** ステップを使います。

Configuration Manager バージョン 1610 以降の ConfigMgr クライアントの準備手順では、キー情報だけではなく、Configuration Manager クライアントが完全に削除されます。 タスク シーケンスでキャプチャしたオペレーティング システム イメージを展開すると、毎回新しい Configuration Manager クライアントがインストールされます。  

Configuration Manager バージョン 1610 より前のこの手順では、次のタスクが実行されます。  

-   クライアント構成プロパティのセクションを、Windows ディレクトリ内の smscfg.ini ファイルから削除します。 このプロパティには、Configuration Manager GUID や他のクライアント識別子など、クライアント固有の情報が含まれます。  

-   すべての SMS または Configuration Manager マシンの証明書を削除します。  

-   Configuration Manager クライアント キャッシュを削除します。  

-   Configuration Manager クライアント用に割り当てられたサイト変数をクリアします。  

-   すべてのローカルの Configuration Manager ポリシーを削除します。  

-   Configuration Manager クライアントの信頼されたルート キーを削除します。  

 このタスク シーケンス ステップは、標準のオペレーティング システムでのみ実行できます。 Windows PE では実行できません。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

##  <a name="BKMK_PrepareWindowsforCapture"></a> Windows のキャプチャの準備  
 参照コンピューターでオペレーティング システム イメージをキャプチャするときに使用する Sysprep オプションを指定するには、[ **Windows のキャプチャの準備** ] タスク シーケンス ステップを使用します。 このタスク シーケンスのアクションは Sysprep を実行してから、タスク シーケンスで指定した Windows PE ブート イメージにコンピューターを再起動します。 このアクションを正常に完了するには、参照コンピューターをドメインに参加させないでください。  

 このタスク シーケンス ステップは、標準のオペレーティング システムでのみ実行できます。 Windows PE では実行できません。 このタスク シーケンス アクション用のタスク シーケンス変数の詳細については、「 [Prepare Windows for Capture Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_PrepareWindowsCapture)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **大容量記憶装置ドライバーのリストを自動作成する**  
 このオプションをオンにすると、Sysprep によって参照コンピューターから大容量記憶装置ドライバーのリストが自動的に作成されます。 このオプションでは、参照コンピューターの sysprep.inf ファイルにある [大容量記憶装置ドライバーの作成] オプションが有効になります。 この設定の詳細については、Sysprep のドキュメントを参照してください。  

 **アクティブ化フラグをリセットしない**  
 このオプションをオンにすると、Sysprep によってプロダクト アクティベーション フラグがリセットされなくなります。  

##  <a name="BKMK_PreProvisionBitLocker"></a> BitLocker の事前プロビジョニング  
 Windows PE のドライブで BitLocker を有効にするには、[ **BitLocker の事前プロビジョニング** ] タスク シーケンス ステップを使用します。 使用されているドライブ領域のみが暗号化されるため、暗号化にかかる時間が大幅に短くなります。 オペレーティング システムのインストール後に [BitLocker の有効化](#BKMK_EnableBitLocker) タスク シーケンス ステップを使用することで、キー管理オプションを適用します。 このステップは Windows PE でのみ実行されます。 このステップは標準のオペレーティング システムでは実行できません。  

> [!IMPORTANT]  
>  BitLocker を事前プロビジョニングするには、Windows 7 以降のオペレーティング システムを展開する必要があり、対象のコンピューターで TPM がサポートされ、有効になっている必要があります。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前を指定します。  

 **説明**  
 このステップで実行されるアクションの詳細情報を指定します。  

 **BitLocker を指定のドライブに適用します**  
 BitLocker を有効にするドライブを指定します。 ドライブ上の使用領域のみが暗号化されます。  

 **TPM がないか、TPM が有効ではない場合は、コンピューターでこの手順はスキップされます。**  
 コンピューターのハードウェアが TPM をサポートしていない場合や TPM が有効でない場合にドライブの暗号化をスキップするには、このオプションを選択します。 たとえば、仮想マシンにオペレーティング システムを展開するときに、このオプションを使用することができます。  

##  <a name="BKMK_ReleaseStateStore"></a> 状態ストアのリリース  
 キャプチャ処理または復元処理が完了したことを、状態移行ポイントに通知するには、[ **状態ストアのリリース** ] タスク シーケンス ステップを使用します。 [状態ストアのリリース] タスク シーケンス ステップは、状態移行ポイントおよびユーザー状態移行ツール (USMT) を使用してユーザー状態を移行するときに、[ **状態ストアの要求**]、[ **ユーザー状態のキャプチャ**]、および [ **ユーザー状態の復元** ] の各タスク シーケンス ステップと共に使用します。  

 オペレーティング システムを展開するときに、ユーザー状態の移行を管理する方法の詳細については、「[Manage user state](../get-started/manage-user-state.md)」 (ユーザー状態の管理) を参照してください。  

 **[状態ストアの要求タスク]** シーケンス ステップでユーザー状態をキャプチャするために状態移行ポイントへのアクセスを要求した場合、このステップは、キャプチャ処理が完了したこと、およびユーザー状態データが復元可能になったことを状態移行ポイントに通知します。 状態移行ポイントは、キャプチャした状態のアクセス制御許可を設定し、復元中のコンピューターからのみアクセス (読み取り専用) できるようにします。  

 [ **状態ストアの要求** ] タスク シーケンス手順でユーザー状態を復元するために状態移行ポイントへのアクセスを要求した場合、このタスク シーケンス ステップは、状態移行ポイントに復元プロセスが完了したことを通知します。 この時点で、状態移行ポイントに構成した保存設定がアクティブ化されます。  

> [!IMPORTANT]  
>  どの [ **状態ストアの要求** ] タスク シーケンス アクションにも一致する [ **状態ストアのリリース** ] タスク シーケンス アクションがあるように、[ **状態ストアの要求** ] ステップと [ **状態ストアのリリース** ] ステップの間の、どのタスク シーケンス ステップでも、[ **エラー時に続行する** ] を設定することをお勧めします。  

 このタスク シーケンス ステップは、標準のオペレーティング システムでのみ実行できます。 Windows PE では実行できません。 このタスク シーケンス アクション用のタスク シーケンス変数の詳細については、「 [Release State Store Sequence Action Variables](task-sequence-action-variables.md#BKMK_ReleaseStateStore)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

##  <a name="BKMK_RequestStateStore"></a> 状態ストアの要求  
 コンピューターから状態をキャプチャするとき、またはコンピューターに状態を保存するときに [ **状態ストアの要求** ] タスク シーケンス ステップを使用して、状態移行ポイントへのアクセスを要求します。  

 オペレーティング システムを展開するときに、ユーザー状態の移行を管理する方法の詳細については、「[Manage user state](../get-started/manage-user-state.md)」 (ユーザー状態の管理) を参照してください。  

 [ **状態ストアの要求** ] タスク シーケンス ステップは、状態移行ポイントおよびユーザー状態移行ツール (USMT) を使用してコンピューターの状態を移行するときに、[ **状態ストアのリリース**]、[ **ユーザー状態のキャプチャ**]、および [ **ユーザー状態の復元** ] の各タスク シーケンス ステップと共に使用できます。  

> [!NOTE]  
>  新しい状態移行ポイント サイトの役割 (SMP) を確立した場合は、ユーザー状態ストアで利用できるようになるまで最大 1 時間かかることがあります。 SMP が利用できるまでの時間を短縮するために、任意の状態移行ポイントのプロパティ設定を調整してサイト コントロール ファイルの更新を開始することができます。  

 このタスク シーケンス ステップは、標準のオペレーティング システムおよびオフライン USMT の Windows PE に対して実行できます。 このタスク シーケンス アクションのタスク シーケンス変数については、「 [Request State Store Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_RequestState)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **状態をコンピューターからキャプチャする**  
 状態移行ポイントの設定 (最大クライアント数や最小空きディスク領域) で構成したとおりの最小要件を満たす状態移行ポイントを検索しますが、状態移行時に十分な領域が利用できることは保証されません。 ユーザー状態および設定をコンピューターからキャプチャするために、このオプションを選択して、状態移行ポイントへのアクセスを要求します。  

 Configuration Manager サイトに有効な状態移行ポイントが複数存在する場合、このタスク シーケンス手順では、利用可能なディスク領域を持つ状態移行ポイントが検索されます。この検索は、サイトの管理ポイントに状態移行ポイントの一覧を要求するクエリを送信し、最小要件を満たす状態移行ポイントが検索されるまで状態移行ポイントを評価することにより行われます。  

 **状態を他のコンピューターから復元する**  
 以前にキャプチャされたユーザー状態および設定を対象のコンピューター上に復元するために、このオプションを選択して、状態移行ポイントへのアクセスを要求します。  

 Configuration Manager サイトに複数の状態移行ポイントが存在する場合、このタスク シーケンス ステップは、対象のコンピューター用に保存されたコンピューターの状態を持つ状態移行ポイントを検索します。  

 **再試行回数**  
 このタスク シーケンス ステップ手順が適切な状態移行ポイントを検索する試行回数です。この回数を超えるとこのステップは失敗します。  

 **再試行の待ち時間 (秒)**  
 タスク シーケンス ステップが再試行を行うまで待機する時間 (秒単位) です。  

 **コンピューター アカウントで状態ストアに接続できない場合、ネットワーク アクセス アカウントを使用する**  
 Configuration Manager クライアントがコンピューター アカウントを使用して SMP 状態ストアにアクセスできない場合、Configuration Manager ネットワーク アクセス アカウント資格情報を使用して状態移行ポイントに接続されるように指定します。 他のコンピューターがネットワーク アクセス アカウントを使用して保存された状態にアクセスできる可能性があるため、このオプションは安全性が低くなりますが、対象コンピューターがドメインに参加していない場合はこのオプションが必要になる場合があります。  

##  <a name="BKMK_RestartComputer"></a> コンピューターの再起動  
 [ **コンピューターの再起動** ] タスク シーケンス ステップを使用して、タスク シーケンスを実行しているコンピューターを再起動します。 コンピューターは再起動後、タスク シーケンスを次の手順から自動的に続行します。  

 このステップは、標準のオペレーティング システムでも、Windows PE でも実行できます。 このタスク シーケンス アクションのタスク シーケンス変数の詳細については、「[Restart Computer Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_RestartComputer)」 (コンピューターの再起動タスク シーケンス アクション変数) を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **このタスク シーケンスに割り当てられているブート イメージ**  
 タスク シーケンスに割り当てられているブート イメージを対象コンピューターで使用するには、このオプションを選択します。 このブート イメージは、Windows PE で実行されるそれ以降のタスク シーケンス ステップを実行するのに使用されます。  

 **現在インストールされている既定のオペレーティング システム**  
 インストールされているオペレーティング システムで対象コンピューターを起動するには、このオプションを選択します。  

 **再起動する前にユーザーに通知する**  
 対象コンピューターが再起動されるという通知をユーザーに表示するには、このオプションを選択します。 既定では、このオプションはオンです。  

 **通知メッセージ**  
 対象コンピューターの再起動前にユーザーに表示される通知メッセージを入力します。  

 **メッセージ表示のタイムアウト**  
 対象コンピューターが再起動されるまでにユーザーに与えられる時間を秒単位で指定します。 既定の時間は 60 秒です。  

##  <a name="BKMK_RestoreUserState"></a> ユーザー状態の復元  
 [ **ユーザー状態の復元** ] タスク シーケンス ステップを使用すると、ユーザー状態移行ツール (USMT) を起動して、対象コンピューターにユーザー状態と設定を復元できます。 このタスク シーケンス ステップは、[ **ユーザー状態のキャプチャ** ] タスク シーケンス ステップと共に使用します。  

 オペレーティング システムを展開するときに、ユーザー状態の移行を管理する方法の詳細については、「[Manage user state](../get-started/manage-user-state.md)」 (ユーザー状態の管理) を参照してください。  

 Configuration Manager サイトの状態移行ポイントに状態設定を保存したり、状態移行ポイントから設定を復元したりする場合は、[**ユーザー状態の復元**] タスク シーケンス ステップを、[**状態ストアの要求**] タスク シーケンス ステップおよび [**状態ストアのリリース**] タスク シーケンス ステップと共に使用できます。 USMT 3.0 以降では、このオプションにより Configuration Manager が生成および管理する暗号化キーを使った USMT 状態ストアの解読が必ず行われます。  

 [ **ユーザー状態の復元** ] タスク シーケンス ステップにより、最も一般的に使用されているオプションの限定されたサブセットが制御できます。 その他のコマンド ライン オプションは、OSDMigrateAdditionalRestoreOptions タスク シーケンス 変数を使用して指定できます。  

> [!IMPORTANT]  
>  オペレーティング システムの展開シナリオとは関係なく **[ユーザー状態の復元]** タスク シーケンス ステップを使用している場合は、 [[ユーザー状態の復元]](#BKMK_RestartComputer) タスク シーケンス ステップの直後に **Restart Computer** タスク シーケンス ステップを追加してください。  

 このタスク シーケンス ステップは、標準のオペレーティング システムでのみ実行できます。 Windows PE では実行できません。 このタスク シーケンス アクションのタスク シーケンス変数については、「 [Restore User State Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_RestoreUserState)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前を指定します。  

 **説明**  
 この手順で実行される操作の詳細情報を指定します。  

 **ユーザー状態移行ツール パッケージ**  
 この手順でユーザー状態と設定を復元するときに使用する USMT のバージョンを含む Configuration Manager パッケージを入力します。 このパッケージにはプログラムは必要ありません。 タスク シーケンス ステップが実行されると、タスク シーケンスは、指定したパッケージの中からそのバージョンの USMT を使用します。 状態を復元するオペレーティング システムのアーキテクチャに応じて、32 ビット バージョンまたは 64 ビット バージョンの USMT を含むパッケージを指定します。  

 **キャプチャしたすべてのユーザー プロファイルを標準オプションを使用して復元する**  
 キャプチャしたユーザー プロファイルを標準オプションを使用して復元します。 復元するオプションをカスタマイズするには、[ **ユーザー プロファイルのキャプチャ方法をカスタマイズする**] を選択します。  

 **ユーザー プロファイルの復元方法をカスタマイズする**  
 対象のコンピューターに復元するファイルをカスタマイズできます。 [ **ファイル** ] をクリックして、ユーザー プロファイルの復元に使用する、USMT パッケージ内の構成ファイルを指定します。 構成ファイルを追加するには、[ **ファイル名** ] ボックスにファイル名を入力し、[ **追加**] をクリックします。 [ファイル] ペインに、操作に使用される構成ファイルが一覧表示されます。 .xml ファイルを指定することによって、どのユーザー ファイルを復元するかが定義されます。  

 **ローカル コンピューターのユーザー プロファイルを復元する**  
 ローカル コンピューターのユーザー (つまりドメイン ユーザー以外) プロファイルを復元します。 元のローカル ユーザー アカウントのパスワードは移行できないので、復元したローカル ユーザー アカウントに新しいパスワードを割り当てる必要があります。 [ **パスワード** ] ボックスに新しいパスワードを入力し、[ **パスワードの確認入力** ] ボックスに確認のために同じパスワードを入力します。  

 **復元できないファイルがあっても続行する**  
 一部のファイルを復元できない場合でも、ユーザー状態と設定の復元を続行します。 既定では、このオプションは有効になっています。 このオプションを無効にし、ファイルの復元時にエラーが発生した場合は、エラー発生と同時にタスク シーケンス ステップが終了し、一部のファイルは復元されません。  

 **詳細ログ記録を有効にする**  
 詳細なログ ファイル情報を生成するには、このオプションを有効にします。 状態を復元すると、ログ Loadstate.log が生成され、既定では \windows\system32\ccm\logs フォルダー内にあるタスク シーケンス ログ フォルダーに保存されます。  

##  <a name="BKMK_RunCommandLine"></a> コマンド ラインの実行  
 [ **コマンド ラインの実行** ] タスク シーケンス ステップを使用して、コマンドラインを実行します。  

 このステップは、標準のオペレーティング システムでも、Windows PE でも実行できます。 このタスク シーケンス アクション用のタスク シーケンス変数の詳細については、「 [Run Command Line Task Sequence Action Variables](task-sequence-action-variables.md#BKMK_RunCommand)」を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 実行するコマンド ラインを説明する短いユーザー定義の名前を指定します。  

 **説明**  
 実行するコマンド ラインに関するより詳細な情報を指定します。  

 **コマンド ライン**  
 実行されたコマンド ラインを指定します。 このフィールドは必須です。 ベスト プラクティスとして、.vbs や .exe など、ファイル名拡張子を指定することをお勧めします。 必要な設定ファイル、コマンド ライン オプション、またはスイッチをすべて含めます。  

 ファイル名にファイル名拡張子が指定されていない場合は、Configuration Manager では .com、.exe、.bat が試されます。 ファイル名に拡張子が付いていても、それが実行可能ファイルでない場合は、Configuration Manager ではローカルの関連付けが適用されます。 たとえば、コマンド ラインが readme.gif の場合は、Configuration Manager では .gif ファイルを開くために対象のコンピューターで指定されたアプリケーションを起動します。  

 次に例を示します。  

 **setup.exe /a**  

 **cmd.exe /c copy Jan98.dat c:\sales\Jan98.dat**  

> [!NOTE]  
>  出力のリダイレクト、パイプ、コピーなどのコマンド ライン操作を正常に実行するには、上の例のように、先頭に **cmd.exe /c** コマンドを付ける必要があります。  

 **64 ビット ファイル システムのリダイレクトを無効にする**  
 既定では、64 ビット オペレーティング システム上で実行する場合、コマンド ラインの実行可能ファイルが検索され、WOW64 ファイル システム リダイレクターを使用して実行され、32 ビット バージョンのオペレーティング システムの実行可能ファイルや DLL が検出されます。  このオプションを選択すると、WOW64 ファイル システム リダイレクターの使用が無効になり、ネイティブ 64 ビット バージョンのオペレーティング システムの実行可能ファイルや DLL を検出できます。  32 ビット オペレーティング システム上で実行している場合、このオプションの選択による影響はありません。  

 **開始**  
 プログラムの実行可能フォルダーを 127 文字以内で指定します。 このフォルダーには、対象のコンピューターの絶対パスを指定することも、パッケージを含む配布ポイント フォルダーを基準としたパスを指定することもできます。 このフィールドは省略可能です。  

 次に例を示します。  

 **c:\officexp**  

 **i386**  

> [!NOTE]  
>  [ **参照** ] ボタンをクリックすると、ローカル コンピューターのファイルとフォルダーが参照されるので、この方法で選択したものは常に対象のコンピューターでも同じ場所に同じファイル名およびフォルダー名で存在している必要があります。  

 **パッケージ**  
 対象のコンピューターにまだ存在しないファイルまたはプログラムをコマンド ラインで指定する場合、このオプションを選択して該当するファイルを含む Configuration Manager パッケージを指定します。 このパッケージにはプログラムは必要ありません。 このオプションは、指定するファイルが対象のコンピューターに存在する場合には必要ありません。  

 **タイムアウト**  
 Configuration Manager で、コマンド ラインに許容される実行時間を表す値を指定します。 可能な値は 1 ～ 999 分です。 既定値は 15 分です。  

 既定では、このオプションは無効になっています。  

> [!IMPORTANT]  
>  コマンド ラインの実行タスク シーケンス ステップが正常に完了するのに十分な値を入力しないと、タスク シーケンス ステップが失敗し、他のコントロールの設定によってはタスク シーケンス全体が失敗する場合もあります。 タイムアウトに達すると、Configuration Manager はコマンド ライン プロセスを終了します。  

 **このステップを次のアカウントで実行する**  
 ローカル システム アカウント以外の Windows ユーザー アカウントとして実行されるコマンド ラインを指定します。  

> [!NOTE]  
>  このステップに別のアカウントを指定し、かつそれがオペレーティング システムのインストール ステップより後に起こるステップなら、単純なスクリプトやコマンドを実行する場合は事前にアカウントをコンピューターに追加しておく必要があり、より複雑なプログラム (MSI など) を実行する場合は Windows ユーザー アカウントのプロファイルを復元する必要があります。  

 **アカウント**  
 この操作によって実行されるタスク シーケンスのコマンド ライン タスク用に、[別のユーザーとして実行] Windows ユーザー アカウントを指定します。 コマンド ラインは、指定したアカウントのアクセス許可を使用して実行されます。 **[設定]** をクリックして、ローカル ユーザーまたはドメイン アカウントを指定します。  

> [!IMPORTANT]  
>  ユーザー アカウントを指定する [ **コマンド ラインの実行** ] タスク シーケンス アクションが Windows PE で実行されると、Windows PE はドメインに参加できないため、このアクションは失敗します。 エラーは smsts.log ファイルに記録されます。  

##  <a name="BKMK_RunPowerShellScript"></a> PowerShell スクリプトの実行  
 指定した PowerShell スクリプトを実行するには、[ **PowerShell スクリプトの実行** ] タスク シーケンス ステップを使用します。  

 このステップは、標準のオペレーティング システムでも、Windows PE でも実行できます。 Windows PE でのこのステップを実行するには、ブート イメージで PowerShell を有効にする必要があります。 ブート イメージのプロパティの [ **オプション コンポーネント** ] タブで、Windows PowerShell (WinPE PowerShell) を有効にすることができます。 ブート イメージを変更する方法について詳しくは、「[Manage boot images](../get-started/manage-boot-images.md)」 (ブート イメージの管理) を参照してください。  

> [!NOTE]  
>  PowerShell は、Windows Embedded オペレーティング システムでは既定では無効です。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 実行するコマンド ラインを説明する短いユーザー定義の名前を指定します。  

 **説明**  
 実行するコマンド ラインに関するより詳細な情報を指定します。  

 **パッケージ**  
 PowerShell スクリプトを含む Configuration Manager パッケージを指定します。 1 つのパッケージに複数の PowerShell スクリプトを含めることができます。  

 **スクリプト名**  
 実行する PowerShell スクリプトの名前を指定します。 このフィールドは必須です。  

 **パラメーター**  
 Windows PowerShell スクリプトに渡されるパラメーターを指定します。 コマンドラインから Windows PowerShell スクリプトにパラメーターを追加する場合のパラメーターを構成します。  

> [!IMPORTANT]  
>  Windows PowerShell のコマンド ラインで使用するパラメーターではなく、スクリプトで使用するパラメーターを指定します。  
>   
>  次の例には、有効なパラメーターが含まれています。  
>   
>  **-MyParameter1 MyValue1 -MyParameter2 MyValue2**  
>   
>  次の例には、無効なパラメーターが含まれています。 太字の項目は Windows PowerShell のコマンド ライン パラメーター (-nologo と –executionpolicy unrestricted) であり、スクリプトでは使用しません。  
>   
>  **-nologo-executionpolicy unrestricted-File MyScript.ps1 -MyParameter1 MyValue1 -MyParameter2 MyValue2**  

 **PowerShell 実行ポリシー**  
 どの Windows PowerShell スクリプトにコンピューター上での実行を許可するかを指定できる、PowerShell 実行ポリシーを選択します。 次のいずれかの実行ポリシーを選択します。  

-   **AllSigned**: 信頼された発行元によって署名されたスクリプトのみを実行できます。  

-   **Undefined**: 実行ポリシーが定義されていません。 。  

-   **Bypass**: すべての構成ファイルを読み込み、すべてのスクリプトを実行します。 インターネットからダウンロードされた、署名されていないスクリプトを実行する場合、実行前にアクセス許可を求めるメールは表示されます。  

> [!IMPORTANT]  
>  PowerShell 1.0 は [未定義] および [バイパス] の実行ポリシーをサポートしていません。  

##  <a name="BKMK_SetDynamicVariables"></a> 動的変数の設定  
 [ **動的変数の設定** ] タスク シーケンス ステップを使用して次の手順を実行します。  

1.  コンピューターとその環境から情報を収集し、指定したタスク シーケンス変数に情報を設定します。  

2.  定義されている規則を評価し、true と評価される規則に構成されている変数と値に基づいてタスク シーケンス変数を設定します。  

 タスク シーケンスによって、次の読み取り専用のタスク シーケンス変数が自動的に設定されます。  

 -   &#95;SMSTSMake  

 -   &#95;SMSTSModel  

 -   &#95;SMSTSMacAddresses  

 -   &#95;SMSTSIPAddresses  

 -   &#95;SMSTSSerialNumber  

 -   &#95;SMSTSAssetTag  

 -   &#95;SMSTSUUID  

 このステップは、標準のオペレーティング システムでも、Windows PE でも実行できます。 タスク シーケンス変数の詳細については、「[Task sequence action variables](task-sequence-action-variables.md)」 (タスク シーケンス アクション変数) を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

**名前**  
 このタスク シーケンス ステップの短いユーザー定義名。  

**説明**  
 このステップで実行されるアクションの詳細情報。  

**動的規則と変数**  
 タスク シーケンスで使用する動的変数を設定するには、規則を追加した後で規則を指定する各変数の値を指定するか、または規則を追加せずに 1 つ以上の変数を追加して設定します。 規則を追加する場合は、次の規則のカテゴリから選択できます。  

 -   **コンピューター**: 資産タグ、UUID、シリアル番号、または MAC アドレスの値を評価するには、この規則カテゴリを使用します。 複数の値を設定できます。その任意の値が true の場合、規則が true と評価されることになります。 たとえば、次の規則は、シリアル番号が 5892087 であれば、MAC アドレスが 26-78-13-5A-A4-22 に等しいかどうかに関係なく true と評価されます。  

     `IF Serial Number = 5892087 OR MAC address = 26-78-13-5A-A4-22 THEN`  

-   **場所**: 既定のゲートウェイの値を評価するには、この規則カテゴリを使用します。  

-   **メーカーおよびモデル**: コンピューターのメーカーおよびモデルの値を評価するには、この規則カテゴリを使用します。 規則を true と評価するには、製造元とモデルの両方が true と評価される必要があります。   

    Configuration Manager バージョン 1610 以降では、ワイルドカードとしてアスタリスク (*****) および疑問符 ( **?** ) を指定できます。***** は複数の文字と一致し、 **?** は  1 文字と一致します。 たとえば、"DELL*900?" という文字列は、 DELL-ABC-9001 や DELL9009 と一致します。

-   **タスク シーケンス変数**: 評価するタスク シーケンス変数、条件、および値を追加するには、この規則カテゴリを使用します。 変数に設定された値が指定した条件を満たしている場合、規則は true と評価されます。  

true と評価される規則に 1 つ以上の変数を設定して指定することも、規則を使用せずに変数を設定することもできます。 既存の変数を選択することも、カスタム変数を作成することもできます。  

 -   **既存のタスク シーケンス変数**: 既存のタスク シーケンス変数の一覧から 1 つ以上の変数を選択するには、この設定を使用します。 配列変数は選択できません。  

 -   **カスタム タスク シーケンス変数**: カスタム タスク シーケンス変数を定義するには、この設定を使用します。 既存のタスク シーケンス変数を指定することもできます。 変数の配列は既存のタスク シーケンス変数の一覧に含まれないため、OSDAdapter などの既存の変数配列を指定する場合に便利です。  

規則に変数を選択した後、各変数の値を指定する必要があります。 規則が true と評価されると、変数は指定された値に設定されます。 変数ごとに [ **秘密の値** ] を選択して変数の値を非表示にできます。 既定では、OSDCaptureAccountPassword タスク シーケンス変数など、いくつかの既存の変数の値を非表示にします。  

> [!IMPORTANT]  
>  [動的変数の設定] ステップでタスク シーケンスをインポートするときに、変数の値に対して [ **秘密の値** ] が選択されている場合、タスク シーケンスをインポートするときに値が削除されます。 その結果、タスク シーケンスをインポートした後、動的変数の値を再入力する必要があります。  

##  <a name="BKMK_SetTaskSequenceVariable"></a> タスク シーケンス変数の設定  
 [ **タスク シーケンス変数の設定** ] タスク シーケンス ステップを使用して、タスク シーケンスで使用する変数を設定します。  

 このステップは、標準のオペレーティング システムでも、Windows PE でも実行できます。 タスク シーケンス変数はタスク シーケンス アクションによって読み取られます。また、これらのアクションの動作はタスク シーケンス変数によって指定されます。 特定のタスク シーケンス変数の詳細については、「[Task sequence action variables](task-sequence-action-variables.md)」 (タスク シーケンス アクション変数) を参照してください。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このタスク シーケンス ステップの短いユーザー定義名。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **タスク シーケンス変数**  
 タスク シーケンス変数のユーザー定義名。  

 **値**  
 タスク シーケンス変数に関連付けられた値。 この値は、%<varname\>% という構文で、別のタスク シーケンス変数にすることができます。  

##  <a name="BKMK_SetupWindowsandConfigMgr"></a> Windows と ConfigMgr のセットアップ  
 [ **Windows と ConfigMgr のセットアップ** ] タスク シーケンス ステップを使用すると、Windows PE から新しいオペレーティング システムへの移行を実施できます。 このタスク シーケンス ステップはあらゆるオペレーティング システム展開に必要です。 このステップでは、Configuration Manager クライアントを新しいオペレーティング システムにインストールして、新しいオペレーティング システムでタスク シーケンスの実行を継続できるようにします。  

 このステップは Windows PE でのみ実行されます。 このステップは標準のオペレーティング システムでは実行できません。 このタスク シーケンス アクション用のタスク シーケンス変数の詳細については、「[Windows と ConfigMgr のセットアップ タスク シーケンス アクション変数](task-sequence-action-variables.md#BKMK_SetupWindows)」を参照してください。  

 **[Windows と ConfigMgr のセットアップ]** タスク シーケンス アクションでは、%WINDIR% や %ProgramFiles% などの、sysprep.inf または unattend.xml のディレクトリ変数が、Windows PE インストール ディレクトリ X:\Windows に置き換えられます。 これらの環境変数を使用して指定されたタスク シーケンス変数は無視されます。  

 このタスク シーケンス ステップを使用して次のアクションを実行します。  

1.  準備: Windows PE  

    1.  unattend.xml ファイルへのタスク シーケンス変数の代入を実行します。  

    2.  Configuration Manager クライアントを含むパッケージをダウンロードし、展開されたイメージ内に配置します。  

2.  Windows の設定  

    1.  イメージ ベースのインストール。  

        1.  イメージの Configuration Manager クライアントを無効にします (つまり、Configuration Manager クライアント サービスの自動起動を無効にする)。  

        2.  展開されたイメージ内のレジストリを更新して、展開されたオペレーティング システムが、必ず参照コンピューター上でのドライブ文字と同じものを使用して起動するようにします。  

        3.  展開されたオペレーティング システムを再起動します。  

        4.  以前指定した sysprep.inf ファイルか unattend.xml ファイルを使用して Windows ミニセットアップが実行されます。このとき、ユーザーの操作はすべて抑制されます。 注: **[ネットワーク設定の適用]** でドメインへの参加を指定した場合、その情報は sysprep.inf ファイルまたは unattend.xml ファイルに収められ、Windows ミニセットアップがドメインへの参加を実行します。  

    2.  Setup.exe ベースのインストール。  通常の Windows セットアップ プロセスに続く Setup.exe を実行します。  

        1.  先ほど [ **オペレーティング システムの適用** ] タスク シーケンスで指定したオペレーティング システムのインストール パッケージをハード ドライブにコピーします。  

        2.  新たに展開されたオペレーティング システムを再起動します。  

        3.  以前指定した sysprep.inf ファイルか unattend.xml ファイルを使用して Windows ミニセットアップが実行されます。このとき、ユーザーのインターフェイス設定はすべて抑制されます。 注: **[ネットワーク設定の適用]** でドメインへの参加を指定した場合、その情報は sysprep.inf ファイルまたは unattend.xml ファイルに収められ、Windows ミニセットアップがドメインへの参加を実行します。  

3.  Configuration Manager クライアントの設定  

    1.  Windows ミニセットアップが完了すると、setupcomplete.cmd を使用して、タスク シーケンスが再開されます。  

    2.  [ **Windows 設定の適用** ] ステップで選択したオプションに応じて、ローカルの管理者アカウントを有効または無効にします。  

    3.  以前ダウンロードしたパッケージ (1.b) とタスク シーケンス エディターで指定したインストール プロパティを使用して、Configuration Manager クライアントをインストールします。 タスク シーケンスが完了するまでクライアントが新しいポリシー要求を処理しないよう、クライアントは “プロビジョニング モード“ でインストールされます。  

    4.  クライアントが完全に動作可能な状態になるまで待ちます。  

    5.  ネットワーク アクセス保護が有効になっている環境で動作しているコンピューターの場合、クライアントが必要な更新が見つけた場合インストールし、タスク シーケンスが実行を続ける前に必要な更新がすべて揃っているようにします。  

4.  タスク シーケンスは実行の次の手順に進みます。  

> [!NOTE]  
>  [ **Windows と ConfigMgr のセットアップ** ] タスク シーケンス アクションには、新しくインストールされたコンピューター上でグループ ポリシーを実行する役割があります。 グループ ポリシーは、タスク シーケンスの完了後に適用されます。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生する場合、選択せずにタスク シーケンスを続行する。 エラーが発生する場合、この設定を選択するかどうかに関係なく、タスク シーケンスは失敗します。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前を指定します。  

 **説明**  
 この手順で実行される操作についての追加情報を指定します。  

 **クライアント パッケージ**  
 このタスク シーケンス ステップで使用される Configuration Manager クライアント インストール パッケージを指定します。 [**参照**] をクリックし、Configuration Manager クライアントのインストールに使用するクライアント インストール パッケージを選択します。  

 **使用可能な場合に実稼働前クライアント パッケージを使用する**  
 使用可能な実稼働前クライアント パッケージがある場合に、タスク シーケンスのステップで実稼働クライアント パッケージではなく、このパッケージを使用するように指定します。 通常、実稼働前クライアントは、実稼働環境でテストされているものよりも新しいバージョンです。 [**参照**] をクリックし、Configuration Manager クライアントのインストールに使用する実稼働前クライアント インストール パッケージを選択します。  

 **インストールのプロパティ**  
 サイトの割り当てと既定の構成は、タスク シーケンス アクションによって自動的に指定されます。 このフィールドは、クライアントのインストール時に使用する追加のインストールのプロパティを指定するために使用できます。 複数のインストールのプロパティを入力するには、各プロパティの間にスペースを入力します。  

 クライアントのインストール時に使用するコマンド ライン オプションを指定できます。 たとえば、「 **/skipprereq: silverlight.exe** 」と入力すると、CCMSetup.exe に Microsoft Silverlight 前提条件をインストールしないように通知できます。 CCMSetup.exe の使用可能なコマンド ライン オプションの詳細については、「[クライアント インストールのプロパティについて](../../core/clients/deploy/about-client-installation-properties.md)」を参照してください。  

##  <a name="BKMK_UpgradeOS"></a> オペレーティング システムのアップグレード  
 **[オペレーティング システムのアップグレード]** タスク シーケンス ステップを使用して、既存の Windows 7、Windows 8、Windows 8.1、または Windows 10 オペレーティング システムを Windows 10 にアップグレードします。  

 このタスク シーケンス ステップは、標準のオペレーティング システムでのみ実行できます。 Windows PE では実行できません。  

### 説明
<a id="details" class="xliff"></a>  
 このステップの [ **プロパティ** ] タブで、このセクションで説明する設定を構成できます。  

 さらに、[ **オプション** ] タブを使用して、次の操作を実行できます。  

-   このステップを無効にする。  

-   このステップの実行中にエラーが発生した場合、タスク シーケンスを続行するかどうかを指定する。  

-   このステップの実行のために必要な条件を指定する。  

 **名前**  
 このステップで実行されるアクションを説明する、ユーザー定義の短い名前。  

 **説明**  
 このステップで実行されるアクションの詳細情報。  

 **パッケージのアップグレード**  
 アップグレードに使用する Windows 10 オペレーティング システム アップグレード パッケージを指定するには、このオプションを選択します。  

 **ソース パス**  
 使用する Windows 10 メディアへのローカル パスまたはネットワーク パスを指定します (/installFrom コマンド ライン オプションに対応)。 %mycontentpath%、%DPC01% などの変数を指定することもできます。 ソース パスに変数を使用する場合は、その変数をタスク シーケンスで先に指定しておく必要があります。 たとえば、タスク シーケンスで [パッケージ コンテンツのダウンロード](#BKMK_DownloadPackageContent) ステップを使用する場合は、オペレーティング システム アップグレード パッケージの場所に変数を指定できます。 その後、このステップのソース パスに変数を使用できます。  

 **エディション**  
 アップグレードに使用するオペレーティング システム メディア内のエディションを指定します。  

 **プロダクト キー**  
 アップグレード プロセスに適用するプロダクト キーを指定します。  

 **アップグレードの際に、Windows セットアップに次のドライバー コンテンツを指定してください**  
 アップグレード プロセス中にセットアップ先のコンピューターにドライバーを追加するには、この設定を選択します (/InstallDriver コマンド ライン オプションに対応)。 ドライバーは、Windows 10 と互換性がある必要があります。 次のいずれかを指定します。  

-   **ドライバー パッケージ**: **[参照]** をクリックし、一覧から既存のドライバー パッケージを選択します。  

-   **ステージング済みコンテンツ**: ドライバー パッケージの場所を指定するには、このオプションを選択します。 ローカル フォルダー、ネットワーク パス、またはタスク シーケンス変数を指定できます。 ソース パスに変数を使用する場合は、その変数をタスク シーケンスで先に指定しておく必要があります。 たとえば、 [Download Package Content](task-sequence-steps.md#BKMK_DownloadPackageContent) ステップを使用します。  

 **タイムアウト (分)**  
 セットアップを実行してから Configuration Manager がタスク シーケンスのステップに失敗するまでの時間を分単位で指定します。  

 **アップグレードを開始しない Windows セットアップ互換性スキャンの実行**  
 アップグレード プロセスを開始しないで Windows セットアップの互換性スキャンを実行するように指定します (/Compat ScanOnly コマンド ライン オプションに対応)。 このオプションを使用する場合は、引き続きインストール ソース全体を展開する必要があります。 セットアップでは、スキャンの結果として終了コードが返されます。 次の表に一般的な終了コードをいくつか示します。  

|終了コード|説明|  
|-|-|  
|MOSETUP_E_COMPAT_SCANONLY (0xC1900210)|互換性の問題なし ("成功")。|  
|MOSETUP_E_COMPAT_INSTALLREQ_BLOCK (0xC1900208)|対応可能な互換性の問題。|  
|MOSETUP_E_COMPAT_MIGCHOICE_BLOCK (0xC1900204)|選択された移行オプションが使用できない。 Enterprise から Professional へのアップグレードなど。|  
|MOSETUP_E_COMPAT_SYSREQ_BLOCK (0xC1900200)|Windows 10 に適合しない。|  
|MOSETUP_E_COMPAT_INSTALLDISKSPACE_BLOCK (0xC190020E)|ディスクの空き領域が不足している。|  

 このパラメーターの詳細については、「 [Windows セットアップ コマンド ライン オプション](https://msdn.microsoft.com/library/windows/hardware/dn938368\(v=vs.85\).aspx)」を参照してください。  

 **互換性に関するメッセージが無視できる場合、すべて無視する**  
 無視できる互換性に関するメッセージをすべて無視して、セットアップがインストールを完了するように指定します (/Compat IgnoreWarning コマンド ライン オプションに対応)。  

 **Windows Update で Windows セットアップを動的に更新する**  
 更新プログラムの検索、ダウンロード、インストールなどの動的な更新操作をセットアップで行うかどうかを指定します (/DynamicUpdate コマンド ライン オプションに対応)。 この設定は、Configuration Manager ソフトウェア更新プログラムと互換性がありませんが、WSUS (スタンドアロン) または Windows Update を使用して更新プログラムを処理するときに有効にすることができます。  

 **ポリシーを上書きして既定の Microsoft Update を使う**: リアルタイムでローカル ポリシーを一時的に無効にして動的な更新操作を実行し、コンピューターに Windows Update から更新プログラムを取得するには、この設定を選択します。  

