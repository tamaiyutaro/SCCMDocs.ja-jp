---

title: "ソフトウェア更新プログラムの計画 | Microsoft Docs"
description: "System Center Configuration Manager の実稼働環境でソフトウェア更新プログラムを使用する前に、ソフトウェアの更新ポイント インフラストラクチャを計画する必要があります。"
keywords: 
author: dougeby
ms.author: dougeby
manager: angrobe
ms.date: 06/27/2017
ms.topic: article
ms.prod: configuration-manager
ms.service: 
ms.technology:
- configmgr-sum
ms.assetid: d071b0ec-e070-40a9-b7d4-564b92a5465f
ms.translationtype: Human Translation
ms.sourcegitcommit: f4c46bfab9b40b29654f4e883817a5508ab25b74
ms.openlocfilehash: b5a2fd9f15992c9e5ef8aede64af5446b6852b1a
ms.contentlocale: ja-jp
ms.lasthandoff: 06/28/2017


---

# System Center Configuration Manager でのソフトウェア更新プログラムの計画
<a id="plan-for-software-updates-in-system-center-configuration-manager" class="xliff"></a>

*適用対象: System Center Configuration Manager (Current Branch)*

System Center Configuration Manager の実稼働環境でソフトウェア更新プログラムを使用する前に、計画の段階を経ることが重要です。 ソフトウェアの更新プログラムの実装を成功させるには、適切なソフトウェアの更新ポイント インフラストラクチャの計画があることが不可欠です。

## ソフトウェア更新プログラムの容量計画に関する推奨事項
<a id="capacity-planning-recommendations-for-software-updates" class="xliff"></a>  
 組織に適したソフトウェア更新プログラムの容量計画に必要な情報を特定する基準として、次の推奨事項を使用できます。 実際の容量要件は、個々のネットワーク環境、ソフトウェアの更新ポイント サイト システムのホストに使用するハードウェア、インストールされるクライアントの数、およびサーバーにインストールされるサイト システムの役割といった条件によって、このトピックに記載されている推奨事項とは異なる場合があります。  

###  <a name="BKMK_SUMCapacity"></a> ソフトウェアの更新ポイントの容量計画  
 サポートされるクライアントの数は、ソフトウェアの更新ポイントで実行されている Windows Server Update Services (WSUS) のバージョンと、ソフトウェアの更新ポイント サイト システムの役割がその他のサイト システムの役割と共存しているかどうかによって決まります。  

-   WSUS がソフトウェアの更新ポイント コンピューター上で実行されていて、ソフトウェアの更新ポイントがその他のサイト システムの役割と共存している場合、ソフトウェアの更新ポイントは、最大で 25,000 のクライアントをサポートできます。  

-   リモート コンピューターが WSUS の要件を満たしている場合、ソフトウェアの更新ポイントは最大クライアントを 150,000 までサポートできます。WSUS は Configuration Manager で使用し、次を構成します。

    IIS アプリケーション プール:
    - WsusPool キューの長さを 2000 に増やす
    - WsusPool プライベート メモリの制限を 4 倍に増やすか、0 (無制限) に設定する      

    ソフトウェアの更新ポイントのハードウェア要件の詳細については、「[Recommended hardware for site systems](/sccm/core/plan-design/configs/recommended-hardware#a-namebkmkscalesiesystemsa-site-systems)」 (サイト システムに推奨されるハードウェア) を参照してください。

-   既定で、Configuration Manager はソフトウェアの更新ポイントを NLB クラスターとして構成することはサポートされていません。 Configuration Manager バージョン 1702 より前のバージョンでは、Configuration Manager SDK を使用して、NLB クラスターに最大 4 つのソフトウェアの更新ポイントを構成できました。 しかし、Configuration Manager バージョン 1702 以降では、ソフトウェアの更新ポイントは NLB クラスターとしてサポートされず、この構成が検出された場合は Configuration Manager バージョン 1702 へのアップグレードがブロックされます。

### ソフトウェア更新オブジェクトの容量計画
<a id="capacity-planning-for-software-updates-objects" class="xliff"></a>  
 次の容量情報を参照して、ソフトウェア更新オブジェクトの計画を立てます。  

-   **展開内のソフトウェア更新プログラムの数を 1000 以下にする**  

     ソフトウェア更新プログラムの展開ごとのソフトウェア更新プログラムの数を 1000 以下にする必要があります。 自動展開規則を作成する場合、返されるソフトウェア更新プログラムの数を制限する条件を指定します。 指定した条件で 1,000 を超えるソフトウェア更新プログラムが返されると、自動展開規則は失敗します。 自動展開規則の状態は、Configuration Manager コンソールの [**自動展開規則**] ノードから確認できます。 ソフトウェア更新プログラムを手動で展開する場合は、1000 を超える更新プログラムを展開対象として選択しないでください。  

     構成基準で、ソフトウェアの更新プログラムを 1000 に制限する必要もあります。 詳細については、「[Create configuration baselines](../../compliance/deploy-use/create-configuration-baselines.md)」 (構成基準を作成する) を参照してください。

##  <a name="BKMK_SUPInfrastructure"></a> ソフトウェアの更新ポイントのインフラストラクチャを決定する  
 中央管理サイトおよびすべての子プライマリ サイトには、ソフトウェア更新プログラムを展開するソフトウェアの更新ポイントが必要です。 ソフトウェアの更新ポイントのインフラストラクチャを計画する場合、依存関係 -
 - サイトのソフトウェア更新ポイントをインストールする場所。
 - インター ネット ベースのクライアントからの通信を受け入れるソフトウェアの更新ポイントが必要なサイト。
 - セカンダリ サイトでソフトウェア更新ポイントが必要かどうか。

以下のセクションを参照して、ソフトウェアの更新ポイントのインフラストラクチャを決定します。  

> [!IMPORTANT]  
>  ソフトウェア更新プログラムに必要な内部依存関係と外部依存関係の詳細については、「[ソフトウェア更新プログラムの前提条件](prerequisites-for-software-updates.md)」を参照してください。  

 1 つの Configuration Manager プライマリ サイトに、複数のソフトウェアの更新ポイントを追加できます。 1 つのサイトに複数のソフトウェアの更新ポイントを追加できるため、複雑な NLB を使用しなくてもフォールト トレランスを確保できます。 ただし、複数のソフトウェアの更新ポイントによるフェールオーバーは、純粋な負荷分散という点では NLB ほど強固ではなく、フォールト トレランスを目的として設計されています。 また、ソフトウェアの更新ポイントのフェールオーバー設計は、管理ポイントの設計で使用される純粋なランダム化モデルとは異なります。 管理ポイントの設計とは異なり、ソフトウェアの更新ポイントでは、新しいソフトウェアの更新ポイントへの切り替えに関するクライアントとネットワークのパフォーマンス コストが存在します。 クライアントがソフトウェア更新プログラムのスキャンのために新しい WSUS サーバーに切り替えると、結果として、カタログのサイズと、関連するクライアント側およびネットワークのパフォーマンス要求が増大します。 そのため、クライアントは、正常にスキャンした最後のソフトウェアの更新ポイントとのアフィニティを維持します。  

 プライマリ サイトにインストールする最初のソフトウェアの更新ポイントは、プライマリ サイトに追加するすべての追加ソフトウェアの更新ポイントの同期ソースになります。 ソフトウェアの更新ポイントを追加し、ソフトウェア更新プログラムの同期を開始した後で、[ **監視** ] ワークスペースの [ **ソフトウェアの更新ポイントの同期ステータス** ] ノードから、ソフトウェアの更新ポイントのステータスと同期ソースを確認できます。  

 ソフトウェアの更新ポイントでエラーが発生し、そのソフトウェアの更新ポイントが、サイトのその他のソフトウェアの更新ポイントの同期ソースとして構成されている場合、エラーが発生したソフトウェアの更新ポイントを手動で削除し、同期ソースとして使用する新しいソフトウェアの更新ポイントを選択する必要があります。 ソフトウェアの更新ポイントを削除する方法の詳細については、「[ソフトウェアの更新ポイント サイト システムの役割を削除する](../get-started/remove-a-software-update-point.md)」を参照してください。  

###  <a name="BKMK_SUPList"></a> ソフトウェアの更新ポイントの一覧  
 新しいクライアントがソフトウェア更新プログラムを有効にするポリシーを受け取る場合や、クライアントが割り当てられたソフトウェアの更新ポイントに接続できず、別のソフトウェアの更新ポイントに切り替える必要がある場合に、Configuration Manager はソフトウェアの更新ポイントの一覧をクライアントに提供します。 クライアントは、一覧からランダムにソフトウェアの更新ポイントを選択し、同一のフォレストにあるソフトウェアの更新ポイントを優先します。 Configuration Manager は、クライアントの種類に応じて、異なる一覧をクライアントに提供します。  

-   **イントラネット ベースのクライアント**:イントラネットからの接続のみを受け入れるように構成できるソフトウェアの更新ポイントの一覧、または、インターネットとイントラネットのクライアントの接続を受け入れるソフトウェアの更新ポイントの一覧を受け取ります。  

-   **インターネット ベースのクライアント**: インターネットからの接続のみを受け入れるように構成したソフトウェアの更新ポイントの一覧、または、インターネットとイントラネットのクライアントの接続を受け入れるソフトウェアの更新ポイントの一覧を受け取ります。  

###  <a name="BKMK_SUPSwitching"></a> ソフトウェアの更新ポイントの切り替え  
> [!NOTE]
> バージョン 1702 以降では、クライアントは境界グループを使用して、新しいソフトウェアの更新ポイントを検索します。また、現在のソフトウェアの更新ポイントにアクセスできなくなっている場合は、フォールバックして新しいソフトウェアの更新ポイントを検索します。 ソフトウェアの更新ポイントをそれぞれ異なる境界グループに追加して、クライアントで検索できるサーバーを制御できます。 詳細については、[境界グループの構成](/sccm/core/servers/deploy/configure/boundary-groups)に関するトピックの[ソフトウェアの更新ポイント](/sccm/core/servers/deploy/configure/boundary-groups#software-update-points)の記述を参照してください。

1 つのサイトに複数のソフトウェアの更新ポイントがあり、1 つでエラーが発生するか、使用不可になった場合、クライアントは、別のソフトウェアの更新ポイントに接続し、最新のソフトウェア更新プログラムのスキャンを継続します。 クライアントに最初にソフトウェアの更新ポイントが割り当てられると、そのソフトウェアの更新ポイントでソフトウェア更新プログラムのスキャンが失敗しない限り、割り当てが維持されます。  

ソフトウェア更新プログラムのスキャンは、失敗して、さまざまな再試行および再試行なしのエラー コードが返されることがあります。 スキャンが失敗して、再試行エラー コードが返された場合、クライアントは、ソフトウェアの更新ポイントでソフトウェア更新プログラムをスキャンする再試行処理を開始します。 再試行エラー コードが返される状況の一般的な原因は、WSUS サーバーが利用できないか、一時的に過負荷状態になっていることです。 ソフトウェア更新プログラムのスキャンに失敗した場合、クライアントは次の処理を行います。  

1.  クライアントは、スケジュールされた時刻、または、クライアントのコントロール パネルか、SDK を使用して開始された場合、ソフトウェア更新プログラムをスキャンします。 スキャンが失敗した場合、クライアントは、30 分間スキャンの再試行を待機し、同じソフトウェアの更新ポイントを使用します。  

2.  クライアントは、30 分間隔で最小 4 回再試行します。 4 回目が失敗した場合、クライアントはさらに 2 分間待機して、ソフトウェアの更新ポイントの一覧にある次のソフトウェアの更新ポイントに移動します。  

3.  クライアントはソフトウェアの新しい更新ポイント上でも同じプロセスをたどります。 スキャンが成功すると、クライアントは引き続きソフトウェアの新しい更新ポイントへの接続を行います。

 ソフトウェアの更新ポイントの再試行と切り替えのシナリオで考慮できる追加情報を、次の一覧に示します。  

-   クライアントが企業イントラネットから切断され、ソフトウェア更新プログラムのスキャンが失敗した場合、別のソフトウェアの更新ポイントに切り替えられない。 これは想定済みのエラーです。クライアントが、企業ネットワーク、または、イントラネットからの接続を受け入れるソフトウェアの更新ポイントに到達できないためです。 Configuration Manager クライアントは、イントラネットのソフトウェアの更新ポイントが利用できるかどうかを特定します。  

-   インターネット ベースのクライアント管理が有効で、インターネット上のクライアントからの通信を受け入れるように構成されているソフトウェアの更新ポイントが複数ある場合、切り替え処理は前のシナリオで説明した標準の再試行処理に従う。  

-   スキャン処理が開始されたが、スキャンが完了する前にクライアントの電源がオフになった場合、スキャンの失敗とされず、4 回の再試行の 1 回としてカウントされない。  

Configuration Manager は、次に示す Windows Update エージェントのエラー コードのいずれかを受信すると、クライアントに接続を再試行するよう指示します。  

2149842970, 2147954429, 2149859352, 2149859362, 2149859338, 2149859344, 2147954430, 2147747475, 2149842974, 2149859342, 2149859372, 2149859341, 2149904388, 2149859371, 2149859367, 2149859366, 2149859364, 2149859363, 2149859361, 2149859360, 2149859359, 2149859358, 2149859357, 2149859356, 2149859354, 2149859353, 2149859350, 2149859349, 2149859340, 2149859339, 2149859332, 2149859333, 2149859334, 2149859337, 2149859336, 2149859335

エラー コードの意味を調べるには、10 進数のエラー コードを 16 進数のエラーコードに変換し、[Windows Update Agent - Error Codes Wiki](https://social.technet.microsoft.com/wiki/contents/articles/15260.windows-update-agent-error-codes.aspx) (Windows Update エージェント - エラー コード Wiki) などのサイトで 16 進数値を検索してください。


###  <a name="BKMK_ManuallySwitchSUPs"></a> 手動でのクライアントの新しいソフトウェアの更新ポイントへの切り替え
Configuration Manager バージョン 1606 から、アクティブなソフトウェア更新ポイントに問題がある場合に、Configuration Manager クライアントが新しいソフトウェア更新ポイントに切り替えるためのオプションを有効にできます。 このオプションでは、クライアントが管理ポイントから複数のソフトウェア更新ポイントを受信した場合にのみ変更が加えられます。  

デバイス コレクションまたは選択したデバイスのセットでこのオプションを有効にします。 有効にすると、クライアントは次のスキャンにおいて他のソフトウェア更新ポイントを探します。 WSUS の構成設定に応じて (更新プログラムの分類、製品、ソフトウェアの更新ポイントが WSUS データベースを共有するかどうかなど)、新しいソフトウェアの更新ポイントへの切り替えにより、追加のネットワーク トラフィックが発生します。 したがって、必要な場合に、このオプションのみを使用する必要があります。  

#### ソフトウェア更新ポイントを切り替えるオプションを有効にするには
<a id="to-enable-the-option-to-switch-software-update-points" class="xliff"></a>  

1.  Configuration Manager コンソールで、**[資産とコンプライアンス] > [概要] > [デバイス コレクション]** に移動します。  

2.  **[ホーム]** タブの **[コレクション]** グループで、 **[クライアント通知]**をクリックして、 **[次のソフトウェアの更新ポイントに切り替える]**をクリックします。  


###  <a name="BKMK_SUP_CrossForest"></a> 信頼されていないフォレストにあるソフトウェアの更新ポイント  
 信頼されないフォレストのクライアントをサポートする、1 つまたは複数のソフトウェアの更新ポイントをサイトに作成できます。 別のフォレストにソフトウェアの更新ポイントを追加するには、最初にフォレストに WSUS サーバーをインストールして構成する必要があります。 次に、ウィザードを開始して、Configuration Manager サイト サーバーにソフトウェアの更新ポイントのサイト システムの役割を追加します。 ウィザードで、信頼されないフォレストの WSUS に正常に接続するには、次の設定を構成します。  

-   フォレストの WSUS サーバーにアクセスできる、サイト システムのインストール アカウントを指定します。  

-   WSUS サーバーへの接続に使用する WSUS サーバー接続アカウントを指定します。  

 たとえば、2 つのソフトウェアの更新ポイント (SUP01 および SUP02) があるフォレスト A に、プライマリ サイトがあるとします。 また、同一のプライマリ サイトに対して、フォレスト B に 2 つのソフトウェアの更新ポイント (SUP03 および SUP04) があるとします。この例で切り替えが発生した場合、クライアントと同じフォレストにあるソフトウェアの更新ポイントが最初に優先されます。  

###  <a name="BKMK_WSUSSyncSource"></a> 最上位のサイトで同期ソースとして既存の WSUS サーバーを使う  
 通常、階層内の最上位のサイトは、Microsoft Update とソフトウェア更新プログラムのメタデータを同期するように構成されています。 企業のセキュリティ ポリシーで、最上位サイトからインターネットへのアクセスが許可されていない場合、最上位サイトの同期ソースとして、Configuration Manager 階層にない既存の WSUS サーバーを使用するように構成できます。 たとえば、インターネットにアクセスできる境界ネットワーク に WSUS サーバーがインストールされていて、最上位サイトにはないとします。 この境界ネットワークの WSUS サーバーを、ソフトウェア更新プログラムのメタデータの同期ソースとして構成できます。 境界ネットワークの WSUS サーバーが、Configuration Manager 階層で必要な条件を満たすソフトウェア更新プログラムを同期するようにします。 そうしないと、最上位サイトが必要なソフトウェア更新プログラムを同期できないことがあります。 ソフトウェアの更新ポイントをインストールする場合、境界ネットワークの WSUS サーバーにアクセスする権限を持つ WSUS 接続アカウントを構成し、ファイアウォールで適切なポートのトラフィックを許可します。 詳細については、[ソフトウェアの更新ポイントから同期ソースへの接続に使うポート](../../core/plan-design/hierarchy/ports.md#BKMK_PortsSUP-WSUS)に関する説明を参照してください。  

###  <a name="BKMK_NLBSUPSP1"></a> NLB を使うように構成されたソフトウェアの更新ポイント  
 ソフトウェアの更新ポイントの切り替えによって、一般的なフォールト トレランスのニーズに対応できます。 既定で、Configuration Manager はソフトウェアの更新ポイントを NLB クラスターとして構成することはサポートされていません。 Configuration Manager バージョン 1702 より前のバージョンでは、Configuration Manager SDK を使用して、NLB クラスターに最大 4 つのソフトウェアの更新ポイントを構成できました。 しかし、Configuration Manager バージョン 1702 以降では、ソフトウェアの更新ポイントは NLB クラスターとしてサポートされず、この構成が検出された場合は Configuration Manager バージョン 1702 へのアップグレードがブロックされます。 Set-CMSoftwareUpdatePoint PowerShell コマンドレットについて詳しくは、「[Set-CMSoftwareUpdatePoint](http://go.microsoft.com/fwlink/?LinkId=276834)」を参照してください。

###  <a name="BKMK_SUPSecSite"></a> セカンダリ サイト上のソフトウェアの更新ポイント  
 セカンダリ サイトについては、ソフトウェアの更新ポイントを使用するかどうかは任意です。 セカンダリ サイトにソフトウェアの更新ポイントをインストールすると、WSUS データベースが、親プライマリ サイトの既定のソフトウェアの更新ポイントのレプリカとして構成されます。 セカンダリ サイトにインストールできるソフトウェアの更新ポイントは 1 つだけです。 セカンダリ サイトに割り当てられているデバイスは、セカンダリ サイトにソフトウェアの更新ポイントがインストールされていない場合、親サイトのソフトウェアの更新ポイントを使用するように構成されます。 通常は、セカンダリ サイトに割り当てられているデバイスと親プライマリ サイトのソフトウェアの更新ポイント間のネットワーク帯域幅が限られている場合や、ソフトウェアの更新ポイントが容量制限に近づいている場合に、ソフトウェアの更新ポイントをセカンダリ サイトにインストールします。 セカンダリ サイトにソフトウェアの更新ポイントが正常にインストールされて構成されると、そのセカンダリ サイトに割り当てられているクライアント コンピューターに対してサイト全体のポリシーが更新され、新しいソフトウェアの更新ポイントの使用が開始されます。  

##  <a name="BKMK_SUPInstallation"></a> ソフトウェアの更新ポイントのインストールの計画  
 Configuration Manager でソフトウェアの更新ポイント サイト システムの役割を作成する前に、Configuration Manager のインフラストラクチャに応じて、考慮する必要がある要件がいくつかあります。 SSL を使用して通信するようにソフトウェアの更新ポイントを構成する場合、階層内のソフトウェアの更新ポイントを正常に機能させるには、追加手順を実行する必要があるので、このセクションの内容を特に注意して確認してください。 このセクションでは、ソフトウェアの更新ポイントのインストールに関する計画と準備を適切に行うために必要な手順について説明します。  

###  <a name="BKMK_SUPSystemRequirements"></a> ソフトウェアの更新ポイントの要件  
 ソフトウェアの更新ポイント サイト システムの役割は、WSUS の最小要件を満たし、Configuration Manager サイト システムでサポートされている構成のサイト システムにインストールする必要があります。  

-   Windows Server 2012 での WSUS サーバーの役割の最小要件の詳細については、Windows Server 2012 ドキュメント ライブラリの「[考慮事項とシステム要件を確認する](https://technet.microsoft.com/library/hh852344.aspx#BKMK_1.1)」を参照してください。  

-   Configuration Manager サイト システムでサポートされる構成の詳細については、「[Site and site system prerequisites](../../core/plan-design/configs/site-and-site-system-prerequisites.md)」 (サイトおよびサイト システムの前提条件) を参照してください。  

###  <a name="BKMK_PlanningForWSUS"></a> WSUS インストールの計画  

ソフトウェアを更新するには、ソフトウェアの更新ポイント サイト システムの役割を構成するすべてのサイト システム サーバーに、サポートされているバージョンの WSUS がインストールされている必要があります。 また、サイト サーバーにソフトウェアの更新ポイントをインストールしない場合は、WSUS 管理コンソールがサイト サーバー コンピューターにまだインストールされていなければ、インストールする必要があります。 そのようにすることで、サイト サーバーが、ソフトウェアの更新ポイントで実行されている WSUS と通信できるようになります。  

 Windows Server 2012 で WSUS を使う場合、正常性チェックを定期的に行うために、Configuration Manager の **WSUS Configuration Manager** に WSUS への接続を許可する追加のアクセス許可を構成する必要があります。 権限を構成するには、次のいずれかのオプションを選択します。  

-   **WSUS 管理者** グループに **SYSTEM** アカウントを追加する  

-   **NT AUTHORITY\SYSTEM** アカウントを WSUS データベース (SUSDB) のユーザーとして追加し、最小限の webService データベースの役割のメンバーシップを構成します。  

 Windows Server 2012 に WSUS をインストールする方法の詳細については、Windows Server 2012 ドキュメント ライブラリの「 [WSUS サーバーの役割をインストールする](http://go.microsoft.com/fwlink/p/?LinkId=272355) 」を参照してください。  

 プライマリ サイトに複数のソフトウェアの更新ポイントをインストールする場合、同じ Active Directory フォレストの各ソフトウェアの更新ポイントで、同じ WSUS データベースを使用します。 同じデータベースを共有すると、クライアントが新しいソフトウェアの更新ポイントに切り替えるときに発生することがあるネットワークのパフォーマンスへの影響を大幅に低減できますが、完全に排除することはできません。 クライアントが、古いソフトウェアの更新ポイントとデータベースを共有する新しいソフトウェアの更新ポイントに切り替えるときには、やはりデルタ スキャンが発生しますが、WSUS サーバーが固有のデータベースを持っている場合よりも、スキャンは大幅に軽くなります。  

####  <a name="BKMK_CustomWebSite"></a> WSUS がカスタム Web サイトを使用するように構成する  
 WSUS をインストールするときに、既存の既定の IIS Web サイトを使用するか、カスタムの WSUS Web サイトを作成するかを選択できます。 他の Configuration Manager サイト システムまたは他のアプリケーションで使用されているのと同じ Web サイトを共有せずに、WSUS サービスが IIS によって専用の仮想 Web サイトでホストされるようにするには、WSUS のカスタム Web サイトを作成してください。 このことは、特に、ソフトウェアの更新ポイント サイト システムの役割をサイト サーバーにインストールする場合に重要です。 Windows Server 2012 または Windows Server 2016 で WSUS を実行する場合、WSUS は既定で HTTP にはポート 8530 を、HTTPS にはポート 8531 を使うように構成されています。 サイトにソフトウェアの更新のポイントを作成するときに、これらのポート番号の設定を指定する必要があります。  

####  <a name="BKMK_WSUSInfrastructure"></a> 既存の WSUS インフラストラクチャを使う  
 ソフトウェアの更新ポイントとして Configuration Manager をインストールする前に、使用する環境内で既にアクティブだった WSUS サーバーを選択することができます。 ソフトウェアの更新ポイントが構成されている場合、同期設定を指定する必要があります。 Configuration Manager は、ソフトウェアの更新ポイントで実行されている WSUS サーバーに接続し、同じ設定を使用して WSUS を構成します。 WSUS が、ソフトウェアの更新ポイントとして構成される前に、ソフトウェアの更新ポイントの同期設定の一部として構成されていない製品または分類と同期されている場合、ソフトウェアの更新ポイントに対して構成した同期設定にかかわらず、その製品および分類のソフトウェア更新プログラムのメタデータは、WSUS データベース内のすべてのソフトウェア更新プログラムのメタデータと同期されます。 これにより、サイト データベースに、予期しないソフトウェア更新プログラムのメタデータが存在することになる可能性があります。 製品または分類を、直接、WSUS 管理コンソールに追加して、すぐに同期を開始すると同じ動作が実行されます。 既定では、Configuration Manager は 1 時間ごとに、ソフトウェアの更新ポイントの WSUS に接続し、Configuration Manager の外部で変更されたすべての設定をリセットします。 同期設定で指定した製品と分類を満たしていないソフトウェア更新プログラムは期限切れとして設定され、サイト データベースから削除されます。

 WSUS サーバーがソフトウェアの更新ポイントとして構成されている場合、スタンドアロンの WSUS サーバーとして使用できなくなります。 Configuration Manager で管理されていない別のスタンドアロンの WSUS サーバーが必要な場合は、別のサーバーで構成する必要があります。

####  <a name="BKMK_WSUSAsReplica"></a> WSUS をレプリカ サーバーとして構成する  
 プライマリ サイト サーバーにソフトウェアの更新ポイント サイト システムの役割を作成する場合、レプリカとして構成されている WSUS サーバーを使用することはできません。 WSUS サーバーがレプリカとして構成されていると、Configuration Manager で、WSUS サーバーの構成と WSUS の同期が失敗します。 ソフトウェアの更新ポイントをセカンダリ サイトに作成すると、Configuration Manager は、親であるプライマリ サイトのソフトウェアの更新ポイントで実行している WSUS のレプリカ サーバーとして、WSUS を構成します。 プライマリ サイトにインストールする最初のソフトウェアの更新ポイントは、既定のソフトウェアの更新ポイントになります。 サイトの追加のソフトウェアの更新ポイントは、既定のソフトウェアの更新ポイントのレプリカとして構成されます。  

####  <a name="BKMK_WSUSandSSL"></a> SSL を使うように WSUS を構成するかどうかを決定する  
 ソフトウェアの更新ポイントで実行される WSUS を保護するため、SSL プロトコルを使用することができます。 WSUS は、SSL を使用して、クライアント コンピューターおよび WSUS サーバーの下流 WSUS サーバーを認証します。 また、WSUS は、ソフトウェア更新プログラムのメタデータの暗号化にも SSL を使用します。 SSL を使用して WSUS を保護する場合は、ソフトウェアの更新ポイントをインストールする前に WSUS サーバーを準備する必要があります。  

 ソフトウェアの更新ポイントをインストールして構成する場合、[ **WSUS サーバーの SSL 通信を有効にする** ] 設定を選択する必要があります。 それ以外の場合は、Configuration Manager は SSL を使用しないように WSUS を構成します。 ソフトウェアの更新ポイントで実行されている WSUS に対して SSL を有効にする場合は、すべての子サイトのソフトウェアの更新ポイントで実行されている WSUS も SSL を使用するように構成する必要があります。  

###  <a name="BKMK_ConfigureFirewalls"></a> ファイアウォールの構成  
 Configuration Manager の中央管理サイトのソフトウェア更新プログラムは、ソフトウェアの更新ポイントで実行されている WSUS と通信し、さらにその WSUS が同期ソースと通信して、ソフトウェア更新プログラムのメタデータが同期されます。 子サイトのソフトウェアの更新ポイントは、親サイトのソフトウェアの更新ポイントと通信します。 プライマリ サイトに複数のソフトウェアの更新ポイントが存在する場合、追加のソフトウェアの更新ポイントは、サイトにインストールされている最初のソフトウェアの更新ポイント (既定のソフトウェアの更新ポイント) と通信する必要があります。  

 Configuration Manager のソフトウェアの更新ポイントとインターネット間の企業ファイアウォールがある場合、ソフトウェアの更新ポイントとそのアップストリーム更新ソースがある場合、追加のソフトウェアの更新ポイントがある場合には、ファイアウォールは WSUS で使う HTTP や HTTPS ポートを許可するように構成する必要があります。 Microsoft Update への接続は、ポート 80 を HTTP に、ポート 443 を HTTPS を使用するように常に構成されます。 子サイトのソフトウェアの更新ポイントで実行されている WSUS から親サイトのソフトウェアの更新ポイントで実行されている WSUS への接続には、カスタム ポートを使用することができます。 セキュリティ ポリシーによって接続が許可されない場合は、同期の手段としてエクスポートとインポートを使う必要があります。 詳細については、このトピックの「 [同期ソース](#BKMK_SyncSource) 」セクションを参照してください。 WSUS で使用されるポートの詳細については、「[System Center Configuration Manager において、WSUS で使用するポート設定を特定する方法](../get-started/install-a-software-update-point.md#wsus-settings)」を参照してください。  

#### 特定のドメインに対するアクセスを制限する
<a id="restrict-access-to-specific-domains" class="xliff"></a>  
 アクティブなソフトウェアの更新ポイントとインターネットの間のファイアウォールで、これらのポートとプロトコルをすべてのアドレスに対して開放できない場合は、WSUS と自動更新で Microsoft Update と通信できるようにするため、アクセスを次のドメインに限定することができます。  

-   http://windowsupdate.microsoft.com

-   http://*.windowsupdate.microsoft.com  

-   https://*.windowsupdate.microsoft.com  

-   http://*.update.microsoft.com  

-   https://*.update.microsoft.com  

-   http://*.windowsupdate.com  

-   http://download.windowsupdate.com  

-   http://download.microsoft.com  

-   http://*.download.windowsupdate.com  

-   http://test.stats.update.microsoft.com  

-   http://ntservicepack.microsoft.com  

 子サイトにアクティブなソフトウェアの更新ポイントがある場合や、サイトにリモートのアクティブなインターネット ベースのソフトウェアの更新ポイントがある場合は、それら 2 つのサイト システムの間に設置されているファイアウォールに次のアドレスも追加することが必要になる可能性があります。  

 **子サイトのソフトウェアの更新ポイント**  

-   http://<*子サイト上のソフトウェアの更新ポイントの FQDN*>  

-   https://<*子サイト上のソフトウェアの更新ポイントの FQDN*>  

-   http://<*親サイト上のソフトウェアの更新ポイントの FQDN*>  

-   https://<*親サイト上のソフトウェアの更新ポイントの FQDN*>  

##  <a name="BKMK_SyncSettings"></a> 同期設定の計画  
 Configuration Manager でのソフトウェア更新プログラムの同期は、構成した基準に基づいてソフトウェア更新プログラムのメタデータを取得するプロセスです。 階層内の最上位サイト、中央管理サイト、または、スタンドアロン プライマリ サイトでは、ソフトウェア更新プログラムは Microsoft Update と同期されます。 最上位サイトのソフトウェアの更新ポイントを、Configuration Manager 階層内ではなく、既存の WSUS サーバーと同期するように構成できます。 子プライマリ サイトでは、ソフトウェア更新プログラムのメタデータが、中央管理サイトのソフトウェアの更新ポイントと同期されます。 ソフトウェアの更新ポイントをインストールして構成する前に、このセクションを参考にして、同期設定を計画してください。  

###  <a name="BKMK_SyncSource"></a> 同期ソース  
 ソフトウェアの更新ポイントの同期ソースの設定は、ソフトウェアの更新ポイントがソフトウェア更新プログラムのメタデータを取得する場所と、同期中に WSUS のレポート イベントを生成するかどうかを指定します。  

-   **同期ソース:** 最上位サイトのソフトウェアの更新ポイントでは、既定で、Microsoft Update が同期ソースとして構成されます。 最上位サイトを既存の WSUS サーバーと同期することもできます。 子プライマリ サイトのソフトウェアの更新ポイントは、既定で、中央管理サイトのソフトウェアの更新ポイントが同期ソースとして構成されます。  

    > [!NOTE]  
    >  プライマリ サイトにインストールする最初のソフトウェアの更新ポイントは、既定のソフトウェアの更新ポイントになり、中央管理サイトと同期されます。 プライマリ サイトの追加のソフトウェアの更新ポイントは、プライマリ サイトの既定のソフトウェアの更新ポイントと同期されます。  

     ソフトウェアの更新ポイントが Microsoft Update またはアップストリームの更新サーバーから切断されている場合、構成された同期ソースと同期せずに、WSUSUtil ツールのエクスポートおよびインポート機能を使用してソフトウェア更新プログラムを同期するように、同期ソースを構成できます。 詳細については、「[切断されているソフトウェアの更新ポイントからのソフトウェア更新プログラムの同期](../get-started/synchronize-software-updates-disconnected.md)」を参照してください。  

-   **WSUS レポート イベント:** クライアント コンピューターの Windows Update エージェントは、WSUS レポートに使用されるイベント メッセージを作成できます。 これらのイベントは Configuration Manager のソフトウェアの更新プログラムでは使用されないため、[**WSUS レポート イベントを作成しない**] オプションは既定で選択されます。 これらのイベントが作成されていない場合、クライアント コンピューターが WSUS サーバーに接続するのは、ソフトウェアの更新プログラムの評価および対応スキャンの間のみです。 Configuration Manager のソフトウェアの更新プログラム以外のレポートでこれらのイベントが必要な場合は、この設定を変更して、WSUS レポート イベントを作成する必要があります。  

###  <a name="BKMK_SyncSchedule"></a> 同期スケジュール  
 Configuration Manager 階層内の最上位サイトのソフトウェアの更新ポイントでのみ、同期スケジュールを構成できます。 同期スケジュールを構成すると、指定した日時に、ソフトウェアの更新ポイントが同期ソースと同期されます。 カスタム スケジュールを使用すると、WSUS サーバー、サイト サーバー、およびネットワークからの要求が低い日時 (たとえば週に 1 回、午前 2:00) にソフトウェア更新プログラムを同期することができます。 あるいは、Configuration Manager コンソールの [**すべてのソフトウェア更新**] または [**ソフトウェア更新プログラム グループ**] ノードから、[**ソフトウェア更新プログラムの同期**] アクションを使用して、最上位サイトで同期を開始できます。  

> [!TIP]  
>  環境に合った期間内に、ソフトウェア更新プログラムの同期をスケジュールします。 一般的なシナリオの 1 つは、"月例パッチ" と呼ばれる毎月第 2 火曜日にリリースされる Microsoft の定期セキュリティ更新プログラムのすぐ後に、ソフトウェア更新プログラムの同期が実行されるようにスケジュールを設定することです。 もう 1 つの一般的なシナリオは、ソフトウェア更新プログラムを使用して Endpoint Protection 定義とエンジン更新プログラムを配信するときに、毎日ソフトウェア更新プログラムの同期が実行されるようにスケジュールを設定することです。  

 ソフトウェアの更新ポイントで正常に同期が完了した後で、同期要求が子サイトに送信されます。 プライマリ サイトに追加のソフトウェアの更新ポイントがある場合、同期要求は各ソフトウェアの更新ポイントに送信されます。 このプロセスは階層内のすべてのサイトで繰り返されます。  

###  <a name="BKMK_UpdateClassifications"></a> 更新プログラムの分類  
 すべてのソフトウェア更新プログラムは、各種の更新プログラムを整理するための更新プログラムの分類により定義されます。 同期プロセス中に、指定した分類のソフトウェアの更新プログラムのメタデータが同期されます。 Configuration Manager では次の更新プログラムの分類でソフトウェアの更新を同期できます。  

-   **重要な更新:** セキュリティに関連しない重要な不具合に対処する、特定の問題を解決するために広範にリリースされる更新プログラムを示します。  

-   **定義ファイルの更新:** ウイルスまたはその他の定義ファイルの更新を示します。  

-   **Feature Pack:** 製品リリースに先立って配布され、通常は次回の製品版リリースに含まれる、製品の新機能を示します。  

-   **セキュリティ更新プログラム:** 製品固有でセキュリティに関係する問題に対して、広範にリリースされた更新を示します。  

-   **Service Pack:** アプリケーションに適用される修正プログラムを累積したセットを示します。 これらの修正プログラムには、セキュリティの更新プログラム、重要な更新プログラム、ソフトウェア更新プログラムなどが含まれています。  

-   **ツール:** 1 つまたは複数のタスクを完了するためのユーティリティまたは機能を示します。  

-   **更新プログラムのロールアップ:** 容易に展開できるようにパッケージにまとめられた修正プログラムを累積したセットを示します。 これらの修正プログラムには、セキュリティの更新プログラム、重要な更新プログラム、更新プログラムなどが含まれています。 更新プログラムのロールアップは、通常セキュリティまたは製品コンポーネントなど特定の領域に対応します。  

-   **更新プログラム:** 現在インストールされているアプリケーションまたはファイルの更新プログラムを示します。  

 更新プログラムの分類設定は、最上位サイトでのみ構成します。 ソフトウェア更新プログラムのメタデータは、最上位サイトから子プライマリ サイトにレプリケートされるため、更新プログラムの分類設定は子サイトのソフトウェアの更新ポイントで構成しません。 更新プログラムの分類を選択する場合、選択する分類が多くなるほど、ソフトウェア更新プログラムのメタデータの同期に必要な時間が長くなることに注意してください。  

> [!WARNING]  
>  ベスト プラクティスとして、初めてソフトウェア更新プログラムを同期する前にすべての分類を消去します。 最初の同期の後、[ソフトウェアの更新ポイント コンポーネント] プロパティから分類を選択し、同期を再開します。  

###  <a name="BKMK_UpdateProducts"></a> 製品  
 各ソフトウェア更新プログラムのメタデータは、更新プログラムが適用される 1 つまたは複数の製品を定義します。 製品は、オペレーティング システムまたはアプリケーションの特定のエディションです。 製品の例として、Microsoft Windows Server 2008 があります。 製品ファミリは、個々の製品が派生する基礎となるオペレーティング システムまたはアプリケーションです。 製品ファミリの例として Microsoft Windows があり、Microsoft Windows Server 2008 はそのメンバーです。 製品ファミリまたは製品ファミリ内の個別製品を指定できます。  

 ソフトウェア更新プログラムが複数の製品に適用可能な状態で、少なくとも 1 つの製品の同期を選択している場合、選択されていない製品も含めてすべての製品が Configuration Manager コンソールに表示されます。 たとえば、サブスクライブしているオペレーティング システムが Windows Server 2012 だけで、ソフトウェア更新プログラムが Windows Server 2012 と Windows Server 2012 Datacenter Edition に適用される場合、サイト データベースには両方の製品が含まれます。  

 製品設定は、最上位サイトでのみ構成します。 ソフトウェア更新プログラムのメタデータは、最上位サイトから子プライマリ サイトにレプリケートされるため、製品設定は子サイトのソフトウェアの更新ポイントで構成しません。 製品を選択する場合、選択する製品が多くなるほど、ソフトウェア更新プログラムのメタデータの同期に必要な時間が長くなることに注意してください。  

> [!IMPORTANT]  
>  Configuration Manager は、ソフトウェアの更新ポイントを初めてインストールするときに選択できる製品と製品ファミリのリストを保存します。 Configuration Manager のリリース後にリリースされる製品と製品ファミリは、選択できる使用可能な製品と製品ファミリのリストを更新する、ソフトウェア更新プログラムの同期を完了するまでは選択できない可能性があります。 ベスト プラクティスとして、初めてソフトウェア更新プログラムを同期する前にすべての製品をクリアします。 最初の同期の後、[ソフトウェアの更新ポイント コンポーネント] プロパティから製品を選択し、同期を再開します。  

###  <a name="BKMK_SupersedenceRules"></a>置き換え規則  
 一般的に、別のソフトウェア更新プログラムを置き換えるソフトウェア更新プログラムでは、次の 1 つまたは複数の処理を実行します。  

-   以前にリリースされた 1 つまたは複数の更新プログラムで提供された修正を強化、改善、または更新します。  

-   更新プログラムのインストールが承認された場合にクライアント コンピューターにインストールされる置き換えの更新ファイル パッケージの効率性を向上させます。 たとえば、置き換えられる更新プログラムに、修正、または新しい更新プログラムで現在サポートされているオペレーティング システムには関係のないファイルが含まれていることがあり、それらのファイルは、置き換わる更新プログラムのファイル パッケージには含まれません。  

-   新しいバージョンの製品を更新します。 つまり、古いバージョンまたは構成の製品には適用できなくなったバージョンを更新します。 また、言語サポートの拡張のために変更が加えられた場合に、更新プログラムによって他の更新プログラムが置き換えられることがあります。 たとえば、Microsoft Office 用の比較的新しいバージョンの製品更新プログラムにより、古いオペレーティング システムがサポートされなくなり、代わりに、初期更新プログラム リリースで新しい言語が追加サポートされるようになる場合があります。  

 ソフトウェアの更新ポイントのプロパティでは、置き換えられたソフトウェア更新プログラムが即時期限切れになるように指定できます。これにより、古いソフトウェア更新プログラムが新しい展開に含まれないようにし、既存の展開に 1 つ以上の期限切れのソフトウェア更新プログラムが含まれていることを示すフラグを付けることができます。 または、置き換えられるソフトウェア更新プログラムが期限切れになるまでの期間を指定することができます。その場合、これらのプログラムを引き続き展開することができます。 置き換えられるソフトウェア更新プログラムの展開が必要になる場合のシナリオとして、次のものが考えられます。  

-   置き換える方のソフトウェア更新プログラムが新しいバージョンのオペレーティング システムのみをサポートし、クライアント コンピューターの一部が古いバージョンのオペレーティング システムを実行している場合。  

-   置き換える方のソフトウェア更新プログラムに、置き換えられるソフトウェア更新プログラムよりも適用性の制限が多い場合があります。 この場合、一部のクライアント コンピューターには不適切になります。  

-   置き換える方のソフトウェア更新プログラムが稼動環境での展開に承認されていない場合。  

    > [!NOTE]  
    >  Configuration Manager で置き換えられたソフトウェアの更新プログラムが**期限切れ**に設定されたときに、WSUS でその更新プログラムが**期限切れ**に設定されることはありません。 ただし、WSUS クリーンアップ タスクが実行されると、Configuration Manager で**期限切れ**に設定されている更新プログラムは、WSUS サーバー上で**拒否済み**の状態に設定され、コンピューター上の Windows Update Agent が、これらの更新プログラムをスキャンすることはなくなります。 つまり、クライアントは、クリーンアップ タスクが実行されるまでスキャンを続けるということです。 WSUS クリーンアップ タスクの詳細については、「[ソフトウェア更新プログラムのメンテナンス](/sccm/sum/deploy-use/software-updates-maintenance)」を参照してください。
    
###  <a name="BKMK_UpdateLanguages"></a> 言語  
 ソフトウェアの更新ポイントの言語設定を使用すると、ソフトウェア更新プログラムに同期される概要詳細 (ソフトウェア更新プログラムのメタデータ) の言語、およびソフトウェア更新プログラムにダウンロードされるソフトウェア更新ファイルの言語を構成できます。  

#### ソフトウェア更新ファイル
<a id="software-update-file" class="xliff"></a>  
 ソフトウェアの更新ポイントのプロパティの [ **ソフトウェア更新ファイル** ] 設定で構成した言語は、サイトでソフトウェア更新プログラムをダウンロードするときに使用可能な既定の言語セットを提供します。 ソフトウェア更新プログラムがダウンロードまたは展開されるたびに既定で選択される言語を変更できます。 ソフトウェア更新プログラム ファイルが選択した言語で使用できる場合、ダウンロード プロセスで、構成した言語のソフトウェア更新プログラム ファイルが展開パッケージのソース場所にダウンロードされます。 ダウンロードしたファイルはサイト サーバーのコンテンツ ライブラリにコピーされ、パッケージ用に構成される配布ポイントにコピーされます。  

 ソフトウェア更新ファイルの言語設定は、環境で最も使用される言語に設定してください。 たとえば、サイト内のクライアント コンピューターのオペレーティング システムまたはアプリケーションで主に英語と日本語を使用し、サイト内で他の言語をほとんど使用しない場合は、ソフトウェア更新プログラムのダウンロードまたは展開時に [ **ソフトウェア更新ファイル** ] 列で英語と日本語を選択して他の言語をクリアします。 展開の [ **言語の選択** ] ページで既定の設定を使用して、ウィザードをダウンロードすることができます。 また、これによって、不要な更新プログラム ファイルがダウンロードされなくなります。 この設定は、Configuration Manager 階層内の各ソフトウェアの更新ポイントで構成されます。  

#### 概要詳細
<a id="summary-details" class="xliff"></a>  
 同期プロセス中、概要詳細の情報 (ソフトウェア更新プログラムのメタデータ) が、指定された言語のソフトウェアの更新プログラムに対して更新されます。 メタデータは、ソフトウェア更新プログラムに関する情報を提供します。たとえば、名前、説明、更新によってサポートされる製品、更新分類、アーティクル ID、ダウンロード URL、適用規則などです。  

 概要情報設定は、最上位サイトでのみ構成します。 概要情報は、子サイトのソフトウェアの更新ポイントでは構成されません。これは、ファイルベースのレプリケーションを使用して、ソフトウェア更新プログラムのメタデータが中央管理サイトから子サイトにレプリケートされるためです。 概要詳細の言語を選択するときは、環境内で必要な言語のみを選択します。 選択する言語が多いほど、ソフトウェア更新プログラムのメタデータの同期に必要な時間が長くなります。 Configuration Manager では、Configuration Manager コンソールが実行されているオペレーティング システムのロケールのソフトウェア更新プログラムのメタデータが表示されます。 ソフトウェア更新プログラムのローカライズされたプロパティがオペレーティング システムのロケールで使用できない場合、ソフトウェア更新情報が英語で表示されます。  

> [!IMPORTANT]  
>  重要なのは、Configuration Manager の階層で必要な概要詳細の言語をすべて選択することです。 最上位サイトのソフトウェアの更新プログラムが同期ソースと同期すると、選択した概要情報の言語によって、取得されるソフトウェア更新プログラムのメタデータが決まります。 同期を少なくとも 1 回実行した後に概要詳細の言語を変更すると、ソフトウェア更新プログラムのメタデータは、新しいソフトウェア更新プログラムまたは更新されたソフトウェア更新プログラムにのみ、変更された概要詳細の言語で取得されます。 既に同期されているソフトウェア更新プログラムでは、同期ソースのソフトウェア更新プログラムに変更がない限り、変更された言語の新しいメタデータは更新されません。  

##  <a name="BKMK_MaintenanceWindow"></a> ソフトウェア更新プログラムのメンテナンス期間の計画  
 ソフトウェア更新プログラムのインストール専用のメンテナンス期間を追加できます。 この機能により、一般的なメンテナンス期間と、ソフトウェア更新プログラム用のメンテナンス期間を別に構成できます。 一般的なメンテナンス期間とソフトウェア更新プログラムのメンテナンス期間の両方を構成すると、クライアントは、ソフトウェア更新プログラムのメンテナンス期間中にのみ、ソフトウェア更新プログラムをインストールします。 メンテナンス期間について詳しくは、「[メンテナンス期間を使用する方法](../../core/clients/manage/collections/use-maintenance-windows.md)」を参照してください。  

##  <a name="BKMK_RestartOptions"></a> Windows 10 クライアントにおけるソフトウェア更新プログラムのインストール後の再起動オプション
再起動の必要なソフトウェア更新プログラムが Configuration Manager により展開され、コンピューターにインストールされた場合、再起動が保留中としてスケジュールされ、再起動のダイアログ ボックスが表示されます。

Configuration Manager バージョン 1606 から、Configuration Manager ソフトウェアの更新のために再起動が保留中となっているときはいつでも Windows 10 コンピューターの Windows 電源オプションで **[更新と再起動]**および **[更新とシャットダウン]** のオプションを利用できるようになりました。 これらのオプションのいずれかを使用した場合、コンピューターの再起動後に再起動ダイアログは表示されません。

Configuration Manager の以前のバージョンでは、Windows 8 およびそれ以降のコンピューターにおいて再起動が保留中となっているときに、(再起動ダイアログから行う代わりに) Windows 電源オプションを使用してコンピューターをシャットダウンまたは再起動する場合、再起動ダイアログはコンピューターの再起動後もそのまま表示され、コンピューターも構成された期限までに再起動が必要なままとなります。

## 次のステップ
<a id="next-steps" class="xliff"></a>
ソフトウェアの更新プログラムを計画する場合、「[Prepare for software updates management](../get-started/prepare-for-software-updates-management.md)」 (ソフトウェア更新プログラムの管理の準備) を参照してください。

